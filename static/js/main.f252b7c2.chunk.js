(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){e.exports=a(36)},25:function(e,t,a){},36:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),n=a(17),i=a.n(n),o=a(10),c=a(1),l=a(2),u=a(4),p=a(3),h=a(5),f=(a(25),a(7)),m=a.n(f),v=a(9),y=a.n(v),d=a(18),g=a.n(d),S=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"start-page"},r.a.createElement("section",{className:"main-title"},r.a.createElement("div",{className:"main-title-left"},r.a.createElement("h2",{className:"title-text-main"},"Piskel-clone is a final project of the second stage course of The Rolling Scopes School"),r.a.createElement("p",{className:"title-text"},"Create animations in your browser"),r.a.createElement("button",{onClick:this.props.startProject},"Create Sprite")),r.a.createElement("div",{className:"main-title-right"},r.a.createElement("div",{className:"piskel-screen"}))),r.a.createElement("section",{className:"sprites-section"},r.a.createElement("h2",null,"Sprites example"),r.a.createElement("div",{className:"sprites-gallery"},r.a.createElement("div",{className:"sprite sprt1"}),r.a.createElement("div",{className:"sprite sprt2"}),r.a.createElement("div",{className:"sprite sprt3"}),r.a.createElement("div",{className:"sprite sprt4"}),r.a.createElement("div",{className:"sprite sprt5"}),r.a.createElement("div",{className:"sprite sprt6"}),r.a.createElement("div",{className:"sprite sprt7"}),r.a.createElement("div",{className:"sprite sprt8"}))),r.a.createElement("section",{className:"functionality"},r.a.createElement("h2",null,"Functionality"),r.a.createElement("div",{className:"functionality-gallery"},r.a.createElement("div",null,r.a.createElement("p",null,"Choose color"),r.a.createElement("div",{className:"functionality-wrapper fnc1"})),r.a.createElement("div",null,r.a.createElement("p",null,"Frame managment"),r.a.createElement("div",{className:"functionality-wrapper fnc2"})),r.a.createElement("div",null,r.a.createElement("p",null,"Layer managment"),r.a.createElement("div",{className:"functionality-wrapper fnc3"})),r.a.createElement("div",null,r.a.createElement("p",null,"Live preview"),r.a.createElement("div",{className:"functionality-wrapper fnc4"})),r.a.createElement("div",null,r.a.createElement("p",null,"Export to .gif/.apng"),r.a.createElement("div",{className:"functionality-wrapper fnc5"})),r.a.createElement("div",null,r.a.createElement("p",null,"Hotkeys"),r.a.createElement("div",{className:"functionality-wrapper fnc6"})),r.a.createElement("div",null,r.a.createElement("p",null,"Google SingIn"),r.a.createElement("div",{className:"functionality-wrapper fnc7"})),r.a.createElement("div",null,r.a.createElement("p",null,"Tools"),r.a.createElement("div",{className:"functionality-wrapper fnc8"})))),r.a.createElement("section",{className:"about-container"},r.a.createElement("div",{className:"author-img"}),r.a.createElement("div",{className:"about-author"},r.a.createElement("h2",{className:"author-name"},"akSr-"),r.a.createElement("p",null,"I like the programming, it's exciting and fascinating. Coding is one of the easiest ways to solve practical problems. The end product depends only upon how hight your skills and good idea but not any other factors.")),r.a.createElement("div",{className:"author-contacts"},r.a.createElement("p",null,"GitHub: ",r.a.createElement("a",{href:"https://github.com/aksr666"},"https://github.com/aksr666")))))}}]),t}(r.a.Component),E=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.mousePosition.x,t=this.props.mousePosition.y;return e>=this.props.size-1&&(e=this.props.size),e<=0&&(e=1),t>=this.props.size-1&&(t=this.props.size),t<=0&&(t=1),r.a.createElement("div",{className:"canvas-info"},r.a.createElement("div",{className:"cursor-position"},r.a.createElement("h2",null,"Mouse position:"),r.a.createElement("p",{className:"cursor-position-x"},"X: ".concat(e)),r.a.createElement("p",{className:"cursor-position-y"},"Y: ".concat(t))),r.a.createElement("div",{className:"canvas-size"},r.a.createElement("h3",null,"Cavas size: ".concat(this.props.size," x ").concat(this.props.size))))}}]),t}(r.a.PureComponent),w=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderLayers",value:function(){var e=this,t=[];return this.props.frame.layers.forEach(function(a,s){t.push(r.a.createElement("p",{className:e.props.frame.currentLayer===s?"layer layer-current":"layer",key:Math.random().toString(36).substring(7),draggable:"true",onClick:function(){return e.props.setCurrentLayer(s)},onDragEnter:function(t){t.target.style.border="1px dashed red",e.props.setLayersToSwap(s,!1)},onDragOver:function(e){return e.preventDefault()},onDragLeave:function(e){return e.target.style.border="1px solid white"},onDragStart:function(t){t.target.style.opacity=.5,e.props.setLayersToSwap(s,!0)},onDragEnd:function(t){t.target.style.opacity=1,t.target.style.border="1px solid white",e.props.swapLayers()}},"Layer-".concat(s+1)))}),t}},{key:"render",value:function(){return r.a.createElement("div",{className:"layers-info"},r.a.createElement("div",{className:"layers-header"},r.a.createElement("h3",null,"Layers"),r.a.createElement("button",{className:this.props.isShowing?"show-layers checked":"show-layers",onClick:this.props.showLayers})),r.a.createElement("div",{className:"layers-buttons"},r.a.createElement("button",{className:"layers-btn",onClick:this.props.addLayer},"+"),r.a.createElement("button",{className:this.props.frame.layers.length>1?"layers-btn":"layers-btn disabled",disabled:!(this.props.frame.layers.length>1),onClick:this.props.deleteLayer},"-"),r.a.createElement("button",{className:1!==this.props.frame.layers.length?"layers-btn":"layers-btn disabled",disabled:!this.props.frame.layers.length,onClick:this.props.setNextLayer},r.a.createElement("p",{className:"layers-next"},"\u25ba")),r.a.createElement("button",{className:1!==this.props.frame.layers.length?"layers-btn":"layers-btn disabled",disabled:!this.props.frame.layers.length,onClick:this.props.setPreviousLayer},r.a.createElement("p",{className:"layers-prev"},"\u25ba"))),this.renderLayers())}}]),t}(r.a.PureComponent),b=function(e){var t={};return t.layers=[Array.from(Array(e).fill([0,0,0,0]),function(){return new Array(e).fill([0,0,0,0])})],t.currentLayer=0,t},k=function(e,t,a,s){var r=e.getContext("2d");r.clearRect(0,0,e.width,e.height),t.forEach(function(e,t){t===a?e.forEach(function(e,t){e.forEach(function(e,a){e.toString()!==[0,0,0,0].toString()&&(r.fillStyle=e,r.fillStyle="rgba(".concat(e.join(),")"),r.fillRect(s*t,s*a,s,s))})}):e.forEach(function(e,t){e.forEach(function(e,a){if(e.toString()!==[0,0,0,0].toString()){e.splice(e.length-1,1,".5");var n="rgba(".concat(e.join(),")");r.fillStyle=e,r.fillStyle=n,r.fillRect(s*t,s*a,s,s)}})})})},C=function(e){return JSON.parse(JSON.stringify(e))},N=function(e){return JSON.parse(JSON.stringify(e)).map(function(e){return JSON.parse(JSON.stringify(e))})},L=function(e,t,a,s){var r=e.getContext("2d");r.clearRect(0,0,e.width,e.height),s?t.forEach(function(e){e.forEach(function(e,t){e.forEach(function(e,s){e.toString()!==[0,0,0,0].toString()&&(r.fillStyle=e,r.fillStyle="rgba(".concat(e.join(),")"),r.fillRect(a*t,a*s,a,a))})})}):t.forEach(function(e,t){e.forEach(function(e,s){e.toString()!==[0,0,0,0].toString()&&(r.fillStyle=e,r.fillStyle="rgba(".concat(e.join(),")"),r.fillRect(a*t,a*s,a,a))})})},T=function(e,t,a){return t<a?e.forEach(function(e){return e.layers.forEach(function(e){return function(e){for(var t=e.length;t!==a;)e.push(new Array(a).fill([0,0,0,0])),e.unshift(new Array(a).fill([0,0,0,0])),t=e.length;return e.forEach(function(e){for(var t=e.length;t!==a;)e.push([0,0,0,0]),e.unshift([0,0,0,0]),t=e.length}),e}(e)})}):e.forEach(function(e){return e.layers.forEach(function(e){return function(e){for(var t=e.length;t!==a;)e.pop(),e.shift(),t=e.length;return e.forEach(function(e){for(var t=e.length;t!==a;)e.pop(),e.shift(),t=e.length}),e}(e)})}),e},z=function(e,t){var a=N(t),s=Object.assign({},e,{framesToSaveAsApng:null},{framesToSaveAsGif:null},{stateHistory:null});return s.frames=a,s},x=function(e){var t;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3===(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),[(t="0x"+t.join(""))>>16&255,t>>8&255,255&t,1]},O=function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},j=function(e,t,a,s,r){1===e.nativeEvent.buttons?s[t][a]=x(r.main):s[t][a]=x(r.extra)},F=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={mousePosition:{x:0,y:0},showLayers:!1},a.layersToSwap={firstLayer:null,secondLayer:null},a.pikselSize=null,a.canvas=null,a.isDrawing=!1,a.canvasSize=640,a.startCoords={},a.frameCopy=null,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"setMousePosition",value:function(e){var t=Object.assign({},this.state.mousePosition);t.x=e.x,t.y=e.y,this.setState({mousePosition:t})}},{key:"componentDidMount",value:function(){var e=this.refs.canvas;this.pikselSize=Math.floor(this.canvasSize/this.props.canvasSize),this.canvas=e,this.ctx=e.getContext("2d"),L(e,this.props.frame.layers[this.props.frame.currentLayer],this.pikselSize)}},{key:"componentDidUpdate",value:function(){this.pikselSize=this.canvasSize/this.props.canvasSize,this.frameCopy||(this.state.showLayers?k(this.canvas,N(this.props.frame.layers),this.props.frame.currentLayer,this.pikselSize):L(this.canvas,this.props.frame.layers[this.props.frame.currentLayer],this.pikselSize))}},{key:"mouseDownHandler",value:function(e){e.preventDefault(),this.isDrawing=!0,this.startCoords.x=Math.floor(e.nativeEvent.offsetX/this.pikselSize),this.startCoords.y=Math.floor(e.nativeEvent.offsetY/this.pikselSize),(this.props.tools.Stroke.value||this.props.tools.Rectangle.value||this.props.tools.Circle.value)&&(this.frameCopy=C(this.props.frame)),this.props.tools.Pen.value&&j(e,this.startCoords.x,this.startCoords.y,this.props.frame.layers[this.props.frame.currentLayer],this.props.colors),this.state.showLayers?k(this.canvas,N(this.props.frame.layers),this.props.frame.currentLayer,this.pikselSize):L(this.canvas,this.props.frame.layers[this.props.frame.currentLayer],this.pikselSize)}},{key:"mouseMoveHandler",value:function(e){var t=Math.floor(e.nativeEvent.offsetX/this.pikselSize),a=Math.floor(e.nativeEvent.offsetY/this.pikselSize);if(t<=0&&(t=0),t>this.props.canvasSize-1&&(t=this.props.canvasSize-1),a<=0&&(a=0),a>this.props.canvasSize-1&&(a=this.props.canvasSize-1),this.props.tools.Pen.value&&this.isDrawing&&j(e,t,a,this.props.frame.layers[this.props.frame.currentLayer],this.props.colors),this.props.tools.Mirror.value&&this.isDrawing&&function(e,t,a,s,r){var n=s.length-t-1,i=s.length-a-1;e.ctrlKey?(1===e.nativeEvent.buttons?s[t][a]=x(r.main):s[t][a]=x(r.extra),1===e.nativeEvent.buttons?s[t][i]=x(r.main):s[t][i]=x(r.extra)):e.shiftKey?(1===e.nativeEvent.buttons?s[t][a]=x(r.main):s[t][a]=x(r.extra),1===e.nativeEvent.buttons?s[n][a]=x(r.main):s[n][a]=x(r.extra),1===e.nativeEvent.buttons?s[t][i]=x(r.main):s[t][i]=x(r.extra),1===e.nativeEvent.buttons?s[n][i]=x(r.main):s[n][i]=x(r.extra)):(1===e.nativeEvent.buttons?s[t][a]=x(r.main):s[t][a]=x(r.extra),1===e.nativeEvent.buttons?s[n][a]=x(r.main):s[n][a]=x(r.extra))}(e,t,a,this.props.frame.layers[this.props.frame.currentLayer],this.props.colors),this.props.tools.Dithering.value&&this.isDrawing&&function(e,t,a,s,r,n){var i=function(e,t,a,s,r,n,i){var o,c,l,u;return s&&(o=e[t][a-1].toString()===e[t][a].toString()),r&&(c=e[t-1][a].toString()===e[t][a].toString()),n&&(l=e[t][a+1].toString()===e[t][a].toString()),i&&(u=e[t+1][a].toString()===e[t][a].toString()),u||c||o||l},o=s[t][a];s[t][a]=x(r.main);var c=null;t>0&&t<n-1&&a>0&&a<n-1&&(c=i(s,t,a,!0,!0,!0,!0)),0===t&&0!==a&&a!==n-1&&(c=i(s,t,a,!0,!1,!0,!0)),0===a&&0!==t&&t!==n-1&&(c=i(s,t,a,!1,!0,!0,!0)),t===n-1&&a!==n-1&&0!==a&&(c=i(s,t,a,!0,!0,!0,!1)),a===n-1&&t!==n-1&&0!==t&&(c=i(s,t,a,!0,!0,!1,!0)),0===t&&0===a&&(c=i(s,t,a,!1,!1,!0,!0)),t===n-1&&a===n-1&&(c=i(s,t,a,!0,!0,!1,!1)),t===n-1&&0===a&&(c=i(s,t,a,!1,!0,!0,!1)),0===t&&a===n-1&&(c=i(s,t,a,!0,!1,!1,!0)),e.shiftKey?s[t][a]=x(c?r.extra:r.main):s[t][a]=c?o:x(r.main)}(e,t,a,this.props.frame.layers[this.props.frame.currentLayer],this.props.colors,this.props.canvasSize),this.props.tools.Move.value&&this.isDrawing&&function(e,t,a,s,r){var n=a.y-t,i=a.x-e;if(i>0)for(;0!==i;)s.shift(),s.push(new Array(r).fill([0,0,0,0])),i--;if(i<0)for(;0!==i;)s.unshift(new Array(r).fill([0,0,0,0])),s.pop(),i++;if(n>0)for(;0!==n;)s.forEach(function(e){e.shift(),e.push([0,0,0,0])}),n--;if(n<0)for(;0!==n;)s.forEach(function(e){e.unshift([0,0,0,0]),e.pop()}),n++;a.y=t,a.x=e}(t,a,this.startCoords,this.props.frame.layers[this.props.frame.currentLayer],this.props.canvasSize),this.props.tools.Eraser.value&&this.isDrawing&&function(e,t,a){a[e][t]=[0,0,0,0]}(t,a,this.props.frame.layers[this.props.frame.currentLayer]),this.props.tools.Stroke.value&&this.isDrawing){var s=C(this.props.frame);this.frameCopy.layers[this.frameCopy.currentLayer]=function(e,t,a,s,r,n,i){var o=Math.abs(s-t),c=Math.abs(r-a),l=t<s?1:-1,u=a<r?1:-1,p=o-c;for(1===e.nativeEvent.buttons?n[s][r]=x(i.main):n[s][r]=x(i.extra);t!==s||a!==r;){n[t][a]=1===e.nativeEvent.buttons?n[t][a]=x(i.main):n[t][a]=x(i.extra);var h=2*p;h>-c&&(p-=c,t+=l),h<o&&(p+=o,a+=u)}return n}(e,this.startCoords.x,this.startCoords.y,t,a,s.layers[s.currentLayer],this.props.colors),this.state.showLayers?k(this.canvas,N(this.frameCopy.layers),this.props.frame.currentLayer,this.pikselSize):L(this.canvas,this.frameCopy.layers[this.frameCopy.currentLayer],this.pikselSize)}if(this.props.tools.Rectangle.value&&this.isDrawing){var r=C(this.props.frame);this.frameCopy.layers[this.frameCopy.currentLayer]=function(e,t,a,s,r,n){for(var i=t.x,o=t.y;i!==a;)1===e.nativeEvent.buttons?r[i][t.y]=x(n.main):r[i][t.y]=x(n.extra),i=t.x<a?i+=1:i-=1;for(;o!==s;)1===e.nativeEvent.buttons?r[t.x][o]=x(n.main):r[t.x][o]=x(n.extra),1===e.nativeEvent.buttons?r[i][o]=x(n.main):r[i][o]=x(n.extra),t.y<s?o++:o--;for(;i!==t.x;)1===e.nativeEvent.buttons?r[i][o]=x(n.main):r[i][o]=x(n.extra),t.x<i?i--:i++,1===e.nativeEvent.buttons?r[i][o]=x(n.main):r[i][o]=x(n.extra);return r}(e,this.startCoords,t,a,r.layers[r.currentLayer],this.props.colors),this.state.showLayers?k(this.canvas,N(this.frameCopy.layers),this.props.frame.currentLayer,this.pikselSize):L(this.canvas,this.frameCopy.layers[this.frameCopy.currentLayer],this.pikselSize)}if(this.props.tools.Circle.value&&this.isDrawing){var n=C(this.props.frame);this.frameCopy.layers[this.frameCopy.currentLayer]=function(e,t,a,s,r,n,i){for(var o=Math.floor(Math.sqrt(Math.pow(a.x-s,2)+Math.pow(a.y-r,2),2)),c=0,l=o,u=0,p=2-2*o;l>=0;)a.x+c>=0&&a.x+c<=i-1&&a.y-l>=0&&a.y-l<=i-1&&(1===e.nativeEvent.buttons?t[a.x+c][a.y-l]=x(n.main):t[a.x+c][a.y-l]=x(n.extra)),a.x-c>=0&&a.x-c<=i-1&&a.y-l>=0&&a.y-l<=i-1&&(1===e.nativeEvent.buttons?t[a.x-c][a.y-l]=x(n.main):t[a.x-c][a.y-l]=x(n.extra)),a.x-c>=0&&a.x-c<=i-1&&a.y+l>=0&&a.y+l<=i-1&&(1===e.nativeEvent.buttons?t[a.x-c][a.y+l]=x(n.main):t[a.x-c][a.y+l]=x(n.extra)),a.x+c>=0&&a.x+c<=i-1&&a.y+l>=0&&a.y+l<=i-1&&(1===e.nativeEvent.buttons?t[a.x+c][a.y+l]=x(n.main):t[a.x+c][a.y+l]=x(n.extra)),u=2*(p+l)-1,p<0&&u<=0?p+=2*++c+1:p>0&&u>0?p-=2*--l+1:(p+=2*(++c-l),l--);return t}(e,n.layers[n.currentLayer],this.startCoords,t,a,this.props.colors,this.props.canvasSize),this.state.showLayers?k(this.canvas,N(this.frameCopy.layers),this.props.frame.currentLayer,this.pikselSize):L(this.canvas,this.frameCopy.layers[this.frameCopy.currentLayer],this.pikselSize)}this.setMousePosition({x:t,y:a})}},{key:"mouseUpHandler",value:function(){this.isDrawing=!1,this.frameCopy?(this.props.updateFrames(this.frameCopy),this.frameCopy=null):this.props.tools.Bucket.value||this.props.tools.ColorPicker.value||this.props.tools.Lighten.value||this.props.tools.Brush.value||this.props.tools.VerticalReverse.value||this.props.tools.HorizontalReverse.value||this.props.updateFrames(this.props.frame)}},{key:"mouseClickHandler",value:function(e){e.preventDefault(),this.props.tools.Bucket.value&&function(e,t,a,s,r,n){var i=function(e,t){return e.toString()===t.toString()},o=x(n.main);e.shiftKey&&(o=x(n.extra));var c=t[a][s];if(!i(c,o))for(var l=[a,s];l.length>0;){var u=l.pop(),p=l.pop(),h=null;p>=0&&p<r&&u>=0&&u<r&&(h=t[p][u]),h&&i(h,c)&&(t[p][u]=o,l.push(p+1,u),l.push(p-1,u),l.push(p,u+1),l.push(p,u-1))}}(e,this.props.frame.layers[this.props.frame.currentLayer],this.startCoords.x,this.startCoords.y,this.props.canvasSize,this.props.colors),this.props.tools.ColorPicker.value&&function(e,t,a,s){var r=t[a.x][a.y];r&&(e.shiftKey?s(O("rgba(".concat(r.join(),")"))):s(O("rgba(".concat(r.join(),")")),!0))}(e,this.props.frame.layers[this.props.frame.currentLayer],this.startCoords,this.props.setColor),this.props.tools.Lighten.value&&function(e,t,a){var s=["1",".9",".8",".7",".6",".5",".4",".3",".2",".1"],r=Math.floor(e.nativeEvent.offsetX/a),n=Math.floor(e.nativeEvent.offsetY/a),i=t[r][n];if(i){var o=i[3];if(e.shiftKey){var c=s[s.indexOf(o)-1];i[3]=c,t[r][n]=i}else{var l=s[s.indexOf(o)+1];i[3]=l,t[r][n]=i}}}(e,this.props.frame.layers[this.props.frame.currentLayer],this.pikselSize),this.props.tools.Brush.value&&function(e,t,a){e.shiftKey&&t.layers.forEach(function(e){e.forEach(function(t,s){t.forEach(function(t,r){e[s][r]=x(a.main)})})}),t.layers[t.currentLayer].forEach(function(e,s){e.forEach(function(e,r){t.layers[t.currentLayer][s][r]=x(a.main)})})}(e,this.props.frame,this.props.colors),this.props.tools.VerticalReverse.value&&this.props.frame.layers[this.props.frame.currentLayer].map(function(e){return e.reverse()}),this.props.tools.HorizontalReverse.value&&function(e){e.reverse()}(this.props.frame.layers[this.props.frame.currentLayer]),this.state.showLayers?k(this.canvas,N(this.props.frame.layers),this.props.frame.currentLayer,this.pikselSize):L(this.canvas,this.props.frame.layers[this.props.frame.currentLayer],this.pikselSize),(this.props.tools.Bucket.value||this.props.tools.ColorPicker.value||this.props.tools.Lighten.value||this.props.tools.Brush.value||this.props.tools.VerticalReverse.value||this.props.tools.HorizontalReverse.value)&&this.props.updateFrames(this.props.frame)}},{key:"mouseLeaveHandler",value:function(){this.isDrawing&&(this.frameCopy?(L(this.canvas,this.frameCopy,this.pikselSize),this.props.frame.layers[this.props.frame.currentLayer]=this.frameCopy,this.props.updateFrames(this.props.frame),this.frameCopy=null):this.props.updateFrames(this.props.frame)),this.isDrawing=!1}},{key:"mouseWheelHandler",value:function(e){e=window.event;var t=Math.max(-1,Math.min(1,e.wheelDelta));this.refs.canvas.style.width=Math.max(640,Math.min(900,this.refs.canvas.offsetWidth+32*t))+"px",this.refs.canvas.style.height=Math.max(640,Math.min(900,this.refs.canvas.offsetHeight+32*t))+"px"}},{key:"setCurrentLayer",value:function(e){this.props.frame.currentLayer=e,this.currentLayer=e,this.props.updateFrames(this.props.frame)}},{key:"addLayer",value:function(){var e;this.props.frame.layers.push((e=this.props.canvasSize,Array.from(Array(e).fill([0,0,0,0]),function(){return new Array(e).fill([0,0,0,0])}))),this.props.frame.currentLayer++,this.props.updateFrames(this.props.frame)}},{key:"deleteLayer",value:function(){this.props.frame.layers.splice(this.props.frame.currentLayer,1),0!==this.props.frame.currentLayer&&this.props.frame.currentLayer--,this.props.updateFrames(this.props.frame)}},{key:"toggleShowLayers",value:function(){this.setState(function(e){return{showLayers:!e.showLayers}})}},{key:"setNextLayer",value:function(){this.props.frame.currentLayer!==this.props.frame.layers.length-1&&(this.props.frame.currentLayer++,this.props.updateFrames(this.props.frame))}},{key:"setPreviousLayer",value:function(){0!==this.props.frame.currentLayer&&(this.props.frame.currentLayer--,this.props.updateFrames(this.props.frame))}},{key:"setLayersToSwap",value:function(e,t){t?this.layersToSwap.firstLayer=e:this.layersToSwap.secondLayer=e}},{key:"swapLayers",value:function(){var e=this.props.frame.layers[this.layersToSwap.firstLayer],t=this.props.frame.layers[this.layersToSwap.secondLayer];this.props.frame.layers.splice(this.layersToSwap.firstLayer,1,t),this.props.frame.layers.splice(this.layersToSwap.secondLayer,1,e),this.props.updateFrames(this.props.frame)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"canvas-container"},r.a.createElement(E,{size:this.props.canvasSize,mousePosition:this.state.mousePosition}),r.a.createElement("div",{className:"canvas-wrapper"},r.a.createElement("canvas",{className:"canvas",ref:"canvas",width:this.canvasSize,height:this.canvasSize,onContextMenu:function(e){e.preventDefault()},onMouseDown:function(t){return e.mouseDownHandler(t)},onMouseMove:function(t){return e.mouseMoveHandler(t)},onMouseUp:function(){return e.mouseUpHandler()},onClick:function(t){return e.mouseClickHandler(t)},onMouseLeave:function(){return e.mouseLeaveHandler()},onWheel:function(t){return e.mouseWheelHandler()}})),r.a.createElement(w,{setCurrentLayer:function(t){return e.setCurrentLayer(t)},frame:this.props.frame,addLayer:function(){return e.addLayer()},deleteLayer:function(){return e.deleteLayer()},showLayers:function(){return e.toggleShowLayers()},setNextLayer:function(){return e.setNextLayer()},setPreviousLayer:function(){return e.setPreviousLayer()},isShowing:this.state.showLayers,setLayersToSwap:function(t,a){return e.setLayersToSwap(t,a)},swapLayers:function(){return e.swapLayers()}}))}}]),t}(r.a.Component),A=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={showTooltip:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"showTooltip",value:function(){this.setState({showTooltip:!0})}},{key:"hideTooltip",value:function(){this.setState({showTooltip:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{onMouseEnter:function(){return e.showTooltip()},onMouseLeave:function(){return e.hideTooltip()},onClick:this.props.callBack,className:this.props.checked?this.props.name:"".concat(this.props.name," checked")}),this.state.showTooltip&&r.a.createElement("div",{ref:"toolTip",className:"tooltip"},r.a.createElement("p",null,"".concat(this.props.name," tool"),r.a.createElement("span",null,"(".concat(this.props.shortcut,")")))))}}]),t}(r.a.Component),I=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"isChanging",value:function(){var e=this;document.querySelectorAll(".shortcut").forEach(function(e){return e.classList.remove("sc-changing")}),this.refs.shortcut.classList.add("sc-changing"),document.onkeyup=function(t){e.props.setShortcut(e.props.tool,t.keyCode),e.isChanged()}}},{key:"isChanged",value:function(){this.refs.shortcut.classList.remove("sc-changing")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"sc-info-wrapper",onClick:function(){return e.isChanging()}},r.a.createElement("h3",null,"".concat(this.props.tool,":")),r.a.createElement("p",{className:"shortcut",ref:"shortcut"},"'".concat(this.props.shortcut,"'")))}}]),t}(r.a.Component),M=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).copy=JSON.parse(JSON.stringify(a.props.tools)),a.state={tools:JSON.parse(JSON.stringify(a.props.tools))},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"createBtnsInfo",value:function(){var e=this,t=[];for(var a in this.state.tools)t.push(r.a.createElement(I,{key:a,tool:a,shortcut:this.state.tools[a].shortcut,setShortcut:function(t,a){return e.setShortcut(t,a)}}));return t}},{key:"setShortcut",value:function(e,t){var a=Object.assign({},this.state.tools);for(var s in a)a[s].shortcut===String.fromCharCode(t).toUpperCase()&&(a[s].shortcut=a[e].shortcut);a[e].shortcut=String.fromCharCode(t).toUpperCase(),this.setState({tools:a}),document.onkeyup=null}},{key:"setDefaultValue",value:function(){this.setState({tools:this.copy}),this.props.togglePopup(),this.forceUpdate()}},{key:"updateShortcuts",value:function(){this.props.updateShortcuts(this.state.tools),this.props.togglePopup()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"sc-popup"},this.createBtnsInfo(),r.a.createElement("button",{className:"save-sc-btn",onClick:function(){return e.updateShortcuts()}},"Save"),r.a.createElement("button",{className:"cancel-sc-btn",onClick:function(){return e.setDefaultValue()}},"Cancel"))}}]),t}(r.a.Component),D=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={showPopup:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",function(t){for(var a in e.props.tools)String.fromCharCode(t.keyCode).toUpperCase()===e.props.tools[a].shortcut&&e.props.setTools(a)})}},{key:"togglePopup",value:function(){this.setState({showPopup:!this.state.showPopup})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("button",{className:"shortcuts",onClick:function(){return e.togglePopup()}}),this.state.showPopup&&r.a.createElement(M,{togglePopup:function(){return e.togglePopup()},updateShortcuts:function(t){return e.props.updateShortcuts(t)},tools:this.props.tools}))}}]),t}(r.a.Component),R=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"createButtons",value:function(){var e=this,t=[],a=function(a){var s=!0;e.props.tools[a].value&&(s=!1),t.push(r.a.createElement(A,{checked:s,name:a,key:a,callBack:function(){return e.props.setTools(a)},shortcut:e.props.tools[a].shortcut}))};for(var s in this.props.tools)a(s);return t}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"tools"},this.createButtons(),r.a.createElement("div",{className:"colors"},r.a.createElement("input",{className:"mainColor",value:this.props.colors.main,onChange:function(t){return e.props.setColor(t.target.value,!0)},type:"color"}),r.a.createElement("input",{className:"extraColor",value:this.props.colors.extra,onChange:function(t){return e.props.setColor(t.target.value)},type:"color"}),r.a.createElement("div",{className:"swap",onClick:function(){return e.props.swapColors()}})),r.a.createElement(D,{updateShortcuts:function(t){return e.props.updateShortcuts(t)},tools:this.props.tools,setTools:function(t){return e.props.setTools(t)}}))}}]),t}(r.a.Component),P=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).readyToSave=!1,a.imgsToGif=[],a.imgsToPng=[],a.framesToShow=[],a.interval=null,a.canvasSize=384,a.currentFrame=0,a.state={speed:12},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return(JSON.stringify(this.props.frames)!==JSON.stringify(e.frames)||t.speed!==this.state.speed)&&(this.pikselSize=Math.floor(this.canvasSize/this.props.canvasSize),this.currentFrame=0,L(this.canvas,this.props.frames[this.currentFrame].layers[this.props.frames[this.currentFrame].currentLayer],this.pikselSize),!0)}},{key:"componentDidMount",value:function(){var e=this.refs.canvas;this.pikselSize=Math.floor(this.canvasSize/this.props.canvasSize),this.canvas=e,this.ctx=e.getContext("2d"),this.startAnimation()}},{key:"componentDidUpdate",value:function(){clearInterval(this.interval),this.framesToShow=[],this.readyToSave=!1,this.imgsToGif=[],this.imgsToPng=[],this.pikselSize=Math.floor(this.canvasSize/this.props.canvasSize),this.currentFrame=0,this.props.frames[this.currentFrame].layers.length>1?L(this.canvas,this.props.frames[this.currentFrame].layers,this.pikselSize,!0):L(this.canvas,this.props.frames[this.currentFrame].layers[0],this.pikselSize),this.startAnimation()}},{key:"startAnimation",value:function(){var e=this;this.interval=setInterval(function(){e.framesToShow.length===e.props.frames.length?e.ctx.putImageData(e.framesToShow[e.currentFrame],0,0):(L(e.canvas,e.props.frames[e.currentFrame].layers,e.pikselSize,!0),e.framesToShow.push(e.ctx.getImageData(0,0,e.canvasSize,e.canvasSize))),e.imgsToGif.length===e.props.frames.length||e.readyToSave?!1===e.readyToSave&&(e.props.setFramesToSave(e.imgsToGif,e.imgsToPng,e.state.speed),e.readyToSave=!0):(e.imgsToGif.push(e.canvas.toDataURL("image/png")),e.imgsToPng.push(e.ctx.getImageData(0,0,e.canvasSize,e.canvasSize).data.buffer)),e.currentFrame++,e.currentFrame===e.props.frames.length&&(e.currentFrame=0)},1e3/this.state.speed)}},{key:"setSpeed",value:function(e){clearInterval(this.interval);var t=e.target.value;this.setState({speed:t}),this.startAnimation()}},{key:"toggleFullscreen",value:function(){var e=document.querySelector(".preview-wrapper");document.fullscreenElement?document.exitFullscreen():e.requestFullscreen()}},{key:"showFullScreenButton",value:function(){this.refs.fsButton.style.opacity="1"}},{key:"hideFullScreenButton",value:function(){this.refs.fsButton.style.opacity="0"}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"previev-container"},r.a.createElement("div",{onMouseEnter:function(){return e.showFullScreenButton()},onMouseLeave:function(){return e.hideFullScreenButton()},className:"preview-wrapper"},r.a.createElement("canvas",{className:"preview",ref:"canvas",width:this.canvasSize,height:this.canvasSize}),r.a.createElement("button",{className:"preview-fullscreen",ref:"fsButton",onClick:function(t){return e.toggleFullscreen(t)}})),r.a.createElement("p",null,"FPS Rate: ".concat(this.state.speed)),r.a.createElement("input",{onInput:function(t){return e.setSpeed(t)},type:"range",min:"1",max:"24",defaultValue:"12"}))}}]),t}(r.a.Component),H=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).pikselSize=null,a.frameSize=256,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e){return JSON.stringify(this.props.frame)!==JSON.stringify(e.frame)}},{key:"componentDidMount",value:function(){var e=this.refs.canvas;this.canvas=e,this.pikselSize=Math.floor(this.frameSize/this.props.canvasSize),L(e,this.props.frame.layers[this.props.frame.currentLayer],this.pikselSize)}},{key:"componentDidUpdate",value:function(){this.pikselSize=Math.floor(this.frameSize/this.props.canvasSize),L(this.canvas,this.props.frame.layers[this.props.frame.currentLayer],this.pikselSize)}},{key:"showButtons",value:function(){this.refs.clone.style.opacity="1",this.refs.delete.style.opacity="1"}},{key:"hideButtons",value:function(){this.refs.clone.style.opacity="0",this.refs.delete.style.opacity="0"}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{onMouseEnter:function(){return e.showButtons()},onMouseLeave:function(){return e.hideButtons()},className:this.props.current?"frame-wrapper frame-wrapper-active":"frame-wrapper"},r.a.createElement("canvas",{className:"frame-canvas",draggable:"true",ref:"canvas",width:this.frameSize,height:this.frameSize,onClick:function(){return e.props.setCurrentFrame(e.props.frame)},onDragEnter:function(){e.canvas.parentNode.classList.add("frame-wrapper-dragEnter"),e.props.setTargetToSwap(e.props.frame,!1)},onDragOver:function(e){return e.preventDefault()},onDragLeave:function(){return e.canvas.parentNode.classList.remove("frame-wrapper-dragEnter")},onDragStart:function(){e.canvas.parentNode.classList.add("frame-wrapper-dragStart"),e.props.setTargetToSwap(e.props.frame,!0)},onDragEnd:function(){e.props.swapFrames(),e.canvas.parentNode.classList.remove("frame-wrapper-dragEnter"),e.canvas.parentNode.classList.remove("frame-wrapper-dragStart")}}),r.a.createElement("p",{className:"frame-number"},this.props.num+1),r.a.createElement("button",{className:"frame-copy",ref:"clone",onClick:function(){return e.props.cloneFrame(e.props.frame)}}),r.a.createElement("button",{className:"frame-delete",ref:"delete",onClick:function(){return e.props.deleteFrame(e.props.frame)}}))}}]),t}(r.a.Component),B=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e){return JSON.stringify(this.props.frames)!==JSON.stringify(e.frames)||this.props.canvasSize!==e.canvasSize||this.props.currentFrame!==e.currentFrame}},{key:"renderFrames",value:function(){var e=this,t=[];return this.props.frames.forEach(function(a,s){var n=!1;e.props.currentFrame===s&&(n=!0),t.push(r.a.createElement(H,{current:n,canvasSize:e.props.canvasSize,num:s,key:Math.random().toString(36).substring(7),frame:a,deleteFrame:e.props.deleteFrame,cloneFrame:e.props.cloneFrame,setCurrentFrame:e.props.setCurrentFrame,setTargetToSwap:e.props.setTargetToSwap,swapFrames:e.props.swapFrames}))}),t}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"frames-wrapper"},this.renderFrames(),r.a.createElement("button",{className:"add-frame",onClick:function(){return e.props.addFrame()}},r.a.createElement("p",null,"Add new frame")))}}]),t}(r.a.Component),G=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={mail:null},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){try{window.gapi.load("auth2",function(){window.gapi.auth2.init({client_id:"355911681552-osgglvf1ep2a6ivbi8h0uhd8nprv452a.apps.googleusercontent.com"})})}catch(e){console.log(e.message)}}},{key:"signIn",value:function(){var e=this;window.gapi.auth2.getAuthInstance().signIn({scope:"https://www.googleapis.com/auth/drive"}).then(function(t){return e.setState({mail:t.w3.U3})})}},{key:"singOut",value:function(){var e=this;window.gapi.auth2.getAuthInstance().signOut().then(function(t){return e.setState({mail:null})})}},{key:"render",value:function(){var e=this,t=this.state.mail;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"logo"}),r.a.createElement("div",{className:"user-info-wrapper"},r.a.createElement("p",{className:"user-info"},this.state.mail),!t&&r.a.createElement("button",{onClick:function(){return e.signIn()}},"Log In"),t&&r.a.createElement("button",{onClick:function(){return e.singOut()}},"Log Out")))}}]),t}(r.a.PureComponent),J=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={showSaveInfo:!1,showResizeInfo:!1,project:"Import .rss file..."},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"showResizeInfo",value:function(){this.state.showSaveInfo||this.state.showResizeInfo||(this.setState({showResizeInfo:!0}),this.refs.settings.classList.add("show-settings"),this.refs.resizeInfo.style.borderRight="none"),this.state.showResizeInfo&&this.refs.settings.classList.toggle("show-settings"),this.state.showSaveInfo&&(this.setState({showResizeInfo:!0,showSaveInfo:!1}),this.refs.saveInfo.style.borderRight="3px solid black",this.refs.resizeInfo.style.borderRight="none",this.refs.settings.classList.add("show-settings"))}},{key:"showSaveInfo",value:function(){this.state.showSaveInfo||this.state.showResizeInfo||(this.setState({showSaveInfo:!0}),this.refs.settings.classList.add("show-settings"),this.refs.saveInfo.style.borderRight="none"),this.state.showSaveInfo&&this.refs.settings.classList.toggle("show-settings"),this.state.showResizeInfo&&(this.setState({showResizeInfo:!1,showSaveInfo:!0}),this.refs.resizeInfo.style.borderRight="3px solid black",this.refs.saveInfo.style.borderRight="none",this.refs.settings.classList.add("show-settings"))}},{key:"importRssFileHandler",value:function(){this.setState({project:document.querySelector("input[type=file]").files[0].name})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{ref:"settings",className:"settings"},r.a.createElement("div",{className:"settings-btn-wrapper"},r.a.createElement("button",{className:"saveInfo-btn",ref:"saveInfo",onClick:function(){return e.showSaveInfo()}}),r.a.createElement("button",{className:"resizeInfo-btn",ref:"resizeInfo",onClick:function(){return e.showResizeInfo()}})),r.a.createElement("div",{className:"settings-info-container"},this.state.showResizeInfo&&r.a.createElement("div",{className:"canvas-resize-wrapper"},r.a.createElement("h3",null,"Current size: ".concat(this.props.canvasSize," x ").concat(this.props.canvasSize)),r.a.createElement("div",{className:"button",onClick:function(){return e.props.resize(32)}},r.a.createElement("p",{className:"btnText"},"32x32"),r.a.createElement("div",{className:"btnTwo"},r.a.createElement("p",{className:"btnText2"},"Resize"))),r.a.createElement("div",{className:"button",onClick:function(){return e.props.resize(64)}},r.a.createElement("p",{className:"btnText"},"64x64"),r.a.createElement("div",{className:"btnTwo"},r.a.createElement("p",{className:"btnText2"},"Resize"))),r.a.createElement("div",{className:"button",onClick:function(){return e.props.resize(128)}},r.a.createElement("p",{className:"btnText"},"128x128"),r.a.createElement("div",{className:"btnTwo"},r.a.createElement("p",{className:"btnText2"},"Resize")))),this.state.showSaveInfo&&r.a.createElement("div",null,r.a.createElement("div",{className:"canvas-saveInfo-wrapper"},r.a.createElement("div",{className:"save-format-btn-wrapper"},r.a.createElement("input",{type:"file",id:"file",className:"inputFile",onChange:function(){e.importRssFileHandler(),e.props.importRssFile()}}),r.a.createElement("label",{htmlFor:"file"},r.a.createElement("div",{className:"import-file"}),this.state.project),r.a.createElement("h3",null,"Save as:"),r.a.createElement("div",{className:"button",onClick:this.props.saveAsGif},r.a.createElement("p",{className:"btnText"},".gif"),r.a.createElement("div",{className:"btnTwo"},r.a.createElement("p",{className:"btnText2"},"Save"))),r.a.createElement("div",{className:"button",onClick:this.props.saveAsApng},r.a.createElement("p",{className:"btnText"},".apng"),r.a.createElement("div",{className:"btnTwo"},r.a.createElement("p",{className:"btnText2"},"Save"))),r.a.createElement("div",{className:"button",onClick:this.props.saveAsPiskel},r.a.createElement("p",{className:"btnText"},".piskel"),r.a.createElement("div",{className:"btnTwo"},r.a.createElement("p",{className:"btnText2"},"Save"))),r.a.createElement("div",{className:"button",onClick:this.props.saveAsRss},r.a.createElement("p",{className:"btnText"},".rss"),r.a.createElement("div",{className:"btnTwo"},r.a.createElement("p",{className:"btnText2"},"Save")))),r.a.createElement("div",{className:"save-location-btn-wrapper"},r.a.createElement("h3",null,"Save to:"),r.a.createElement("div",{className:"button",onClick:this.props.saveToLocalStorage},r.a.createElement("p",{className:"btnText"},"Storage"),r.a.createElement("div",{className:"btnTwo"},r.a.createElement("p",{className:"btnText2"},"Save"))),r.a.createElement("div",{className:"button",onClick:this.props.saveToGoogleDrive},r.a.createElement("p",{className:"btnText"},"Google"),r.a.createElement("div",{className:"btnTwo"},r.a.createElement("p",{className:"btnText2"},"Upload"))))))))}}]),t}(r.a.Component),U=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).targetsToSwap={firstTarget:null,secondTarget:null},a.state={projectIsStarted:!1,canvasSize:32,frames:[b(32)],stateHistory:[],currentFrame:0,framesToSaveAsGif:[],framesToSaveAsApng:[],animationSpeed:null,colors:{main:"#000000",extra:"#8080ff"},tools:{Pen:{value:!1,shortcut:"Q"},Mirror:{value:!1,shortcut:"W"},Bucket:{value:!1,shortcut:"E"},Eraser:{value:!1,shortcut:"R"},Brush:{value:!1,shortcut:"T"},Stroke:{value:!1,shortcut:"Y"},Rectangle:{value:!1,shortcut:"A"},Circle:{value:!1,shortcut:"S"},Move:{value:!1,shortcut:"D"},ColorPicker:{value:!1,shortcut:"F"},Lighten:{value:!1,shortcut:"G"},Dithering:{value:!1,shortcut:"H"},VerticalReverse:{value:!1,shortcut:"C"},HorizontalReverse:{value:!1,shortcut:"X"}}},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keypress",function(t){26===t.keyCode&&t.ctrlKey&&e.state.stateHistory.length&&e.stepBack()}),localStorage.getItem("state")&&this.setState(Object(o.a)({},JSON.parse(localStorage.getItem("state"))))}},{key:"setFramesToSave",value:function(e,t,a){this.setState({framesToSaveAsGif:e,framesToSaveAsApng:t,animationSpeed:a})}},{key:"saveToLocalStorage",value:function(){localStorage.clear(),localStorage.setItem("state",JSON.stringify(this.state))}},{key:"saveAsApng",value:function(){var e=y.a.encode(this.state.framesToSaveAsApng,384,384,0,new Array(this.state.framesToSaveAsApng.length).fill(1e3/this.state.animationSpeed));m()(e,"newAPNG.apng","apng")}},{key:"saveAsPiskel",value:function(){var e,t,a,s;m()((e=1/this.state.animationSpeed,t=384,a=this.state.framesToSaveAsGif.length,s=this.state.framesToSaveAsGif,'{"modelVersion":2,"piskel":{"name":"piskel","description":"","fps":'.concat(e,',"height":').concat(t,',"width":').concat(t,',"layers":["{"name":"Layer 1","opacity":1,"frameCount":').concat(a,',"chunks":[{"layout":[[0]],"base64PNG":"data: ').concat(s,'}]"hiddenFrames":[]}"]}}')),"newPiskel.piskel","piskel")}},{key:"saveAsRss",value:function(){m()(JSON.stringify(z(this.state,this.state.frames)),"project.rss","rss")}},{key:"saveToGoogleDrive",value:function(){!function(e){var t=new Blob([e],{type:"image/apng"}),a=window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token,s=new FormData;s.append("metadata",new Blob([JSON.stringify({name:"newPiskel.apng",mimeType:"apng"})],{type:"application/json"})),s.append("file",t),fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id",{name:"piskel.jpg",method:"POST",headers:new Headers({Authorization:"Bearer "+a}),body:s})}(y.a.encode(this.state.framesToSaveAsApng,384,384,0,new Array(this.state.framesToSaveAsApng.length).fill(1e3/this.state.animationSpeed)))}},{key:"importRssFile",value:function(){var e=this;!function(e){var t=window.URL.createObjectURL(document.querySelector("input[type=file]").files[0]),a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET",t,!0),a.onreadystatechange=function(){4===a.readyState&&e(a.responseText)},a.send(null)}(function(t){return e.setState(Object(o.a)({},JSON.parse(t),{stateHistory:[]}))})}},{key:"stepBack",value:function(){var e=this.state.stateHistory.pop(),t=e.speed,a=e.canvasSize,s=e.frames,r=e.currentFrame,n=e.colors,i=e.tools;this.setState({speed:t,canvasSize:a,frames:s,currentFrame:r,colors:n,tools:i})}},{key:"saveCurrentState",value:function(){var e=z(this.state,this.state.frames),t=N(this.state.stateHistory);return t.length>5&&t.shift(),t.push(e),t}},{key:"resize",value:function(e){var t=N(this.state.frames),a=this.saveCurrentState();t=T(t,this.state.canvasSize,e),this.setState({frames:t,canvasSize:e,stateHistory:a})}},{key:"updateFrames",value:function(e){if(JSON.stringify(this.state.frames[this.state.currentFrame])===JSON.stringify(e))return!1;var t=N(this.state.frames),a=this.saveCurrentState();t[this.state.currentFrame]=e,this.setState({frames:t,stateHistory:a})}},{key:"setCurrentFrame",value:function(e){var t=this.saveCurrentState(),a=this.state.frames.indexOf(e);this.setState({currentFrame:a,stateHistory:t})}},{key:"addFrame",value:function(){var e=N(this.state.frames),t=this.saveCurrentState();e.push(b(this.state.canvasSize));var a=this.state.currentFrame;a+=1,this.setState({frames:e,currentFrame:a,stateHistory:t})}},{key:"deleteFrame",value:function(e){var t=N(this.state.frames),a=this.saveCurrentState();if(1===t.length)this.setState({frames:[b(this.state.canvasSize)],stateHistory:a});else{var s=this.state.currentFrame,r=this.state.frames.indexOf(e);0!==s&&(s-=1),t.splice(r,1),this.setState({frames:t,currentFrame:s})}}},{key:"cloneFrame",value:function(e){var t=N(this.state.frames),a=this.saveCurrentState(),s=this.state.currentFrame;s++,t.splice(this.state.frames.indexOf(e),0,C(e)),this.setState({frames:t,currentFrame:s,stateHistory:a})}},{key:"setColor",value:function(e,t){var a=this.saveCurrentState();t?this.setState({stateHistory:a,colors:{main:e,extra:this.state.colors.extra}}):this.setState({stateHistory:a,colors:{main:this.state.colors.main,extra:e}})}},{key:"swapColors",value:function(){var e=this.saveCurrentState();this.setState(function(t){return{stateHistory:e,colors:{main:t.colors.extra,extra:t.colors.main}}})}},{key:"setTools",value:function(e){var t=Object.assign({},this.state.tools);for(var a in t[e].value=!t[e].value,t)a!==e&&(t[a].value=!1);this.setState({tools:t})}},{key:"updateShortcuts",value:function(e){this.setState({tools:e})}},{key:"setTargetToSwap",value:function(e,t){t?this.targetsToSwap.firstTarget=e:this.targetsToSwap.secondTarget=e}},{key:"saveAsGif",value:function(){g.a.createGIF({images:this.state.framesToSaveAsGif,interval:1/this.state.animationSpeed,gifWidth:384,gifHeight:384},function(e){e.error||m()(e.image,"newGif.gif","gif")})}},{key:"startProject",value:function(){this.setState({projectIsStarted:!0})}},{key:"swapFrames",value:function(){if(this.targetsToSwap.secondTarget&&this.targetsToSwap.firstTarget!==this.targetsToSwap.secondTarget){var e=this.saveCurrentState(),t=N(this.state.frames);t.splice(this.state.frames.indexOf(this.targetsToSwap.firstTarget),1,this.targetsToSwap.secondTarget),t.splice(this.state.frames.indexOf(this.targetsToSwap.secondTarget),1,this.targetsToSwap.firstTarget),this.setState({frames:t,stateHistory:e})}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(G,null),!this.state.projectIsStarted&&r.a.createElement(S,{startProject:function(){return e.startProject()}}),this.state.projectIsStarted&&r.a.createElement("div",{className:"container"},r.a.createElement(R,{tools:this.state.tools,setTools:function(t){return e.setTools(t)},setColor:function(t,a){return e.setColor(t,a)},swapColors:function(){return e.swapColors()},colors:this.state.colors,updateShortcuts:function(t){return e.updateShortcuts(t)}}),r.a.createElement(B,{currentFrame:this.state.currentFrame,canvasSize:this.state.canvasSize,frames:this.state.frames,addFrame:function(){return e.addFrame()},deleteFrame:function(t){return e.deleteFrame(t)},cloneFrame:function(t){return e.cloneFrame(t)},setCurrentFrame:function(t){return e.setCurrentFrame(t)},setTargetToSwap:function(t,a){return e.setTargetToSwap(t,a)},swapFrames:function(){return e.swapFrames()}}),r.a.createElement(F,{frames:N(this.state.frames),setMousePosition:function(t){return e.setMousePosition(t)},canvasSize:this.state.canvasSize,tools:this.state.tools,colors:this.state.colors,updateFrames:function(t){return e.updateFrames(t)},frame:C(this.state.frames[this.state.currentFrame]),setColor:function(t,a){return e.setColor(t,a)}}),r.a.createElement(P,{frames:this.state.frames,canvasSize:this.state.canvasSize,setFramesToSave:function(t,a,s){return e.setFramesToSave(t,a,s)}}),r.a.createElement(J,{saveAsApng:function(){return e.saveAsApng()},saveAsGif:function(){return e.saveAsGif()},saveToGoogleDrive:function(){return e.saveToGoogleDrive()},saveToLocalStorage:function(){return e.saveToLocalStorage()},saveAsPiskel:function(){return e.saveAsPiskel()},resize:function(t){return e.resize(t)},canvasSize:this.state.canvasSize,saveAsRss:function(){return e.saveAsRss()},importRssFile:function(){return e.importRssFile()}})))}}]),t}(r.a.Component);i.a.render(r.a.createElement(U,null),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.f252b7c2.chunk.js.map