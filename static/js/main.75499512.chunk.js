(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){e.exports=a(36)},25:function(e,t,a){},36:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(17),i=a.n(s),o=a(10),c=a(1),l=a(2),u=a(4),m=a(3),h=a(5),f=(a(25),a(7)),p=a.n(f),v=a(9),y=a.n(v),d=a(18),g=a.n(d),S=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"start-page"},n.a.createElement("section",{className:"main-title"},n.a.createElement("div",{className:"main-title-left"},n.a.createElement("h2",{className:"title-text-main"},"Piskel-clone is a final project of the second stage course of The Rolling Scopes School"),n.a.createElement("p",{className:"title-text"},"Create animations in your browser"),n.a.createElement("button",{onClick:this.props.startProject},"Create Sprite")),n.a.createElement("div",{className:"main-title-right"},n.a.createElement("div",{className:"piskel-screen"}))),n.a.createElement("section",{className:"sprites-section"},n.a.createElement("h2",null,"Sprites example"),n.a.createElement("div",{className:"sprites-gallery"},n.a.createElement("div",{className:"sprite sprt1"}),n.a.createElement("div",{className:"sprite sprt2"}),n.a.createElement("div",{className:"sprite sprt3"}),n.a.createElement("div",{className:"sprite sprt4"}),n.a.createElement("div",{className:"sprite sprt5"}),n.a.createElement("div",{className:"sprite sprt6"}),n.a.createElement("div",{className:"sprite sprt7"}),n.a.createElement("div",{className:"sprite sprt8"}))),n.a.createElement("section",{className:"functionality"},n.a.createElement("h2",null,"Functionality"),n.a.createElement("div",{className:"functionality-gallery"},n.a.createElement("div",null,n.a.createElement("p",null,"Choose color"),n.a.createElement("div",{className:"functionality-wrapper fnc1"})),n.a.createElement("div",null,n.a.createElement("p",null,"Frame managment"),n.a.createElement("div",{className:"functionality-wrapper fnc2"})),n.a.createElement("div",null,n.a.createElement("p",null,"Layer managment"),n.a.createElement("div",{className:"functionality-wrapper fnc3"})),n.a.createElement("div",null,n.a.createElement("p",null,"Live preview"),n.a.createElement("div",{className:"functionality-wrapper fnc4"})),n.a.createElement("div",null,n.a.createElement("p",null,"Export to .gif/.apng"),n.a.createElement("div",{className:"functionality-wrapper fnc5"})),n.a.createElement("div",null,n.a.createElement("p",null,"Hotkeys"),n.a.createElement("div",{className:"functionality-wrapper fnc6"})),n.a.createElement("div",null,n.a.createElement("p",null,"Google SingIn"),n.a.createElement("div",{className:"functionality-wrapper fnc7"})),n.a.createElement("div",null,n.a.createElement("p",null,"Tools"),n.a.createElement("div",{className:"functionality-wrapper fnc8"})))),n.a.createElement("section",{className:"about-container"},n.a.createElement("div",{className:"author-img"}),n.a.createElement("div",{className:"about-author"},n.a.createElement("h2",{className:"author-name"},"akSr-"),n.a.createElement("p",null,"I like the programming, it's exciting and fascinating. Coding is one of the easiest ways to solve practical problems. The end product depends only upon how hight your skills and good idea but not any other factors.")),n.a.createElement("div",{className:"author-contacts"},n.a.createElement("p",null,"GitHub: ",n.a.createElement("a",{href:"https://github.com/aksr666"},"https://github.com/aksr666")))))}}]),t}(n.a.Component),E=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.mousePosition,a=e.size,r=t.x,s=t.y;return r>=a-1&&(r=a),r<=0&&(r=1),s>=a-1&&(s=a),s<=0&&(s=1),n.a.createElement("div",{className:"canvas-info"},n.a.createElement("div",{className:"cursor-position"},n.a.createElement("h2",null,"Mouse position:"),n.a.createElement("p",{className:"cursor-position-x"},"X: ".concat(r)),n.a.createElement("p",{className:"cursor-position-y"},"Y: ".concat(s))),n.a.createElement("div",{className:"canvas-size"},n.a.createElement("h3",null,"Cavas size: ".concat(a," x ").concat(a))))}}]),t}(n.a.PureComponent),b=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderLayers",value:function(){var e=this.props,t=e.frame,a=e.setCurrentLayer,r=e.setLayersToSwap,s=e.swapLayers,i=[];return t.layers.forEach(function(e,o){i.push(n.a.createElement("p",{className:t.currentLayer===o?"layer layer-current":"layer",key:Math.random().toString(36).substring(7),draggable:"true",onClick:function(){return a(o)},onDragEnter:function(e){e.target.style.border="1px dashed red",r(o,!1)},onDragOver:function(e){return e.preventDefault()},onDragLeave:function(e){return e.target.style.border="1px solid white"},onDragStart:function(e){e.target.style.opacity=.5,r(o,!0)},onDragEnd:function(e){e.target.style.opacity=1,e.target.style.border="1px solid white",s()}},"Layer-".concat(o+1)))}),i}},{key:"render",value:function(){var e=this.props,t=e.frame,a=e.addLayer,r=e.setNextLayer,s=e.setPreviousLayer,i=e.deleteLayer,o=e.showLayers,c=e.isShowing;return n.a.createElement("div",{className:"layers-info"},n.a.createElement("div",{className:"layers-header"},n.a.createElement("h3",null,"Layers"),n.a.createElement("button",{className:c?"show-layers checked":"show-layers",onClick:o})),n.a.createElement("div",{className:"layers-buttons"},n.a.createElement("button",{className:"layers-btn",onClick:a},"+"),n.a.createElement("button",{className:t.layers.length>1?"layers-btn":"layers-btn disabled",disabled:!(t.layers.length>1),onClick:i},"-"),n.a.createElement("button",{className:1!==t.layers.length?"layers-btn":"layers-btn disabled",disabled:!t.layers.length,onClick:r},n.a.createElement("p",{className:"layers-next"},"\u25ba")),n.a.createElement("button",{className:1!==t.layers.length?"layers-btn":"layers-btn disabled",disabled:!t.layers.length,onClick:s},n.a.createElement("p",{className:"layers-prev"},"\u25ba"))),this.renderLayers())}}]),t}(n.a.PureComponent),w=function(e){var t={};return t.layers=[Array.from(Array(e).fill([0,0,0,0]),function(){return new Array(e).fill([0,0,0,0])})],t.currentLayer=0,t},k=function(e){return JSON.parse(JSON.stringify(e))},N=function(e){return JSON.parse(JSON.stringify(e)).map(function(e){return JSON.parse(JSON.stringify(e))})},L=function(e,t,a,r){var n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),t.forEach(function(e,t){t===a?e.forEach(function(e,t){e.forEach(function(e,a){e.toString()!==[0,0,0,0].toString()&&(n.fillStyle=e,n.fillStyle="rgba(".concat(e.join(),")"),n.fillRect(r*t,r*a,r,r))})}):e.forEach(function(e,t){e.forEach(function(e,a){if(e.toString()!==[0,0,0,0].toString()){e.splice(e.length-1,1,".5");var s="rgba(".concat(e.join(),")");n.fillStyle=e,n.fillStyle=s,n.fillRect(r*t,r*a,r,r)}})})})},C=function(e,t,a,r){var n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),r?t.forEach(function(e){e.forEach(function(e,t){e.forEach(function(e,r){e.toString()!==[0,0,0,0].toString()&&(n.fillStyle=e,n.fillStyle="rgba(".concat(e.join(),")"),n.fillRect(a*t,a*r,a,a))})})}):t.forEach(function(e,t){e.forEach(function(e,r){e.toString()!==[0,0,0,0].toString()&&(n.fillStyle=e,n.fillStyle="rgba(".concat(e.join(),")"),n.fillRect(a*t,a*r,a,a))})})},x=function(e,t,a){return t<a?e.forEach(function(e){return e.layers.forEach(function(e){return function(e){for(var t=e.length;t!==a;)e.push(new Array(a).fill([0,0,0,0])),e.unshift(new Array(a).fill([0,0,0,0])),t=e.length;return e.forEach(function(e){for(var t=e.length;t!==a;)e.push([0,0,0,0]),e.unshift([0,0,0,0]),t=e.length}),e}(e)})}):e.forEach(function(e){return e.layers.forEach(function(e){return function(e){for(var t=e.length;t!==a;)e.pop(),e.shift(),t=e.length;return e.forEach(function(e){for(var t=e.length;t!==a;)e.pop(),e.shift(),t=e.length}),e}(e)})}),e},T=function(e,t){var a=N(t),r=Object.assign({},e,{framesToSaveAsApng:null},{framesToSaveAsGif:null},{stateHistory:null});return r.frames=a,r},O=function(e){var t;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3===(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),[(t="0x"+t.join(""))>>16&255,t>>8&255,255&t,1]},j=function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},z=function(e,t,a,r,n){1===e.nativeEvent.buttons?r[t][a]=O(n.main):r[t][a]=O(n.extra)},F=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={mousePosition:{x:0,y:0},showLayers:!1},a.layersToSwap={firstLayer:null,secondLayer:null},a.isDrawing=!1,a.canvasSize=640,a.startCoords={},a.frameCopy=null,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"setMousePosition",value:function(e){var t=Object.assign({},this.state.mousePosition);t.x=e.x,t.y=e.y,this.setState({mousePosition:t})}},{key:"componentDidMount",value:function(){var e=this.props,t=e.frame,a=e.canvasSize,r=this.refs.canvas;this.pikselSize=Math.floor(this.canvasSize/a),this.canvas=r,this.ctx=r.getContext("2d"),C(r,t.layers[t.currentLayer],this.pikselSize)}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.frame,a=e.canvasSize;this.pikselSize=this.canvasSize/a;var r=this.state.showLayers,n=this.canvas,s=this.pikselSize;this.frameCopy||(r?L(n,N(t.layers),t.currentLayer,s):C(n,t.layers[t.currentLayer],s))}},{key:"mouseDownHandler",value:function(e){e.preventDefault(),this.isDrawing=!0;var t=this.props,a=t.tools,r=t.frame,n=t.colors,s=this.state.showLayers,i=this.startCoords,o=this.pikselSize,c=this.canvas;this.startCoords.x=Math.floor(e.nativeEvent.offsetX/o),this.startCoords.y=Math.floor(e.nativeEvent.offsetY/o),(a.Stroke.value||a.Rectangle.value||a.Circle.value)&&(this.frameCopy=k(r)),a.Pen.value&&z(e,i.x,i.y,r.layers[r.currentLayer],n),s?L(c,N(r.layers),r.currentLayer,o):C(c,r.layers[r.currentLayer],o)}},{key:"mouseMoveHandler",value:function(e){var t=this.props,a=t.tools,r=t.frame,n=t.colors,s=t.canvasSize,i=this.state.showLayers,o=this.frameCopy,c=this.startCoords,l=this.pikselSize,u=this.canvas,m=this.isDrawing,h=Math.floor(e.nativeEvent.offsetX/l),f=Math.floor(e.nativeEvent.offsetY/l);if(h<=0&&(h=0),h>s-1&&(h=s-1),f<=0&&(f=0),f>s-1&&(f=s-1),a.Pen.value&&m&&z(e,h,f,r.layers[r.currentLayer],n),a.Mirror.value&&m&&function(e,t,a,r,n){var s=r.length-t-1,i=r.length-a-1;e.ctrlKey?(1===e.nativeEvent.buttons?r[t][a]=O(n.main):r[t][a]=O(n.extra),1===e.nativeEvent.buttons?r[t][i]=O(n.main):r[t][i]=O(n.extra)):e.shiftKey?(1===e.nativeEvent.buttons?r[t][a]=O(n.main):r[t][a]=O(n.extra),1===e.nativeEvent.buttons?r[s][a]=O(n.main):r[s][a]=O(n.extra),1===e.nativeEvent.buttons?r[t][i]=O(n.main):r[t][i]=O(n.extra),1===e.nativeEvent.buttons?r[s][i]=O(n.main):r[s][i]=O(n.extra)):(1===e.nativeEvent.buttons?r[t][a]=O(n.main):r[t][a]=O(n.extra),1===e.nativeEvent.buttons?r[s][a]=O(n.main):r[s][a]=O(n.extra))}(e,h,f,r.layers[r.currentLayer],n),a.Dithering.value&&m&&function(e,t,a,r,n,s){var i=function(e,t,a,r,n,s,i){var o,c,l,u;return r&&(o=e[t][a-1].toString()===e[t][a].toString()),n&&(c=e[t-1][a].toString()===e[t][a].toString()),s&&(l=e[t][a+1].toString()===e[t][a].toString()),i&&(u=e[t+1][a].toString()===e[t][a].toString()),u||c||o||l},o=r[t][a];r[t][a]=O(n.main);var c=null;t>0&&t<s-1&&a>0&&a<s-1&&(c=i(r,t,a,!0,!0,!0,!0)),0===t&&0!==a&&a!==s-1&&(c=i(r,t,a,!0,!1,!0,!0)),0===a&&0!==t&&t!==s-1&&(c=i(r,t,a,!1,!0,!0,!0)),t===s-1&&a!==s-1&&0!==a&&(c=i(r,t,a,!0,!0,!0,!1)),a===s-1&&t!==s-1&&0!==t&&(c=i(r,t,a,!0,!0,!1,!0)),0===t&&0===a&&(c=i(r,t,a,!1,!1,!0,!0)),t===s-1&&a===s-1&&(c=i(r,t,a,!0,!0,!1,!1)),t===s-1&&0===a&&(c=i(r,t,a,!1,!0,!0,!1)),0===t&&a===s-1&&(c=i(r,t,a,!0,!1,!1,!0)),e.shiftKey?r[t][a]=O(c?n.extra:n.main):r[t][a]=c?o:O(n.main)}(e,h,f,r.layers[r.currentLayer],n,s),a.Move.value&&m&&function(e,t,a,r,n){var s=a.y-t,i=a.x-e;if(i>0)for(;0!==i;)r.shift(),r.push(new Array(n).fill([0,0,0,0])),i--;if(i<0)for(;0!==i;)r.unshift(new Array(n).fill([0,0,0,0])),r.pop(),i++;if(s>0)for(;0!==s;)r.forEach(function(e){e.shift(),e.push([0,0,0,0])}),s--;if(s<0)for(;0!==s;)r.forEach(function(e){e.unshift([0,0,0,0]),e.pop()}),s++;a.y=t,a.x=e}(h,f,c,r.layers[r.currentLayer],s),a.Eraser.value&&m&&function(e,t,a){a[e][t]=[0,0,0,0]}(h,f,r.layers[r.currentLayer]),a.Stroke.value&&m){var p=k(r);o.layers[o.currentLayer]=function(e,t,a,r,n,s,i){var o=Math.abs(r-t),c=Math.abs(n-a),l=t<r?1:-1,u=a<n?1:-1,m=o-c;for(1===e.nativeEvent.buttons?s[r][n]=O(i.main):s[r][n]=O(i.extra);t!==r||a!==n;){s[t][a]=1===e.nativeEvent.buttons?s[t][a]=O(i.main):s[t][a]=O(i.extra);var h=2*m;h>-c&&(m-=c,t+=l),h<o&&(m+=o,a+=u)}return s}(e,c.x,c.y,h,f,p.layers[p.currentLayer],n),i?L(u,N(o.layers),r.currentLayer,l):C(u,o.layers[o.currentLayer],l)}if(a.Rectangle.value&&m){var v=k(r);o.layers[o.currentLayer]=function(e,t,a,r,n,s){for(var i=t.x,o=t.y;i!==a;)1===e.nativeEvent.buttons?n[i][t.y]=O(s.main):n[i][t.y]=O(s.extra),i=t.x<a?i+=1:i-=1;for(;o!==r;)1===e.nativeEvent.buttons?n[t.x][o]=O(s.main):n[t.x][o]=O(s.extra),1===e.nativeEvent.buttons?n[i][o]=O(s.main):n[i][o]=O(s.extra),t.y<r?o++:o--;for(;i!==t.x;)1===e.nativeEvent.buttons?n[i][o]=O(s.main):n[i][o]=O(s.extra),t.x<i?i--:i++,1===e.nativeEvent.buttons?n[i][o]=O(s.main):n[i][o]=O(s.extra);return n}(e,c,h,f,v.layers[v.currentLayer],n),i?L(u,N(o.layers),r.currentLayer,l):C(u,o.layers[o.currentLayer],l)}if(a.Circle.value&&m){var y=k(r);o.layers[o.currentLayer]=function(e,t,a,r,n,s,i){for(var o=Math.floor(Math.sqrt(Math.pow(a.x-r,2)+Math.pow(a.y-n,2),2)),c=0,l=o,u=0,m=2-2*o;l>=0;)a.x+c>=0&&a.x+c<=i-1&&a.y-l>=0&&a.y-l<=i-1&&(1===e.nativeEvent.buttons?t[a.x+c][a.y-l]=O(s.main):t[a.x+c][a.y-l]=O(s.extra)),a.x-c>=0&&a.x-c<=i-1&&a.y-l>=0&&a.y-l<=i-1&&(1===e.nativeEvent.buttons?t[a.x-c][a.y-l]=O(s.main):t[a.x-c][a.y-l]=O(s.extra)),a.x-c>=0&&a.x-c<=i-1&&a.y+l>=0&&a.y+l<=i-1&&(1===e.nativeEvent.buttons?t[a.x-c][a.y+l]=O(s.main):t[a.x-c][a.y+l]=O(s.extra)),a.x+c>=0&&a.x+c<=i-1&&a.y+l>=0&&a.y+l<=i-1&&(1===e.nativeEvent.buttons?t[a.x+c][a.y+l]=O(s.main):t[a.x+c][a.y+l]=O(s.extra)),u=2*(m+l)-1,m<0&&u<=0?m+=2*++c+1:m>0&&u>0?m-=2*--l+1:(m+=2*(++c-l),l--);return t}(e,y.layers[y.currentLayer],c,h,f,n,s),i?L(u,N(o.layers),r.currentLayer,l):C(u,o.layers[o.currentLayer],l)}this.setMousePosition({x:h,y:f})}},{key:"mouseUpHandler",value:function(){this.isDrawing=!1;var e=this.props,t=e.tools,a=e.frame,r=e.updateFrames,n=this.frameCopy;n?(r(n),this.frameCopy=null):t.Bucket.value||t.ColorPicker.value||t.Lighten.value||t.Brush.value||t.VerticalReverse.value||t.HorizontalReverse.value||r(a)}},{key:"mouseClickHandler",value:function(e){e.preventDefault();var t=this.props,a=t.tools,r=t.frame,n=t.colors,s=t.canvasSize,i=t.setColor,o=t.updateFrames,c=this.state.showLayers,l=this.startCoords,u=this.pikselSize,m=this.canvas;a.Bucket.value&&function(e,t,a,r,n,s){var i=function(e,t){return e.toString()===t.toString()},o=O(s.main);e.shiftKey&&(o=O(s.extra));var c=t[a][r];if(!i(c,o))for(var l=[a,r];l.length>0;){var u=l.pop(),m=l.pop(),h=null;m>=0&&m<n&&u>=0&&u<n&&(h=t[m][u]),h&&i(h,c)&&(t[m][u]=o,l.push(m+1,u),l.push(m-1,u),l.push(m,u+1),l.push(m,u-1))}}(e,r.layers[r.currentLayer],l.x,l.y,s,n),a.ColorPicker.value&&function(e,t,a,r){var n=t[a.x][a.y];n&&(e.shiftKey?r(j("rgba(".concat(n.join(),")"))):r(j("rgba(".concat(n.join(),")")),!0))}(e,r.layers[r.currentLayer],l,i),a.Lighten.value&&function(e,t,a){var r=["1",".9",".8",".7",".6",".5",".4",".3",".2",".1"],n=Math.floor(e.nativeEvent.offsetX/a),s=Math.floor(e.nativeEvent.offsetY/a),i=t[n][s];if(i){var o=i[3];if(e.shiftKey){var c=r[r.indexOf(o)-1];i[3]=c,t[n][s]=i}else{var l=r[r.indexOf(o)+1];i[3]=l,t[n][s]=i}}}(e,r.layers[r.currentLayer],u),a.Brush.value&&function(e,t,a){e.shiftKey&&t.layers.forEach(function(e){e.forEach(function(t,r){t.forEach(function(t,n){e[r][n]=O(a.main)})})}),t.layers[t.currentLayer].forEach(function(e,r){e.forEach(function(e,n){t.layers[t.currentLayer][r][n]=O(a.main)})})}(e,r,n),a.VerticalReverse.value&&function(e){e.map(function(e){return e.reverse()})}(r.layers[r.currentLayer]),a.HorizontalReverse.value&&function(e){e.reverse()}(r.layers[r.currentLayer]),c?L(m,N(r.layers),r.currentLayer,u):C(m,r.layers[r.currentLayer],u),(a.Bucket.value||a.ColorPicker.value||a.Lighten.value||a.Brush.value||a.VerticalReverse.value||a.HorizontalReverse.value)&&o(r)}},{key:"mouseLeaveHandler",value:function(){var e=this.props,t=e.frame,a=e.updateFrames,r=this.frameCopy,n=this.pikselSize,s=this.canvas;this.isDrawing&&(r?(C(s,r.layers[r.currentLayer],n),t.layers[t.currentLayer]=r.layers[r.currentLayer],a(t),this.frameCopy=null):a(t)),this.isDrawing=!1}},{key:"mouseWheelHandler",value:function(e){var t=this.canvas;e=window.event;var a=Math.max(-1,Math.min(1,e.wheelDelta));t.style.width=Math.max(640,Math.min(900,t.offsetWidth+32*a))+"px",t.style.height=Math.max(640,Math.min(900,t.offsetHeight+32*a))+"px"}},{key:"setCurrentLayer",value:function(e){var t=this.props,a=t.frame,r=t.updateFrames;a.currentLayer=e,r(a)}},{key:"addLayer",value:function(){var e,t=this.props,a=t.frame,r=t.canvasSize,n=t.updateFrames;a.layers.push((e=r,Array.from(Array(e).fill([0,0,0,0]),function(){return new Array(e).fill([0,0,0,0])}))),a.currentLayer++,n(a)}},{key:"deleteLayer",value:function(){var e=this.props,t=e.frame,a=e.updateFrames;t.layers.splice(t.currentLayer,1),0!==t.currentLayer&&(t.currentLayer-=1),a(t)}},{key:"toggleShowLayers",value:function(){this.setState(function(e){return{showLayers:!e.showLayers}})}},{key:"setNextLayer",value:function(){var e=this.props,t=e.frame,a=e.updateFrames;t.currentLayer!==t.layers.length-1&&(t.currentLayer++,a(t))}},{key:"setPreviousLayer",value:function(){var e=this.props,t=e.frame,a=e.updateFrames;0!==t.currentLayer&&(t.currentLayer--,a(t))}},{key:"setLayersToSwap",value:function(e,t){var a=this.layersToSwap;t?a.firstLayer=e:a.secondLayer=e}},{key:"swapLayers",value:function(){var e=this.props,t=e.frame,a=e.updateFrames,r=this.layersToSwap,n=t.layers[r.firstLayer],s=t.layers[r.secondLayer];t.layers.splice(r.firstLayer,1,s),t.layers.splice(r.secondLayer,1,n),a(t)}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"canvas-container"},n.a.createElement(E,{size:this.props.canvasSize,mousePosition:this.state.mousePosition}),n.a.createElement("div",{className:"canvas-wrapper"},n.a.createElement("canvas",{className:"canvas",ref:"canvas",width:this.canvasSize,height:this.canvasSize,onContextMenu:function(e){e.preventDefault()},onMouseDown:function(t){return e.mouseDownHandler(t)},onMouseMove:function(t){return e.mouseMoveHandler(t)},onMouseUp:function(){return e.mouseUpHandler()},onClick:function(t){return e.mouseClickHandler(t)},onMouseLeave:function(){return e.mouseLeaveHandler()},onWheel:function(t){return e.mouseWheelHandler()}})),n.a.createElement(b,{setCurrentLayer:function(t){return e.setCurrentLayer(t)},frame:this.props.frame,addLayer:function(){return e.addLayer()},deleteLayer:function(){return e.deleteLayer()},showLayers:function(){return e.toggleShowLayers()},setNextLayer:function(){return e.setNextLayer()},setPreviousLayer:function(){return e.setPreviousLayer()},isShowing:this.state.showLayers,setLayersToSwap:function(t,a){return e.setLayersToSwap(t,a)},swapLayers:function(){return e.swapLayers()}}))}}]),t}(n.a.Component),A=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={showTooltip:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"showTooltip",value:function(){this.setState({showTooltip:!0})}},{key:"hideTooltip",value:function(){this.setState({showTooltip:!1})}},{key:"render",value:function(){var e=this,t=this.props,a=t.checked,r=t.name,s=t.shortcut,i=t.callBack;return n.a.createElement("div",{className:"button-wrapper"},n.a.createElement("button",{onMouseEnter:function(){return e.showTooltip()},onMouseLeave:function(){return e.hideTooltip()},onClick:i,className:a?r:"".concat(r," checked")}),this.state.showTooltip&&n.a.createElement("div",{ref:"toolTip",className:"tooltip"},n.a.createElement("p",null,"".concat(r," tool"),n.a.createElement("span",null,"(".concat(s,")")))))}}]),t}(n.a.Component),I=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"isChanging",value:function(){var e=this,t=this.props,a=t.tool,r=t.setShortcut,n=this.refs.shortcut;document.querySelectorAll(".shortcut").forEach(function(e){return e.classList.remove("sc-changing")}),n.classList.add("sc-changing"),document.onkeyup=function(t){r(a,t.keyCode),e.isChanged()}}},{key:"isChanged",value:function(){this.refs.shortcut.classList.remove("sc-changing")}},{key:"render",value:function(){var e=this,t=this.props,a=t.tool,r=t.shortcut;return n.a.createElement("div",{className:"sc-info-wrapper",onClick:function(){return e.isChanging()}},n.a.createElement("h3",null,"".concat(a,":")),n.a.createElement("p",{className:"shortcut",ref:"shortcut"},"'".concat(r,"'")))}}]),t}(n.a.Component),M=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).copy=JSON.parse(JSON.stringify(a.props.tools)),a.state={tools:JSON.parse(JSON.stringify(a.props.tools))},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"createBtnsInfo",value:function(){var e=this,t=this.state.tools,a=[];for(var r in t)a.push(n.a.createElement(I,{key:r,tool:r,shortcut:t[r].shortcut,setShortcut:function(t,a){return e.setShortcut(t,a)}}));return a}},{key:"setShortcut",value:function(e,t){var a=Object.assign({},this.state.tools);for(var r in a)a[r].shortcut===String.fromCharCode(t).toUpperCase()&&(a[r].shortcut=a[e].shortcut);a[e].shortcut=String.fromCharCode(t).toUpperCase(),this.setState({tools:a}),document.onkeyup=null}},{key:"setDefaultValue",value:function(){var e=this.copy;this.setState({tools:e}),this.props.togglePopup(),this.forceUpdate()}},{key:"updateShortcuts",value:function(){var e=this.state.tools;this.props.updateShortcuts(e),this.props.togglePopup()}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"sc-popup"},this.createBtnsInfo(),n.a.createElement("button",{className:"save-sc-btn",onClick:function(){return e.updateShortcuts()}},"Save"),n.a.createElement("button",{className:"cancel-sc-btn",onClick:function(){return e.setDefaultValue()}},"Cancel"))}}]),t}(n.a.Component),R=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={showPopup:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",function(t){for(var a in e.props.tools)String.fromCharCode(t.keyCode).toUpperCase()===e.props.tools[a].shortcut&&e.props.setTools(a)})}},{key:"togglePopup",value:function(){var e=this.state.showPopup;this.setState({showPopup:!e})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("button",{className:"shortcuts",onClick:function(){return e.togglePopup()}}),this.state.showPopup&&n.a.createElement(M,{togglePopup:function(){return e.togglePopup()},updateShortcuts:function(t){return e.props.updateShortcuts(t)},tools:this.props.tools}))}}]),t}(n.a.Component),P=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"createButtons",value:function(){var e=this.props,t=e.tools,a=e.setTools,r=[],s=function(e){var s=!0;t[e].value&&(s=!1),r.push(n.a.createElement(A,{checked:s,name:e,key:e,callBack:function(){return a(e)},shortcut:t[e].shortcut}))};for(var i in t)s(i);return r}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"tools"},this.createButtons(),n.a.createElement("div",{className:"colors"},n.a.createElement("input",{className:"mainColor",value:this.props.colors.main,onChange:function(t){return e.props.setColor(t.target.value,!0)},type:"color"}),n.a.createElement("input",{className:"extraColor",value:this.props.colors.extra,onChange:function(t){return e.props.setColor(t.target.value)},type:"color"}),n.a.createElement("div",{className:"swap",onClick:function(){return e.props.swapColors()}})),n.a.createElement(R,{updateShortcuts:function(t){return e.props.updateShortcuts(t)},tools:this.props.tools,setTools:function(t){return e.props.setTools(t)}}))}}]),t}(n.a.Component),D=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).readyToSave=!1,a.imgsToGif=[],a.imgsToPng=[],a.framesToShow=[],a.interval=null,a.canvasSize=384,a.currentFrame=0,a.state={speed:12},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,r=a.frames,n=a.canvasSize,s=this.canvas,i=this.pikselSize,o=this.currentFrame;return(JSON.stringify(r)!==JSON.stringify(e.frames)||t.speed!==this.state.speed)&&(i=Math.floor(this.canvasSize/n),C(s,r[o=0].layers[r[o].currentLayer],i),!0)}},{key:"componentDidMount",value:function(){var e=this.refs.canvas,t=this.props.canvasSize;this.pikselSize=Math.floor(this.canvasSize/t),this.canvas=e,this.ctx=e.getContext("2d"),this.startAnimation()}},{key:"componentDidUpdate",value:function(){var e=this.interval,t=this.props,a=t.frames,r=t.canvasSize;clearInterval(e),this.framesToShow=[],this.readyToSave=!1,this.imgsToGif=[],this.imgsToPng=[],this.pikselSize=Math.floor(this.canvasSize/r),this.currentFrame=0,a[this.currentFrame].layers.length>1?C(this.canvas,a[this.currentFrame].layers,this.pikselSize,!0):C(this.canvas,a[this.currentFrame].layers[0],this.pikselSize),this.startAnimation()}},{key:"startAnimation",value:function(){var e=this.framesToShow,t=this.ctx,a=this.currentFrame,r=this.pikselSize,n=this.canvasSize,s=this.readyToSave,i=this.imgsToGif,o=this.imgsToPng,c=this.canvas,l=this.props,u=l.frames,m=l.setFramesToSave,h=this.state.speed;this.interval=setInterval(function(){e.length===u.length?t.putImageData(e[a],0,0):(C(c,u[a].layers,r,!0),e.push(t.getImageData(0,0,n,n))),i.length===u.length||s?!1===s&&(m(i,o,h),s=!0):(i.push(c.toDataURL("image/png")),o.push(t.getImageData(0,0,n,n).data.buffer)),++a===u.length&&(a=0)},1e3/h)}},{key:"setSpeed",value:function(e){var t=this.state.interval;clearInterval(t);var a=e.target.value;this.setState({speed:a}),this.startAnimation()}},{key:"toggleFullscreen",value:function(){var e=document.querySelector(".preview-wrapper");document.fullscreenElement?document.exitFullscreen():e.requestFullscreen()}},{key:"showFullScreenButton",value:function(){this.refs.fsButton.style.opacity="1"}},{key:"hideFullScreenButton",value:function(){this.refs.fsButton.style.opacity="0"}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"previev-container"},n.a.createElement("div",{onMouseEnter:function(){return e.showFullScreenButton()},onMouseLeave:function(){return e.hideFullScreenButton()},className:"preview-wrapper"},n.a.createElement("canvas",{className:"preview",ref:"canvas",width:this.canvasSize,height:this.canvasSize}),n.a.createElement("button",{className:"preview-fullscreen",ref:"fsButton",onClick:function(t){return e.toggleFullscreen(t)}})),n.a.createElement("p",null,"FPS Rate: ".concat(this.state.speed)),n.a.createElement("input",{onInput:function(t){return e.setSpeed(t)},type:"range",min:"1",max:"24",defaultValue:"12"}))}}]),t}(n.a.Component),H=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).pikselSize=null,a.frameSize=256,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props.frame;return JSON.stringify(t)!==JSON.stringify(e.frame)}},{key:"componentDidMount",value:function(){var e=this.refs.canvas,t=this.props,a=t.canvasSize,r=t.frame,n=this.frameSize;this.canvas=e,this.pikselSize=Math.floor(n/a),C(e,r.layers[r.currentLayer],this.pikselSize)}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.canvasSize,a=e.frame,r=this.canvas,n=this.pikselSize;this.pikselSize=Math.floor(this.frameSize/t),C(r,a.layers[a.currentLayer],n)}},{key:"showButtons",value:function(){var e=this.refs,t=e.cloneFrame,a=e.deleteFrame;t.style.opacity="1",a.style.opacity="1"}},{key:"hideButtons",value:function(){var e=this.refs,t=e.cloneFrame,a=e.deleteFrame;t.style.opacity="0",a.style.opacity="0"}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{onMouseEnter:function(){return e.showButtons()},onMouseLeave:function(){return e.hideButtons()},className:this.props.current?"frame-wrapper frame-wrapper-active":"frame-wrapper"},n.a.createElement("canvas",{className:"frame-canvas",draggable:"true",ref:"canvas",width:this.frameSize,height:this.frameSize,onClick:function(){return e.props.setCurrentFrame(e.props.frame)},onDragEnter:function(){e.canvas.parentNode.classList.add("frame-wrapper-dragEnter"),e.props.setTargetToSwap(e.props.frame,!1)},onDragOver:function(e){return e.preventDefault()},onDragLeave:function(){return e.canvas.parentNode.classList.remove("frame-wrapper-dragEnter")},onDragStart:function(){e.canvas.parentNode.classList.add("frame-wrapper-dragStart"),e.props.setTargetToSwap(e.props.frame,!0)},onDragEnd:function(){e.props.swapFrames(),e.canvas.parentNode.classList.remove("frame-wrapper-dragEnter"),e.canvas.parentNode.classList.remove("frame-wrapper-dragStart")}}),n.a.createElement("p",{className:"frame-number"},this.props.num+1),n.a.createElement("button",{className:"frame-copy",ref:"cloneFrame",onClick:function(){return e.props.cloneFrame(e.props.frame)}}),n.a.createElement("button",{className:"frame-delete",ref:"deleteFrame",onClick:function(){return e.props.deleteFrame(e.props.frame)}}))}}]),t}(n.a.Component),B=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,a=t.frames,r=t.canvasSize,n=t.currentFrame;return JSON.stringify(a)!==JSON.stringify(e.frames)||r!==e.canvasSize||n!==e.currentFrame}},{key:"renderFrames",value:function(){var e=this.props,t=e.frames,a=e.canvasSize,r=e.currentFrame,s=e.deleteFrame,i=e.cloneFrame,o=e.setCurrentFrame,c=e.setTargetToSwap,l=e.swapFrames,u=[];return t.forEach(function(e,t){var m=!1;r===t&&(m=!0),u.push(n.a.createElement(H,{current:m,canvasSize:a,num:t,key:Math.random().toString(36).substring(7),frame:e,deleteFrame:s,cloneFrame:i,setCurrentFrame:o,setTargetToSwap:c,swapFrames:l}))}),u}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"frames-wrapper"},this.renderFrames(),n.a.createElement("button",{className:"add-frame",onClick:function(){return e.props.addFrame()}},n.a.createElement("p",null,"Add new frame")))}}]),t}(n.a.Component),G=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={mail:null},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){try{window.gapi.load("auth2",function(){window.gapi.auth2.init({client_id:"355911681552-osgglvf1ep2a6ivbi8h0uhd8nprv452a.apps.googleusercontent.com"})})}catch(e){console.log(e.message)}}},{key:"signIn",value:function(){var e=this;window.gapi.auth2.getAuthInstance().signIn({scope:"https://www.googleapis.com/auth/drive"}).then(function(t){return e.setState({mail:t.w3.U3})})}},{key:"singOut",value:function(){var e=this;window.gapi.auth2.getAuthInstance().signOut().then(function(t){return e.setState({mail:null})})}},{key:"render",value:function(){var e=this,t=this.state.mail;return n.a.createElement("div",{className:"header"},n.a.createElement("div",{className:"logo"}),n.a.createElement("div",{className:"user-info-wrapper"},n.a.createElement("p",{className:"user-info"},this.state.mail),!t&&n.a.createElement("button",{onClick:function(){return e.signIn()}},"Log In"),t&&n.a.createElement("button",{onClick:function(){return e.singOut()}},"Log Out")))}}]),t}(n.a.PureComponent),J=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={showSaveInfo:!1,showResizeInfo:!1,project:"Import .rss file..."},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"showResizeInfo",value:function(){var e=this.state,t=e.showSaveInfo,a=e.showResizeInfo,r=this.refs,n=r.settings,s=r.resizeInfo,i=r.saveInfo;t||a||(this.setState({showResizeInfo:!0}),n.classList.add("show-settings"),s.style.borderRight="none"),a&&n.classList.toggle("show-settings"),t&&(this.setState({showResizeInfo:!0,showSaveInfo:!1}),i.style.borderRight="3px solid black",s.style.borderRight="none",n.classList.add("show-settings"))}},{key:"showSaveInfo",value:function(){var e=this.state,t=e.showSaveInfo,a=e.showResizeInfo,r=this.refs,n=r.settings,s=r.resizeInfo,i=r.saveInfo;t||a||(this.setState({showSaveInfo:!0}),n.classList.add("show-settings"),i.style.borderRight="none"),t&&n.classList.toggle("show-settings"),a&&(this.setState({showResizeInfo:!1,showSaveInfo:!0}),s.style.borderRight="3px solid black",i.style.borderRight="none",n.classList.add("show-settings"))}},{key:"importRssFileHandler",value:function(){this.setState({project:document.querySelector("input[type=file]").files[0].name})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{ref:"settings",className:"settings"},n.a.createElement("div",{className:"settings-btn-wrapper"},n.a.createElement("button",{className:"saveInfo-btn",ref:"saveInfo",onClick:function(){return e.showSaveInfo()}}),n.a.createElement("button",{className:"resizeInfo-btn",ref:"resizeInfo",onClick:function(){return e.showResizeInfo()}})),n.a.createElement("div",{className:"settings-info-container"},this.state.showResizeInfo&&n.a.createElement("div",{className:"canvas-resize-wrapper"},n.a.createElement("h3",null,"Current size: ".concat(this.props.canvasSize," x ").concat(this.props.canvasSize)),n.a.createElement("div",{className:"button",onClick:function(){return e.props.resize(32)}},n.a.createElement("p",{className:"btnText"},"32x32"),n.a.createElement("div",{className:"btnTwo"},n.a.createElement("p",{className:"btnText2"},"Resize"))),n.a.createElement("div",{className:"button",onClick:function(){return e.props.resize(64)}},n.a.createElement("p",{className:"btnText"},"64x64"),n.a.createElement("div",{className:"btnTwo"},n.a.createElement("p",{className:"btnText2"},"Resize"))),n.a.createElement("div",{className:"button",onClick:function(){return e.props.resize(128)}},n.a.createElement("p",{className:"btnText"},"128x128"),n.a.createElement("div",{className:"btnTwo"},n.a.createElement("p",{className:"btnText2"},"Resize")))),this.state.showSaveInfo&&n.a.createElement("div",null,n.a.createElement("div",{className:"canvas-saveInfo-wrapper"},n.a.createElement("div",{className:"save-format-btn-wrapper"},n.a.createElement("input",{type:"file",id:"file",className:"inputFile",onChange:function(){e.importRssFileHandler(),e.props.importRssFile()}}),n.a.createElement("label",{htmlFor:"file"},n.a.createElement("div",{className:"import-file"}),this.state.project),n.a.createElement("h3",null,"Save as:"),n.a.createElement("div",{className:"button",onClick:this.props.saveAsGif},n.a.createElement("p",{className:"btnText"},".gif"),n.a.createElement("div",{className:"btnTwo"},n.a.createElement("p",{className:"btnText2"},"Save"))),n.a.createElement("div",{className:"button",onClick:this.props.saveAsApng},n.a.createElement("p",{className:"btnText"},".apng"),n.a.createElement("div",{className:"btnTwo"},n.a.createElement("p",{className:"btnText2"},"Save"))),n.a.createElement("div",{className:"button",onClick:this.props.saveAsPiskel},n.a.createElement("p",{className:"btnText"},".piskel"),n.a.createElement("div",{className:"btnTwo"},n.a.createElement("p",{className:"btnText2"},"Save"))),n.a.createElement("div",{className:"button",onClick:this.props.saveAsRss},n.a.createElement("p",{className:"btnText"},".rss"),n.a.createElement("div",{className:"btnTwo"},n.a.createElement("p",{className:"btnText2"},"Save")))),n.a.createElement("div",{className:"save-location-btn-wrapper"},n.a.createElement("h3",null,"Save to:"),n.a.createElement("div",{className:"button",onClick:this.props.saveToLocalStorage},n.a.createElement("p",{className:"btnText"},"Storage"),n.a.createElement("div",{className:"btnTwo"},n.a.createElement("p",{className:"btnText2"},"Save"))),n.a.createElement("div",{className:"button",onClick:this.props.saveToGoogleDrive},n.a.createElement("p",{className:"btnText"},"Google"),n.a.createElement("div",{className:"btnTwo"},n.a.createElement("p",{className:"btnText2"},"Upload"))))))))}}]),t}(n.a.Component),U=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).targetsToSwap={firstTarget:null,secondTarget:null},a.state={projectIsStarted:!1,canvasSize:32,frames:[w(32)],stateHistory:[],currentFrame:0,framesToSaveAsGif:[],framesToSaveAsApng:[],animationSpeed:null,colors:{main:"#000000",extra:"#8080ff"},tools:{Pen:{value:!1,shortcut:"Q"},Mirror:{value:!1,shortcut:"W"},Bucket:{value:!1,shortcut:"E"},Eraser:{value:!1,shortcut:"R"},Brush:{value:!1,shortcut:"T"},Stroke:{value:!1,shortcut:"Y"},Rectangle:{value:!1,shortcut:"A"},Circle:{value:!1,shortcut:"S"},Move:{value:!1,shortcut:"D"},ColorPicker:{value:!1,shortcut:"F"},Lighten:{value:!1,shortcut:"G"},Dithering:{value:!1,shortcut:"H"},VerticalReverse:{value:!1,shortcut:"C"},HorizontalReverse:{value:!1,shortcut:"X"}}},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keypress",function(t){26===t.keyCode&&t.ctrlKey&&e.state.stateHistory.length&&e.stepBack()}),localStorage.getItem("state")&&this.setState(Object(o.a)({},JSON.parse(localStorage.getItem("state"))))}},{key:"startProject",value:function(){this.setState({projectIsStarted:!0})}},{key:"setFramesToSave",value:function(e,t,a){this.setState({framesToSaveAsGif:e,framesToSaveAsApng:t,animationSpeed:a})}},{key:"saveAsGif",value:function(){g.a.createGIF({images:this.state.framesToSaveAsGif,interval:1/this.state.animationSpeed,gifWidth:384,gifHeight:384},function(e){e.error||p()(e.image,"newGif.gif","gif")})}},{key:"saveToLocalStorage",value:function(){localStorage.clear(),localStorage.setItem("state",JSON.stringify(this.state))}},{key:"saveAsApng",value:function(){var e=y.a.encode(this.state.framesToSaveAsApng,384,384,0,new Array(this.state.framesToSaveAsApng.length).fill(1e3/this.state.animationSpeed));p()(e,"newAPNG.apng","apng")}},{key:"saveAsPiskel",value:function(){var e,t,a,r;p()((e=1/this.state.animationSpeed,t=384,a=this.state.framesToSaveAsGif.length,r=this.state.framesToSaveAsGif,'{"modelVersion":2,"piskel":{"name":"piskel","description":"","fps":'.concat(e,',"height":').concat(t,',"width":').concat(t,',"layers":["{"name":"Layer 1","opacity":1,"frameCount":').concat(a,',"chunks":[{"layout":[[0]],"base64PNG":"data: ').concat(r,'}]"hiddenFrames":[]}"]}}')),"newPiskel.piskel","piskel")}},{key:"saveAsRss",value:function(){p()(JSON.stringify(T(this.state,this.state.frames)),"project.rss","rss")}},{key:"saveToGoogleDrive",value:function(){!function(e){var t=new Blob([e],{type:"image/apng"}),a=window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token,r=new FormData;r.append("metadata",new Blob([JSON.stringify({name:"newPiskel.apng",mimeType:"apng"})],{type:"application/json"})),r.append("file",t),fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id",{name:"piskel.jpg",method:"POST",headers:new Headers({Authorization:"Bearer "+a}),body:r})}(y.a.encode(this.state.framesToSaveAsApng,384,384,0,new Array(this.state.framesToSaveAsApng.length).fill(1e3/this.state.animationSpeed)))}},{key:"importRssFile",value:function(){var e=this;!function(e){var t=window.URL.createObjectURL(document.querySelector("input[type=file]").files[0]),a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET",t,!0),a.onreadystatechange=function(){4===a.readyState&&e(a.responseText)},a.send(null)}(function(t){return e.setState(Object(o.a)({},JSON.parse(t),{stateHistory:[]}))})}},{key:"stepBack",value:function(){var e=this.state.stateHistory.pop(),t=e.speed,a=e.canvasSize,r=e.frames,n=e.currentFrame,s=e.colors,i=e.tools;this.setState({speed:t,canvasSize:a,frames:r,currentFrame:n,colors:s,tools:i})}},{key:"saveCurrentState",value:function(){var e=T(this.state,this.state.frames),t=N(this.state.stateHistory);return t.length>5&&t.shift(),t.push(e),t}},{key:"resize",value:function(e){var t=N(this.state.frames),a=this.saveCurrentState();t=x(t,this.state.canvasSize,e),this.setState({frames:t,canvasSize:e,stateHistory:a})}},{key:"updateFrames",value:function(e){var t=this.state.currentFrame;if(JSON.stringify(this.state.frames[t])===JSON.stringify(e))return!1;var a=N(this.state.frames),r=this.saveCurrentState();a[t]=e,this.setState({frames:a,stateHistory:r})}},{key:"setCurrentFrame",value:function(e){var t=this.saveCurrentState(),a=this.state.frames.indexOf(e);this.setState({currentFrame:a,stateHistory:t})}},{key:"addFrame",value:function(){var e=this.state,t=e.canvasSize,a=e.currentFrame,r=N(this.state.frames),n=this.saveCurrentState();r.push(w(t)),a+=1,this.setState({frames:r,currentFrame:a,stateHistory:n})}},{key:"deleteFrame",value:function(e){var t=this.state,a=t.canvasSize,r=t.currentFrame,n=N(this.state.frames),s=this.saveCurrentState();if(1===n.length)this.setState({frames:[w(a)],stateHistory:s});else{var i=this.state.frames.indexOf(e);0!==r&&(r-=1),n.splice(i,1),this.setState({frames:n,currentFrame:r})}}},{key:"cloneFrame",value:function(e){var t=N(this.state.frames),a=this.saveCurrentState(),r=this.state.currentFrame;r+=1,t.splice(this.state.frames.indexOf(e),0,k(e)),this.setState({frames:t,currentFrame:r,stateHistory:a})}},{key:"setColor",value:function(e,t){var a=this.state.colors,r=this.saveCurrentState();t?this.setState({stateHistory:r,colors:{main:e,extra:a.extra}}):this.setState({stateHistory:r,colors:{main:a.main,extra:e}})}},{key:"swapColors",value:function(){var e=this.state.colors,t=this.saveCurrentState();this.setState({colors:{main:e.extra,extra:e.main},stateHistory:t})}},{key:"setTools",value:function(e){var t=Object.assign({},this.state.tools);for(var a in t[e].value=!t[e].value,t)a!==e&&(t[a].value=!1);this.setState({tools:t})}},{key:"updateShortcuts",value:function(e){this.setState({tools:e})}},{key:"setTargetToSwap",value:function(e,t){var a=this.targetsToSwap;t?a.firstTarget=e:a.secondTarget=e}},{key:"swapFrames",value:function(){var e=this.targetsToSwap;if(e.secondTarget&&e.firstTarget!==e.secondTarget){var t=this.saveCurrentState(),a=N(this.state.frames);a.splice(this.state.frames.indexOf(e.firstTarget),1,e.secondTarget),a.splice(this.state.frames.indexOf(e.secondTarget),1,e.firstTarget),this.setState({frames:a,stateHistory:t})}}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(G,null),!this.state.projectIsStarted&&n.a.createElement(S,{startProject:function(){return e.startProject()}}),this.state.projectIsStarted&&n.a.createElement("div",{className:"container"},n.a.createElement(P,{tools:this.state.tools,setTools:function(t){return e.setTools(t)},setColor:function(t,a){return e.setColor(t,a)},swapColors:function(){return e.swapColors()},colors:this.state.colors,updateShortcuts:function(t){return e.updateShortcuts(t)}}),n.a.createElement(B,{currentFrame:this.state.currentFrame,canvasSize:this.state.canvasSize,frames:this.state.frames,addFrame:function(){return e.addFrame()},deleteFrame:function(t){return e.deleteFrame(t)},cloneFrame:function(t){return e.cloneFrame(t)},setCurrentFrame:function(t){return e.setCurrentFrame(t)},setTargetToSwap:function(t,a){return e.setTargetToSwap(t,a)},swapFrames:function(){return e.swapFrames()}}),n.a.createElement(F,{frames:N(this.state.frames),setMousePosition:function(t){return e.setMousePosition(t)},canvasSize:this.state.canvasSize,tools:this.state.tools,colors:this.state.colors,updateFrames:function(t){return e.updateFrames(t)},frame:k(this.state.frames[this.state.currentFrame]),setColor:function(t,a){return e.setColor(t,a)}}),n.a.createElement(D,{frames:this.state.frames,canvasSize:this.state.canvasSize,setFramesToSave:function(t,a,r){return e.setFramesToSave(t,a,r)}}),n.a.createElement(J,{saveAsApng:function(){return e.saveAsApng()},saveAsGif:function(){return e.saveAsGif()},saveToGoogleDrive:function(){return e.saveToGoogleDrive()},saveToLocalStorage:function(){return e.saveToLocalStorage()},saveAsPiskel:function(){return e.saveAsPiskel()},resize:function(t){return e.resize(t)},canvasSize:this.state.canvasSize,saveAsRss:function(){return e.saveAsRss()},importRssFile:function(){return e.importRssFile()}})))}}]),t}(n.a.Component);i.a.render(n.a.createElement(U,null),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.75499512.chunk.js.map