{"version":3,"sources":["Components/StartPage/StartPage.js","Components/Canvas/CanvasInfo.js","Components/Canvas/Layers.js","Components/Piskel/utils.js","Components/Canvas/Tools.js","Components/Canvas/Canvas.js","Components/Tools/Tool.js","Components/Tools/Shortcuts/ShortcutInfo.js","Components/Tools/Shortcuts/ShortcutsPopup.js","Components/Tools/Shortcuts/Shortcuts.js","Components/Tools/Tools.js","Components/Preview/Preview.js","Components/Frames/Frame.js","Components/Frames/Frames.js","Components/Header/Header.js","Components/Settings/Settings.js","Components/Piskel/Piskel.js","index.js"],"names":["StartPage","react_default","a","createElement","className","onClick","this","props","startProject","href","React","Component","CanvasInfo","x","mousePosition","y","size","concat","PureComponent","Layers","_this","layers","frame","forEach","layer","i","push","currentLayer","key","Math","random","toString","substring","draggable","setCurrentLayer","onDragEnter","e","target","style","border","setLayersToSwap","onDragOver","preventDefault","onDragLeave","onDragStart","opacity","onDragEnd","swapLayers","isShowing","showLayers","addLayer","length","disabled","deleteLayer","setNextLayer","setPreviousLayer","renderLayers","createFrame","Array","from","fill","canvas","pikselSize","context","getContext","clearRect","width","height","index","item","j","fillStyle","join","fillRect","splice","createFrameCopy","copy","JSON","parse","stringify","createFramesCopy","frames","map","renderCanvas","resize","currentSize","unshift","letngth","addCells","pop","shift","removeCells","createStateCopy","state","framesCopy","stateCopy","Object","assign","framesToSaveAsApng","framesToSaveAsGif","stateHistory","convertHexToRgba","hex","c","test","split","convertRgbToHex","rgb","match","parseInt","slice","pen","colors","nativeEvent","buttons","main","extra","Canvas","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","layersToSwap","firstLayer","secondLayer","isDrawing","canvasSize","startCoords","frameCopy","value","setState","refs","floor","ctx","offsetX","offsetY","tools","Stroke","Rectangle","Circle","Pen","Mirror","x1","y1","ctrlKey","shiftKey","mirror","Dithering","checkAround","top","left","bot","right","t","l","b","r","currentColor","checked","dithering","Move","move","Eraser","eraser","clone","x2","y2","deltaX","abs","deltaY","signX","signY","error","error2","stroke","rectangle","radius","sqrt","pow","x0","y0","gap","delta","drawCircle","setMousePosition","updateFrames","Bucket","ColorPicker","Lighten","Brush","VerticalReverse","HorizontalReverse","colorsMatch","fillColor","targetColor","pixelsToCheck","curColor","bucket","callback","pixel","colorPicker","setColor","opacityValues","color","currentOpacity","newOpacity","indexOf","lighten","brush","reverse","horizontalReverse","window","event","max","min","wheelDelta","offsetWidth","offsetHeight","num","first","_this2","CanvasInfo_CanvasInfo","ref","onContextMenu","onMouseDown","mouseDownHandler","onMouseMove","mouseMoveHandler","onMouseUp","mouseUpHandler","mouseClickHandler","onMouseLeave","mouseLeaveHandler","onWheel","mouseWheelHandler","Layers_Layers","toggleShowLayers","Tool","showTooltip","onMouseEnter","hideTooltip","callBack","name","shortcut","ShortcutInfo","document","querySelectorAll","classList","remove","add","onkeyup","setShortcut","tool","keyCode","isChanged","isChanging","ShortcutsPopup","info","ShortcutInfo_ShortcutInfo","String","fromCharCode","toUpperCase","togglePopup","forceUpdate","updateShortcuts","_this3","createBtnsInfo","setDefaultValue","Shortcuts","showPopup","addEventListener","setTools","ShortcutsPopup_ShortcutsPopup","Tools","_loop","Tool_Tool","createButtons","onChange","type","swapColors","Shortcuts_Shortcuts","Preview","readyToSave","imgsToGif","imgsToPng","framesToShow","interval","currentFrame","speed","nextProps","nextState","startAnimation","clearInterval","setInterval","putImageData","getImageData","setFramesToSave","toDataURL","data","buffer","elem","querySelector","fullscreenElement","exitFullscreen","requestFullscreen","fsButton","showFullScreenButton","hideFullScreenButton","toggleFullscreen","onInput","setSpeed","defaultValue","Frame","frameSize","delete","showButtons","hideButtons","current","setCurrentFrame","parentNode","setTargetToSwap","swapFrames","cloneFrame","deleteFrame","Frames","Frame_Frame","renderFrames","addFrame","Header","mail","gapi","load","auth2","init","client_id","console","log","message","getAuthInstance","signIn","scope","then","user","w3","U3","signOut","_this4","singOut","Settings","showSaveInfo","showResizeInfo","project","settings","resizeInfo","borderRight","toggle","saveInfo","files","id","importRssFileHandler","importRssFile","htmlFor","saveAsGif","saveAsApng","saveAsPiskel","saveAsRss","saveToLocalStorage","saveToGoogleDrive","Piskel","targetsToSwap","firstTarget","secondTarget","projectIsStarted","animationSpeed","stepBack","localStorage","getItem","objectSpread","clear","setItem","imageData","UPNG","encode","download","framesCount","images","fileContent","file","Blob","accessToken","currentUser","get","getAuthResponse","access_token","form","FormData","append","mimeType","fetch","method","headers","Headers","Authorization","body","cb","URL","createObjectURL","rawFile","XMLHttpRequest","overrideMimeType","open","onreadystatechange","readyState","responseText","send","uploadProject","step","saveCurrentState","isMain","gifshot","createGIF","gifWidth","gifHeight","obj","image","Header_Header","StartPage_StartPage","Tools_Tools","Frames_Frames","Canvas_Canvas","Preview_Preview","gif","png","Settings_Settings","ReactDOM","render","Components_Piskel_Piskel","getElementById"],"mappings":"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","file":"static/js/main.d41414a3.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nexport default class StartPage extends React.Component {\r\n    render() {\r\n        return (\r\n            <div className={'start-page'}>\r\n                <section className={'main-title'}>\r\n                    <div className={'main-title-left'}>\r\n                        <h2 className={'title-text-main'}>Piskel-clone is a final project of the second stage course of The Rolling Scopes School</h2>\r\n                        <p className={'title-text'}>Create animations in your browser</p>\r\n                        <button onClick={this.props.startProject}>Create Sprite</button>\r\n                    </div>\r\n                    <div className={'main-title-right'}>\r\n                        <div className={'piskel-screen'} />\r\n                    </div>\r\n                </section>\r\n                <section className={'sprites-section'}>\r\n                    <h2>Sprites example</h2>\r\n                    <div className={'sprites-gallery'}>\r\n                        <div className={'sprite sprt1'} />\r\n                        <div className={'sprite sprt2'} />\r\n                        <div className={'sprite sprt3'} />\r\n                        <div className={'sprite sprt4'} />\r\n                        <div className={'sprite sprt5'} />\r\n                        <div className={'sprite sprt6'} />\r\n                        <div className={'sprite sprt7'} />\r\n                        <div className={'sprite sprt8'} />\r\n                    </div>\r\n                </section>\r\n                <section className={'functionality'}>\r\n                    <h2>Functionality</h2>\r\n                    <div className={'functionality-gallery'}>\r\n                        <div>\r\n                            <p>Choose color</p>\r\n                            <div className={'functionality-wrapper fnc1'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Frame managment</p>\r\n                            <div className={'functionality-wrapper fnc2'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Layer managment</p>\r\n                            <div className={'functionality-wrapper fnc3'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Live preview</p>\r\n                            <div className={'functionality-wrapper fnc4'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Export to .gif/.apng</p>\r\n                            <div className={'functionality-wrapper fnc5'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Hotkeys</p>\r\n                            <div className={'functionality-wrapper fnc6'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Google SingIn</p>\r\n                            <div className={'functionality-wrapper fnc7'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Tools</p>\r\n                            <div className={'functionality-wrapper fnc8'} />\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n                <section className={'about-container'}>\r\n                    <div className={'author-img'} />\r\n                    <div className={'about-author'}>\r\n                        <h2 className={'author-name'}>akSr-</h2>\r\n                        <p>I like the programming, it's exciting and fascinating. Coding is one of the easiest ways to solve practical problems.\r\n                            The end product depends only upon how hight your skills and good idea but not any other factors.</p>\r\n                    </div>\r\n                    <div className={'author-contacts'}>\r\n                        <p>GitHub: <a href='https://github.com/aksr666'>https://github.com/aksr666</a></p>\r\n                    </div>\r\n                </section>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\n\r\nexport default class CanvasInfo extends React.PureComponent {\r\n    render() {\r\n        let x = this.props.mousePosition.x;\r\n        let y = this.props.mousePosition.y\r\n        if (x >= this.props.size - 1) x = this.props.size;\r\n        if (x <= 0) x = 1;\r\n        if (y >= this.props.size - 1) y = this.props.size;\r\n        if (y <= 0) y = 1;\r\n        return (\r\n            <div className={'canvas-info'}>\r\n                <div className={'cursor-position'} >\r\n                    <h2>Mouse position:</h2>\r\n                    <p className={'cursor-position-x'}>{`X: ${x}`}</p>\r\n                    <p className={'cursor-position-y'}>{`Y: ${y}`}</p>\r\n                </div>\r\n                <div className={'canvas-size'}>\r\n                    <h3>{`Cavas size: ${this.props.size} x ${this.props.size}`}</h3>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\n\r\nexport default class Layers extends React.PureComponent {\r\n\r\n    renderLayers() {\r\n        const layers = [];\r\n        this.props.frame.layers.forEach((layer, i) => {\r\n            layers.push(<p\r\n                className={this.props.frame.currentLayer === i ? `layer layer-current` : `layer`}\r\n                key={Math.random().toString(36).substring(7)}\r\n                draggable={'true'}\r\n                onClick={() => this.props.setCurrentLayer(i)}\r\n                onDragEnter={(e) => {\r\n                    e.target.style.border = '1px dashed red';\r\n                    this.props.setLayersToSwap(i, false);\r\n                }}\r\n                onDragOver={(e) => e.preventDefault()}\r\n                onDragLeave={(e) => e.target.style.border = '1px solid white'}\r\n                onDragStart={(e) => {\r\n                    e.target.style.opacity = .5;\r\n                    this.props.setLayersToSwap(i, true);\r\n                }}\r\n                onDragEnd={(e) => {\r\n                    e.target.style.opacity = 1;\r\n                    e.target.style.border = '1px solid white';\r\n                    this.props.swapLayers();\r\n                }}\r\n            >{`Layer-${i + 1}`}\r\n            </p>)\r\n        });\r\n        return layers;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'layers-info'}>\r\n                <div className={'layers-header'}>\r\n                    <h3>Layers</h3>\r\n                    <button className={this.props.isShowing ? `show-layers checked` : `show-layers`} onClick={this.props.showLayers}></button>\r\n                </div>\r\n                <div className={'layers-buttons'}>\r\n                    <button className={'layers-btn'} onClick={this.props.addLayer}>+</button>\r\n                    <button className={this.props.frame.layers.length > 1 ? 'layers-btn' : 'layers-btn disabled'} disabled={this.props.frame.layers.length > 1 ? false : true} onClick={this.props.deleteLayer}>-</button>\r\n                    <button className={this.props.frame.layers.length !== 1 ? 'layers-btn' : 'layers-btn disabled'} disabled={!this.props.frame.layers.length} onClick={this.props.setNextLayer}><p className={'layers-next'}>►</p></button>\r\n                    <button className={this.props.frame.layers.length !== 1 ? 'layers-btn' : 'layers-btn disabled'} disabled={!this.props.frame.layers.length} onClick={this.props.setPreviousLayer}><p className={'layers-prev'}>►</p></button>\r\n                </div>\r\n                {this.renderLayers()}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","const createFrame = (size) => {\r\n    const frame = {};\r\n    frame.layers = [Array.from(Array(size).fill([0, 0, 0, 0]), () => new Array(size).fill([0, 0, 0, 0]))];\r\n    frame.currentLayer = 0;\r\n    return frame;\r\n};\r\n\r\nconst createLayer = (size) => Array.from(Array(size).fill([0, 0, 0, 0]), () => new Array(size).fill([0, 0, 0, 0]));\r\n\r\nconst renderLayers = (canvas, layers, currentLayer, pikselSize) => {\r\n    const context = canvas.getContext(\"2d\");\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    layers.forEach((layer, index) => {\r\n        if (index === currentLayer) {\r\n            layer.forEach((item, i) => {\r\n                item.forEach((item, j) => {\r\n                    if (item.toString() === [0, 0, 0, 0].toString()) return;\r\n                    context.fillStyle = item;\r\n                    context.fillStyle = `rgba(${item.join()})`;\r\n                    context.fillRect(pikselSize * i, pikselSize * j, pikselSize, pikselSize);\r\n                });\r\n            });\r\n        } else {\r\n            layer.forEach((item, i) => {\r\n                item.forEach((item, j) => {\r\n                    if (item.toString() === [0, 0, 0, 0].toString()) return;\r\n                    item.splice(item.length - 1, 1, '.5');\r\n                    const fill = `rgba(${item.join()})`;\r\n                    context.fillStyle = item;\r\n                    context.fillStyle = fill;\r\n                    context.fillRect(pikselSize * i, pikselSize * j, pikselSize, pikselSize);\r\n                });\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nconst createFrameCopy = (copy) => JSON.parse(JSON.stringify(copy));\r\n\r\nconst createFramesCopy = (frames) => JSON.parse(JSON.stringify(frames)).map((frame) => JSON.parse(JSON.stringify(frame)));\r\n\r\nconst renderCanvas = (canvas, frame, pikselSize, layers) => {\r\n    const context = canvas.getContext(\"2d\");\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    if (layers) {\r\n        frame.forEach((layer) => {\r\n            layer.forEach((item, i) => {\r\n                item.forEach((item, j) => {\r\n                    if (item.toString() === [0, 0, 0, 0].toString()) return;\r\n                    context.fillStyle = item;\r\n                    context.fillStyle = `rgba(${item.join()})`;\r\n                    context.fillRect(pikselSize * i, pikselSize * j, pikselSize, pikselSize);\r\n                });\r\n            });\r\n        });\r\n    }\r\n    else {\r\n        frame.forEach((item, i) => {\r\n            item.forEach((item, j) => {\r\n                if (item.toString() === [0, 0, 0, 0].toString()) return;\r\n                context.fillStyle = item;\r\n                context.fillStyle = `rgba(${item.join()})`;\r\n                context.fillRect(pikselSize * i, pikselSize * j, pikselSize, pikselSize);\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nconst resize = (frames, currentSize, size) => {\r\n    const addCells = (frame) => {\r\n        let length = frame.length;\r\n        while (length !== size) {\r\n            frame.push(new Array(size).fill([0, 0, 0, 0]));\r\n            frame.unshift(new Array(size).fill([0, 0, 0, 0]));\r\n            length = frame.length;\r\n        }\r\n        frame.forEach((item) => {\r\n            let letngth = item.length;\r\n            while (letngth !== size) {\r\n                item.push([0, 0, 0, 0]);\r\n                item.unshift([0, 0, 0, 0]);\r\n                letngth = item.length;\r\n            }\r\n        });\r\n        return frame;\r\n    }\r\n\r\n    const removeCells = (frame) => {\r\n        let length = frame.length;\r\n        while (length !== size) {\r\n            frame.pop();\r\n            frame.shift();\r\n            length = frame.length;\r\n        }\r\n        frame.forEach((item) => {\r\n            let length = item.length;\r\n            while (length !== size) {\r\n                item.pop();\r\n                item.shift();\r\n                length = item.length;\r\n            }\r\n        });\r\n        return frame;\r\n    }\r\n    if (currentSize < size) frames.forEach((item) => item.layers.forEach((layer) => addCells(layer)));\r\n    else frames.forEach((item) => item.layers.forEach((layer) => removeCells(layer)));\r\n    return frames;\r\n}\r\n\r\nconst createStateCopy = (state, frames) => {\r\n    const framesCopy = createFramesCopy(frames);\r\n    const stateCopy = Object.assign({}, state, { framesToSaveAsApng: null }, { framesToSaveAsGif: null }, { stateHistory: null });\r\n    stateCopy.frames = framesCopy;\r\n    return stateCopy;\r\n}\r\n\r\nconst saveToGoogleDrive = (fileContent) => {\r\n    const file = new Blob([fileContent], { type: 'image/apng' });\r\n    const metadata = {\r\n        'name': 'newPiskel.apng',\r\n        'mimeType': 'apng',\r\n    };\r\n    const accessToken = window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token;\r\n    const form = new FormData();\r\n    form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));\r\n    form.append('file', file);\r\n    fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id', {\r\n        name: 'piskel.jpg',\r\n        method: 'POST',\r\n        headers: new Headers({ 'Authorization': 'Bearer ' + accessToken }),\r\n        body: form,\r\n    });\r\n}\r\n\r\nconst saveAsPiskel = (animationSpeed, size, framesCount, images) => {\r\n    return `{\"modelVersion\":2,\"piskel\":{\"name\":\"piskel\",\"description\":\"\",\"fps\":${animationSpeed},\"height\":${size},\"width\":${size},\"layers\":[\"{\"name\":\"Layer 1\",\"opacity\":1,\"frameCount\":${framesCount},\"chunks\":[{\"layout\":[[0]],\"base64PNG\":\"data: ${images}}]\"hiddenFrames\":[]}\"]}}`;\r\n}\r\n\r\nconst uploadProject = (cb) => {\r\n    const file = window.URL.createObjectURL(document.querySelector('input[type=file]').files[0]);\r\n    const rawFile = new XMLHttpRequest();\r\n    rawFile.overrideMimeType(\"application/json\");\r\n    rawFile.open(\"GET\", file, true);\r\n    rawFile.onreadystatechange = function () {\r\n        if (rawFile.readyState === 4) cb(rawFile.responseText);      \r\n    }\r\n    rawFile.send(null);\r\n};\r\n\r\nexport {\r\n    createFrame,\r\n    createFrameCopy,\r\n    renderCanvas,\r\n    resize,\r\n    createFramesCopy,\r\n    createStateCopy,\r\n    renderLayers,\r\n    createLayer,\r\n    saveToGoogleDrive,\r\n    saveAsPiskel,\r\n    uploadProject\r\n}\r\n","const convertHexToRgba = (hex) => {\r\n  let c;\r\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n    c = hex.substring(1).split('');\r\n    if (c.length === 3) {\r\n      c = [c[0], c[0], c[1], c[1], c[2], c[2]];\r\n    }\r\n    c = '0x' + c.join('');\r\n    return [(c >> 16) & 255, (c >> 8) & 255, c & 255, 1];\r\n  }\r\n}\r\n\r\nconst convertRgbToHex = (rgb) => {\r\n  rgb = rgb.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\r\n  return (rgb && rgb.length === 4) ? \"#\" +\r\n    (\"0\" + parseInt(rgb[1], 10).toString(16)).slice(-2) +\r\n    (\"0\" + parseInt(rgb[2], 10).toString(16)).slice(-2) +\r\n    (\"0\" + parseInt(rgb[3], 10).toString(16)).slice(-2) : '';\r\n}\r\n\r\nconst pen = (e, x, y, frame, colors) => {\r\n  e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n}\r\n// function pen(event) {\r\n//   if (currentTool() !== 'pen' || !isDrawing) return;\r\n//   ctx.fillStyle = currentColor();\r\n//   let size = boxSize();\r\n//   const x = Math.floor(event.offsetX / scale() / size) * size;\r\n//   const y = Math.floor(event.offsetY / scale() / size) * size;\r\n//   ctx.fillRect(x, y, size, size);\r\n// }\r\nconst eraser = (x, y, frame) => {\r\n  frame[x][y] = [0, 0, 0, 0];\r\n}\r\n\r\nconst mirror = (e, x, y, frame, colors) => {\r\n  const x1 = frame.length - x - 1;\r\n  const y1 = frame.length - y - 1;\r\n  if (e.ctrlKey) {\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x][y1] = convertHexToRgba(colors.main) : frame[x][y1] = convertHexToRgba(colors.extra);\r\n  } else if (e.shiftKey) {\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x1][y] = convertHexToRgba(colors.main) : frame[x1][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x][y1] = convertHexToRgba(colors.main) : frame[x][y1] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x1][y1] = convertHexToRgba(colors.main) : frame[x1][y1] = convertHexToRgba(colors.extra);\r\n  } else {\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x1][y] = convertHexToRgba(colors.main) : frame[x1][y] = convertHexToRgba(colors.extra);\r\n  }\r\n}\r\n\r\nconst bucket = (e, frame, x, y, size, colors) => {\r\n  const colorsMatch = (a, b) => a.toString() === b.toString();\r\n  let fillColor = convertHexToRgba(colors.main);\r\n  if (e.shiftKey) fillColor = convertHexToRgba(colors.extra);\r\n  const targetColor = frame[x][y];\r\n  if (!colorsMatch(targetColor, fillColor)) {\r\n    const pixelsToCheck = [x, y];\r\n    while (pixelsToCheck.length > 0) {\r\n      const y = pixelsToCheck.pop();\r\n      const x = pixelsToCheck.pop();\r\n      let curColor = null;\r\n      if (x >= 0 && x < size && y >= 0 && y < size) curColor = frame[x][y];\r\n      if (curColor && colorsMatch(curColor, targetColor)) {\r\n        frame[x][y] = fillColor;\r\n        pixelsToCheck.push(x + 1, y);\r\n        pixelsToCheck.push(x - 1, y);\r\n        pixelsToCheck.push(x, y + 1);\r\n        pixelsToCheck.push(x, y - 1);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst brush = (e, frame, colors) => {\r\n  if (e.shiftKey) {\r\n    frame.layers.forEach((layer) => {\r\n      layer.forEach((item, i) => {\r\n        item.forEach((item, j) => {\r\n          layer[i][j] = convertHexToRgba(colors.main);\r\n        });\r\n      });\r\n    });\r\n  }\r\n  frame.layers[frame.currentLayer].forEach((item, i) => {\r\n    item.forEach((item, j) => {\r\n      frame.layers[frame.currentLayer][i][j] = convertHexToRgba(colors.main);\r\n    });\r\n  });\r\n}\r\n// const bucket = (frame, x, y, size, color, currentColor) => {\r\n//   if (x >= 0 && x < size && y >= 0 && y < size) {\r\n//     if (frame[x][y].toString() !== currentColor.toString()) return;\r\n//     frame[x][y] = convertHexToRgba(color);\r\n//     bucket(frame, x + 1, y, size, color, currentColor);\r\n//     bucket(frame, x - 1, y, size, color, currentColor);\r\n//     bucket(frame, x, y + 1, size, color, currentColor);\r\n//     bucket(frame, x, y - 1, size, color, currentColor);\r\n//   }\r\n// }\r\n\r\nconst horizontalReverse = (frame) => {\r\n  frame.reverse();\r\n}\r\n\r\nconst verticalReverse = (frame) => {\r\n  frame.map(item => item.reverse());\r\n}\r\n\r\nconst stroke = (e, x1, y1, x2, y2, frame, colors) => {\r\n  let deltaX = Math.abs(x2 - x1);\r\n  let deltaY = Math.abs(y2 - y1);\r\n  let signX = x1 < x2 ? 1 : -1;\r\n  let signY = y1 < y2 ? 1 : -1;\r\n  let error = deltaX - deltaY;\r\n  e.nativeEvent.buttons === 1 ? frame[x2][y2] = convertHexToRgba(colors.main) : frame[x2][y2] = convertHexToRgba(colors.extra);\r\n  while (x1 !== x2 || y1 !== y2) {\r\n    frame[x1][y1] = e.nativeEvent.buttons === 1 ? frame[x1][y1] = convertHexToRgba(colors.main) : frame[x1][y1] = convertHexToRgba(colors.extra);\r\n    let error2 = error * 2;\r\n    if (error2 > -deltaY) {\r\n      error -= deltaY;\r\n      x1 += signX;\r\n    }\r\n    if (error2 < deltaX) {\r\n      error += deltaX;\r\n      y1 += signY;\r\n    }\r\n  }\r\n  return frame;\r\n}\r\n\r\nconst rectangle = (e, startCoords, x1, y1, frame, colors) => {\r\n  let x = startCoords.x;\r\n  let y = startCoords.y;\r\n  while (x !== x1) {\r\n    e.nativeEvent.buttons === 1 ? frame[x][startCoords.y] = convertHexToRgba(colors.main) : frame[x][startCoords.y] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x < x1) x = x += 1;\r\n    else x = x -= 1\r\n  }\r\n  while (y !== y1) {\r\n    e.nativeEvent.buttons === 1 ? frame[startCoords.x][y] = convertHexToRgba(colors.main) : frame[startCoords.x][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    if (startCoords.y < y1) y++;\r\n    else y--;\r\n  }\r\n  while (x !== startCoords.x) {\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x < x) x--;\r\n    else x++;\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n  }\r\n  return frame;\r\n}\r\n\r\nconst drawCircle = (e, frame, startCoords, x, y, colors, size) => {\r\n  let radius = Math.floor(Math.sqrt(Math.pow(startCoords.x - x, 2) + Math.pow(startCoords.y - y, 2), 2));\r\n  let x0 = 0, y0 = radius, gap = 0, delta = (2 - 2 * radius);\r\n  while (y0 >= 0) {\r\n    if (startCoords.x + x0 >= 0 && startCoords.x + x0 <= size - 1\r\n      && startCoords.y - y0 >= 0 && startCoords.y - y0 <= size - 1) e.nativeEvent.buttons === 1 ? frame[startCoords.x + x0][startCoords.y - y0] = convertHexToRgba(colors.main) : frame[startCoords.x + x0][startCoords.y - y0] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x - x0 >= 0 && startCoords.x - x0 <= size - 1\r\n      && startCoords.y - y0 >= 0 && startCoords.y - y0 <= size - 1) e.nativeEvent.buttons === 1 ? frame[startCoords.x - x0][startCoords.y - y0] = convertHexToRgba(colors.main) : frame[startCoords.x - x0][startCoords.y - y0] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x - x0 >= 0 && startCoords.x - x0 <= size - 1\r\n      && startCoords.y + y0 >= 0 && startCoords.y + y0 <= size - 1) e.nativeEvent.buttons === 1 ? frame[startCoords.x - x0][startCoords.y + y0] = convertHexToRgba(colors.main) : frame[startCoords.x - x0][startCoords.y + y0] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x + x0 >= 0 && startCoords.x + x0 <= size - 1\r\n      && startCoords.y + y0 >= 0 && startCoords.y + y0 <= size - 1) e.nativeEvent.buttons === 1 ? frame[startCoords.x + x0][startCoords.y + y0] = convertHexToRgba(colors.main) : frame[startCoords.x + x0][startCoords.y + y0] = convertHexToRgba(colors.extra);\r\n    gap = 2 * (delta + y0) - 1;\r\n    if (delta < 0 && gap <= 0) {\r\n      x0++;\r\n      delta += 2 * x0 + 1;\r\n      continue;\r\n    }\r\n    if (delta > 0 && gap > 0) {\r\n      y0--;\r\n      delta -= 2 * y0 + 1;\r\n      continue;\r\n    }\r\n    x0++;\r\n    delta += 2 * (x0 - y0);\r\n    y0--;\r\n  }\r\n  return frame;\r\n}\r\n\r\nconst lighten = (e, frame, pikselSize) => {\r\n  const opacityValues = ['1', '.9', '.8', '.7', '.6', '.5', '.4', '.3', '.2', '.1']\r\n  const x = Math.floor(e.nativeEvent.offsetX / pikselSize);\r\n  const y = Math.floor(e.nativeEvent.offsetY / pikselSize);\r\n  let color = frame[x][y];\r\n  if (!color) return;\r\n  let currentOpacity = color[3];\r\n  if (e.shiftKey) {\r\n    const newOpacity = opacityValues[opacityValues.indexOf(currentOpacity) - 1];\r\n    color[3] = newOpacity;\r\n    frame[x][y] = color;\r\n  } else {\r\n    const newOpacity = opacityValues[opacityValues.indexOf(currentOpacity) + 1];\r\n    color[3] = newOpacity;\r\n    frame[x][y] = color;\r\n  }\r\n}\r\n\r\nconst dithering = (e, x, y, frame, colors, size) => {\r\n  const checkAround = (frame, x, y, top, left, bot, right) => {\r\n    let t, l, b, r;\r\n    if (top) t = frame[x][y - 1].toString() === frame[x][y].toString();\r\n    if (left) l = frame[x - 1][y].toString() === frame[x][y].toString();\r\n    if (bot) b = frame[x][y + 1].toString() === frame[x][y].toString();\r\n    if (right) r = frame[x + 1][y].toString() === frame[x][y].toString();\r\n    return r || l || t || b;\r\n  }\r\n  const currentColor = frame[x][y];\r\n  frame[x][y] = convertHexToRgba(colors.main);\r\n  let checked = null;\r\n  if (x > 0 && x < size - 1 && y > 0 && y < size - 1) checked = checkAround(frame, x, y, true, true, true, true);\r\n  if (x === 0 && y !== 0 && y !== size - 1) checked = checkAround(frame, x, y, true, false, true, true);\r\n  if (y === 0 && x !== 0 && x !== size - 1) checked = checkAround(frame, x, y, false, true, true, true);\r\n  if (x === size - 1 && y !== size - 1 && y !== 0) checked = checkAround(frame, x, y, true, true, true, false);\r\n  if (y === size - 1 && x !== size - 1 && x !== 0) checked = checkAround(frame, x, y, true, true, false, true);\r\n  if (x === 0 && y === 0) checked = checkAround(frame, x, y, false, false, true, true);\r\n  if (x === size - 1 && y === size - 1) checked = checkAround(frame, x, y, true, true, false, false);\r\n  if (x === size - 1 && y === 0) checked = checkAround(frame, x, y, false, true, true, false);\r\n  if (x === 0 && y === size - 1) checked = checkAround(frame, x, y, true, false, false, true);\r\n  if (e.shiftKey) {\r\n    if (checked) frame[x][y] = convertHexToRgba(colors.extra);\r\n    else frame[x][y] = convertHexToRgba(colors.main);\r\n  } else {\r\n    if (checked) frame[x][y] = currentColor;\r\n    else frame[x][y] = convertHexToRgba(colors.main);\r\n  }\r\n}\r\n\r\n\r\nconst colorPicker = (e, frame, startCoords, callback) => {\r\n  let pixel = frame[startCoords.x][startCoords.y];\r\n  if (!pixel) return;\r\n  e.shiftKey ? callback(convertRgbToHex(`rgba(${pixel.join()})`)) : callback(convertRgbToHex(`rgba(${pixel.join()})`), true);\r\n}\r\n\r\nconst move = (x1, y1, startCoords, frame, size) => {\r\n  let y = startCoords.y - y1;\r\n  let x = startCoords.x - x1;\r\n  if (x > 0) {\r\n    while (x !== 0) {\r\n      frame.shift();\r\n      frame.push(new Array(size).fill([0, 0, 0, 0]));\r\n      x--;\r\n    }\r\n  }\r\n  if (x < 0) {\r\n    while (x !== 0) {\r\n      frame.unshift(new Array(size).fill([0, 0, 0, 0]));\r\n      frame.pop();\r\n      x++;\r\n    }\r\n  }\r\n  if (y > 0) {\r\n    while (y !== 0) {\r\n      frame.forEach((item) => {\r\n        item.shift();\r\n        item.push([0, 0, 0, 0]);\r\n      });\r\n      y--;\r\n    }\r\n  }\r\n  if (y < 0) {\r\n    while (y !== 0) {\r\n      frame.forEach((item) => {\r\n        item.unshift([0, 0, 0, 0]);\r\n        item.pop();\r\n      });\r\n      y++;\r\n    }\r\n  }\r\n  startCoords.y = y1;\r\n  startCoords.x = x1;\r\n}\r\n\r\nexport {\r\n  pen,\r\n  eraser,\r\n  stroke,\r\n  mirror,\r\n  bucket,\r\n  rectangle,\r\n  drawCircle,\r\n  lighten,\r\n  dithering,\r\n  colorPicker,\r\n  move,\r\n  convertHexToRgba,\r\n  brush,\r\n  verticalReverse,\r\n  horizontalReverse,\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport CanvasInfo from './CanvasInfo';\r\nimport Layers from './Layers';\r\nimport { renderCanvas, createFrameCopy, createFramesCopy, renderLayers, createLayer } from '../Piskel/utils';\r\nimport { drawCircle, pen, eraser, stroke, mirror, bucket, rectangle, lighten, dithering, colorPicker, move, brush, verticalReverse, horizontalReverse } from './Tools';\r\n\r\nexport default class Canvas extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            mousePosition: { x: 0, y: 0 },\r\n            showLayers: false,\r\n        }\r\n        this.layersToSwap = {\r\n            firstLayer: null,\r\n            secondLayer: null,\r\n        }\r\n        this.pikselSize = null;\r\n        this.canvas = null;\r\n        this.isDrawing = false;\r\n        this.canvasSize = 640;\r\n        this.startCoords = {};\r\n        this.frameCopy = null;\r\n    }\r\n\r\n    setMousePosition(value) {\r\n        const mousePosition = Object.assign({}, this.state.mousePosition);\r\n        mousePosition.x = value.x;\r\n        mousePosition.y = value.y;\r\n        this.setState({ mousePosition });\r\n    }\r\n\r\n    componentDidMount() {\r\n        const canvas = this.refs.canvas;\r\n        this.pikselSize = Math.floor(this.canvasSize / this.props.canvasSize);\r\n        this.canvas = canvas;\r\n        this.ctx = canvas.getContext('2d');\r\n        renderCanvas(canvas, this.props.frame.layers[this.props.frame.currentLayer], this.pikselSize);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.pikselSize = this.canvasSize / this.props.canvasSize;\r\n        if (this.frameCopy) return;\r\n        if (this.state.showLayers) renderLayers(this.canvas, createFramesCopy(this.props.frame.layers), this.props.frame.currentLayer, this.pikselSize);\r\n        else renderCanvas(this.canvas, this.props.frame.layers[this.props.frame.currentLayer], this.pikselSize);\r\n    }\r\n\r\n    mouseDownHandler(e) {\r\n        e.preventDefault();\r\n        this.isDrawing = true;\r\n        this.startCoords.x = Math.floor(e.nativeEvent.offsetX / this.pikselSize);\r\n        this.startCoords.y = Math.floor(e.nativeEvent.offsetY / this.pikselSize);\r\n        if (this.props.tools.Stroke.value || this.props.tools.Rectangle.value || this.props.tools.Circle.value) this.frameCopy = createFrameCopy(this.props.frame);\r\n        if (this.props.tools.Pen.value) pen(e, this.startCoords.x, this.startCoords.y, this.props.frame.layers[this.props.frame.currentLayer], this.props.colors);\r\n        this.state.showLayers ? renderLayers(this.canvas, createFramesCopy(this.props.frame.layers), this.props.frame.currentLayer, this.pikselSize)\r\n        : renderCanvas(this.canvas, this.props.frame.layers[this.props.frame.currentLayer], this.pikselSize);\r\n    }\r\n\r\n    mouseMoveHandler(e) {\r\n        let x = Math.floor(e.nativeEvent.offsetX / this.pikselSize);\r\n        let y = Math.floor(e.nativeEvent.offsetY / this.pikselSize);\r\n        if (x <= 0) x = 0;\r\n        if (x > this.props.canvasSize - 1) x = this.props.canvasSize - 1;\r\n        if (y <= 0) y = 0;\r\n        if (y > this.props.canvasSize - 1) y = this.props.canvasSize - 1;\r\n        if (this.props.tools.Pen.value && this.isDrawing) pen(e, x, y, this.props.frame.layers[this.props.frame.currentLayer], this.props.colors);\r\n        if (this.props.tools.Mirror.value && this.isDrawing) mirror(e, x, y, this.props.frame.layers[this.props.frame.currentLayer], this.props.colors);\r\n        if (this.props.tools.Dithering.value && this.isDrawing) dithering(e, x, y, this.props.frame.layers[this.props.frame.currentLayer], this.props.colors, this.props.canvasSize);\r\n        if (this.props.tools.Move.value && this.isDrawing) move(x, y, this.startCoords, this.props.frame.layers[this.props.frame.currentLayer], this.props.canvasSize);\r\n        if (this.props.tools.Eraser.value && this.isDrawing) eraser(x, y, this.props.frame.layers[this.props.frame.currentLayer]);\r\n        if (this.props.tools.Stroke.value && this.isDrawing) {\r\n            const clone = createFrameCopy(this.props.frame);\r\n            this.frameCopy.layers[this.frameCopy.currentLayer] = stroke(e, this.startCoords.x, this.startCoords.y, x, y, clone.layers[clone.currentLayer], this.props.colors);\r\n            this.state.showLayers ? renderLayers(this.canvas, createFramesCopy(this.frameCopy.layers), this.props.frame.currentLayer, this.pikselSize) \r\n            : renderCanvas(this.canvas, this.frameCopy.layers[this.frameCopy.currentLayer], this.pikselSize);\r\n        }\r\n        if (this.props.tools.Rectangle.value && this.isDrawing) {\r\n            const clone = createFrameCopy(this.props.frame);\r\n            this.frameCopy.layers[this.frameCopy.currentLayer] = rectangle(e, this.startCoords, x, y, clone.layers[clone.currentLayer], this.props.colors);\r\n            this.state.showLayers ? renderLayers(this.canvas, createFramesCopy(this.frameCopy.layers), this.props.frame.currentLayer, this.pikselSize) \r\n            : renderCanvas(this.canvas, this.frameCopy.layers[this.frameCopy.currentLayer], this.pikselSize);\r\n        }\r\n        if (this.props.tools.Circle.value && this.isDrawing) {\r\n            const clone = createFrameCopy(this.props.frame);\r\n            this.frameCopy.layers[this.frameCopy.currentLayer] = drawCircle(e, clone.layers[clone.currentLayer], this.startCoords, x, y, this.props.colors, this.props.canvasSize);\r\n            this.state.showLayers ? renderLayers(this.canvas, createFramesCopy(this.frameCopy.layers), this.props.frame.currentLayer, this.pikselSize) \r\n            : renderCanvas(this.canvas, this.frameCopy.layers[this.frameCopy.currentLayer], this.pikselSize);\r\n        }\r\n        this.setMousePosition({ x, y });\r\n    }\r\n\r\n    mouseUpHandler() {\r\n        this.isDrawing = false;\r\n        if (this.frameCopy) {\r\n            this.props.updateFrames(this.frameCopy);\r\n            this.frameCopy = null;\r\n        }\r\n        else if (!this.props.tools.Bucket.value \r\n            && !this.props.tools.ColorPicker.value\r\n            && !this.props.tools.Lighten.value \r\n            && !this.props.tools.Brush.value\r\n            && !this.props.tools.VerticalReverse.value \r\n            && !this.props.tools.HorizontalReverse.value) this.props.updateFrames(this.props.frame);\r\n    }\r\n\r\n    mouseClickHandler(e) {\r\n        e.preventDefault();\r\n        if (this.props.tools.Bucket.value) bucket(e, this.props.frame.layers[this.props.frame.currentLayer], this.startCoords.x, this.startCoords.y, this.props.canvasSize, this.props.colors);\r\n        if (this.props.tools.ColorPicker.value) colorPicker(e, this.props.frame.layers[this.props.frame.currentLayer], this.startCoords, this.props.setColor);\r\n        if (this.props.tools.Lighten.value) lighten(e, this.props.frame.layers[this.props.frame.currentLayer], this.pikselSize);\r\n        if (this.props.tools.Brush.value) brush(e, this.props.frame, this.props.colors);\r\n        if (this.props.tools.VerticalReverse.value) verticalReverse(this.props.frame.layers[this.props.frame.currentLayer]);\r\n        if (this.props.tools.HorizontalReverse.value) horizontalReverse(this.props.frame.layers[this.props.frame.currentLayer]);\r\n        this.state.showLayers ? renderLayers(this.canvas, createFramesCopy(this.props.frame.layers), this.props.frame.currentLayer, this.pikselSize) \r\n        : renderCanvas(this.canvas, this.props.frame.layers[this.props.frame.currentLayer], this.pikselSize);\r\n        if (this.props.tools.Bucket.value \r\n            || this.props.tools.ColorPicker.value\r\n            || this.props.tools.Lighten.value \r\n            || this.props.tools.Brush.value\r\n            || this.props.tools.VerticalReverse.value \r\n            || this.props.tools.HorizontalReverse.value) this.props.updateFrames(this.props.frame);\r\n    }\r\n\r\n    mouseLeaveHandler() {\r\n        if (this.isDrawing) {\r\n            if (this.frameCopy) {\r\n                renderCanvas(this.canvas, this.frameCopy, this.pikselSize);\r\n                this.props.frame.layers[this.props.frame.currentLayer] = this.frameCopy;\r\n                this.props.updateFrames(this.props.frame);\r\n                this.frameCopy = null;\r\n            } else {\r\n                this.props.updateFrames(this.props.frame);\r\n            }\r\n        }\r\n        this.isDrawing = false;\r\n    }\r\n    \r\n    mouseWheelHandler(e) {\r\n        e = window.event;\r\n        let delta = Math.max(-1, Math.min(1, e.wheelDelta));\r\n        this.refs.canvas.style.width = Math.max(640, Math.min(900, this.refs.canvas.offsetWidth + (32 * delta))) + \"px\";\r\n        this.refs.canvas.style.height = Math.max(640, Math.min(900, this.refs.canvas.offsetHeight + (32 * delta))) + \"px\";\r\n    }\r\n\r\n    setCurrentLayer(value) {\r\n        this.props.frame.currentLayer = value;\r\n        this.currentLayer = value;\r\n        this.props.updateFrames(this.props.frame);\r\n    }\r\n\r\n    addLayer() {\r\n        this.props.frame.layers.push(createLayer(this.props.canvasSize));\r\n        this.props.frame.currentLayer++;\r\n        this.props.updateFrames(this.props.frame);\r\n    }\r\n\r\n    deleteLayer() {\r\n        this.props.frame.layers.splice(this.props.frame.currentLayer, 1);\r\n        if (this.props.frame.currentLayer !== 0) this.props.frame.currentLayer--;\r\n        this.props.updateFrames(this.props.frame);\r\n    }\r\n\r\n    toggleShowLayers() {\r\n        this.setState((state) => {\r\n            return { showLayers: !state.showLayers };\r\n        });\r\n    }\r\n\r\n    setNextLayer() {\r\n        if (this.props.frame.currentLayer !== this.props.frame.layers.length - 1) {\r\n            this.props.frame.currentLayer++;\r\n            this.props.updateFrames(this.props.frame);\r\n        }\r\n    }\r\n\r\n    setPreviousLayer() {\r\n        if (this.props.frame.currentLayer !== 0) {\r\n            this.props.frame.currentLayer--;\r\n            this.props.updateFrames(this.props.frame);\r\n        }\r\n    }\r\n\r\n    setLayersToSwap(num, first) {\r\n        if (first) this.layersToSwap.firstLayer = num;\r\n        else this.layersToSwap.secondLayer = num;\r\n    }\r\n\r\n    swapLayers() {\r\n        const firstLayer = this.props.frame.layers[this.layersToSwap.firstLayer];\r\n        const secondLayer = this.props.frame.layers[this.layersToSwap.secondLayer];\r\n        this.props.frame.layers.splice(this.layersToSwap.firstLayer, 1, secondLayer);\r\n        this.props.frame.layers.splice(this.layersToSwap.secondLayer, 1, firstLayer);\r\n        this.props.updateFrames(this.props.frame);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"canvas-container\">\r\n                <CanvasInfo\r\n                    size={this.props.canvasSize}\r\n                    mousePosition={this.state.mousePosition}\r\n\r\n                />\r\n                <div className={'canvas-wrapper'} >\r\n                    <canvas\r\n                        className=\"canvas\"\r\n                        ref='canvas'\r\n                        width={this.canvasSize}\r\n                        height={this.canvasSize}\r\n                        onContextMenu={(e) => { e.preventDefault(); }}\r\n                        onMouseDown={(e) => this.mouseDownHandler(e)}\r\n                        onMouseMove={(e) => this.mouseMoveHandler(e)}\r\n                        onMouseUp={() => this.mouseUpHandler()}\r\n                        onClick={(e) => this.mouseClickHandler(e)}\r\n                        onMouseLeave={() => this.mouseLeaveHandler()}\r\n                        onWheel = {(e) => this.mouseWheelHandler()}\r\n                    />\r\n                </div>\r\n                <Layers\r\n                    setCurrentLayer={(value) => this.setCurrentLayer(value)}\r\n                    frame={this.props.frame}\r\n                    addLayer={() => this.addLayer()}\r\n                    deleteLayer={() => this.deleteLayer()}\r\n                    showLayers={() => this.toggleShowLayers()}\r\n                    setNextLayer={() => this.setNextLayer()}\r\n                    setPreviousLayer={() => this.setPreviousLayer()}\r\n                    isShowing={this.state.showLayers}\r\n                    setLayersToSwap={(a, b) => this.setLayersToSwap(a, b)}\r\n                    swapLayers={() => this.swapLayers()}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\n\r\nexport default class Tool extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            showTooltip: false,\r\n        }\r\n    }\r\n    showTooltip() {\r\n        this.setState({ showTooltip: true });\r\n    }\r\n\r\n    hideTooltip() {\r\n        this.setState({ showTooltip: false });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'button-wrapper'}>\r\n                <button onMouseEnter={() => this.showTooltip()} onMouseLeave={() => this.hideTooltip()} onClick={this.props.callBack} className={this.props.checked ? this.props.name : `${this.props.name} checked`} />\r\n                {this.state.showTooltip && <div ref='toolTip' className={'tooltip'}><p>{`${this.props.name} tool`}<span>{`(${this.props.shortcut})`}</span></p></div>}\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\n\r\nexport default class ShortcutInfo extends React.Component {\r\n    isChanging() {\r\n        document.querySelectorAll('.shortcut').forEach((item) => item.classList.remove('sc-changing'));\r\n        this.refs.shortcut.classList.add('sc-changing');\r\n        document.onkeyup = (e) => {\r\n            this.props.setShortcut(this.props.tool, e.keyCode);\r\n            this.isChanged();\r\n        }\r\n    }\r\n\r\n    isChanged() {\r\n        this.refs.shortcut.classList.remove('sc-changing');\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'sc-info-wrapper'} onClick={() => this.isChanging()}\r\n            >\r\n                <h3>{`${this.props.tool}:`}</h3>\r\n                <p className={'shortcut'} ref='shortcut'>{`'${this.props.shortcut}'`}</p>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ShortcutInfo from './ShortcutInfo';\r\n\r\nexport default class ShortcutsPopup extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.copy = JSON.parse(JSON.stringify(this.props.tools));\r\n        this.state = {\r\n            tools: JSON.parse(JSON.stringify(this.props.tools)),\r\n        }\r\n    }\r\n\r\n    createBtnsInfo() {\r\n        const info = [];\r\n        for (let key in this.state.tools) {\r\n            info.push(<ShortcutInfo key={key} tool={key} shortcut={this.state.tools[key].shortcut} setShortcut={(tool, value) => this.setShortcut(tool, value)} />)\r\n        }\r\n        return info;\r\n    }\r\n\r\n    setShortcut(tool, value) {\r\n        const tools = Object.assign({}, this.state.tools);\r\n        for (let key in tools) {\r\n            if (tools[key].shortcut === String.fromCharCode(value).toUpperCase()) tools[key].shortcut = tools[tool].shortcut;\r\n        }\r\n        tools[tool].shortcut = String.fromCharCode(value).toUpperCase();\r\n        this.setState({\r\n            tools: tools,\r\n        });\r\n        document.onkeyup = null;\r\n    }\r\n\r\n    setDefaultValue() {\r\n        this.setState({ tools: this.copy});\r\n        this.props.togglePopup();\r\n        this.forceUpdate();\r\n    }\r\n\r\n    updateShortcuts() {\r\n        this.props.updateShortcuts(this.state.tools);\r\n        this.props.togglePopup();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'sc-popup'}>\r\n                {this.createBtnsInfo()}\r\n                <button className={'save-sc-btn'} onClick={() => this.updateShortcuts()}>Save</button>\r\n                <button className={'cancel-sc-btn'} onClick={() => this.setDefaultValue()}>Cancel</button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ShortcutsPopup from './ShortcutsPopup';\r\n\r\n\r\nexport default class Shortcuts extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            showPopup: false,\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', (e) => {\r\n            for (let key in this.props.tools) {\r\n                if (String.fromCharCode(e.keyCode).toUpperCase() === this.props.tools[key].shortcut) this.props.setTools(key);\r\n            }\r\n        });\r\n    }\r\n\r\n    togglePopup() {\r\n        this.setState({ showPopup: !this.state.showPopup });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <button className={'shortcuts'} onClick={() => this.togglePopup()} />\r\n                {this.state.showPopup && <ShortcutsPopup togglePopup={() => this.togglePopup()} updateShortcuts={(value) => this.props.updateShortcuts(value)} tools={this.props.tools} />}\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\nimport Tool from './Tool';\r\nimport Shortcuts from './Shortcuts/Shortcuts';\r\n\r\nexport default class Tools extends React.Component {\r\n\r\n    createButtons() {\r\n        const buttons = [];\r\n        for (const key in this.props.tools) {\r\n            let checked = true;\r\n            if (this.props.tools[key].value) checked = false;\r\n            buttons.push(<Tool\r\n                checked={checked}\r\n                name={key}\r\n                key={key}\r\n                callBack={() => this.props.setTools(key)}\r\n                shortcut={this.props.tools[key].shortcut}\r\n            />);\r\n        }\r\n        return buttons;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='tools'>\r\n                {this.createButtons()}\r\n                <div className={'colors'}>\r\n                    <input\r\n                        className='mainColor'\r\n                        value={this.props.colors.main}\r\n                        onChange={(e) => this.props.setColor(e.target.value, true)}\r\n                        type=\"color\">\r\n                    </input>\r\n                    <input\r\n                        className='extraColor'\r\n                        value={this.props.colors.extra}\r\n                        onChange={(e) => this.props.setColor(e.target.value)}\r\n                        type=\"color\">\r\n                    </input>\r\n                    <div className='swap' onClick={() => this.props.swapColors()}></div>\r\n                </div>\r\n                <Shortcuts\r\n                    updateShortcuts={(value) => this.props.updateShortcuts(value)}\r\n                    tools={this.props.tools}\r\n                    setTools={(key) => this.props.setTools(key)}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\nimport { renderCanvas } from '../Piskel/utils';\r\n\r\nexport default class Preview extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.readyToSave = false;\r\n        this.imgsToGif = [];\r\n        this.imgsToPng = [];\r\n        this.framesToShow = [];\r\n        this.interval = null;\r\n        this.canvasSize = 384;\r\n        this.currentFrame = 0;\r\n        this.state = {\r\n            speed: 12\r\n        }\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        if (JSON.stringify(this.props.frames) === JSON.stringify(nextProps.frames) && nextState.speed === this.state.speed) return false;\r\n        else {\r\n            this.pikselSize = Math.floor(this.canvasSize / this.props.canvasSize);\r\n            this.currentFrame = 0;\r\n            renderCanvas(this.canvas, this.props.frames[this.currentFrame].layers[this.props.frames[this.currentFrame].currentLayer], this.pikselSize);\r\n            return true;\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        const canvas = this.refs.canvas;\r\n        this.pikselSize = Math.floor(this.canvasSize / this.props.canvasSize);\r\n        this.canvas = canvas;\r\n        this.ctx = canvas.getContext('2d');\r\n        this.startAnimation();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        clearInterval(this.interval);\r\n        this.framesToShow = [];\r\n        this.readyToSave = false;\r\n        this.imgsToGif = [];\r\n        this.imgsToPng = [];\r\n        this.pikselSize = Math.floor(this.canvasSize / this.props.canvasSize); \r\n        this.currentFrame = 0;\r\n        if (this.props.frames[this.currentFrame].layers.length > 1) renderCanvas(this.canvas, this.props.frames[this.currentFrame].layers, this.pikselSize, true);\r\n        else renderCanvas(this.canvas, this.props.frames[this.currentFrame].layers[0], this.pikselSize);\r\n        this.startAnimation();\r\n    }\r\n\r\n    startAnimation() {\r\n        this.interval = setInterval(() => {\r\n            if (this.framesToShow.length === this.props.frames.length) this.ctx.putImageData(this.framesToShow[this.currentFrame], 0, 0);\r\n            else {\r\n                renderCanvas(this.canvas, this.props.frames[this.currentFrame].layers, this.pikselSize, true);\r\n                this.framesToShow.push(this.ctx.getImageData(0, 0, this.canvasSize, this.canvasSize));\r\n            }\r\n            if (this.imgsToGif.length !== this.props.frames.length && !this.readyToSave) {\r\n                this.imgsToGif.push(this.canvas.toDataURL(\"image/png\"));\r\n                this.imgsToPng.push(this.ctx.getImageData(0, 0, this.canvasSize, this.canvasSize).data.buffer);\r\n            }\r\n            else {\r\n                if (this.readyToSave === false) {\r\n                    this.props.setFramesToSave(this.imgsToGif, this.imgsToPng, this.state.speed);\r\n                    this.readyToSave = true;\r\n                }\r\n            }\r\n            this.currentFrame++;\r\n            if (this.currentFrame === this.props.frames.length) this.currentFrame = 0;\r\n        }, 1000 / this.state.speed);\r\n    }\r\n\r\n    setSpeed(e) {\r\n        clearInterval(this.interval);\r\n        const speed = e.target.value;\r\n        this.setState({ speed });\r\n        this.startAnimation();\r\n    }\r\n\r\n    toggleFullscreen() {\r\n        let elem = document.querySelector(\".preview-wrapper\");\r\n        if (!document.fullscreenElement) {\r\n            elem.requestFullscreen();\r\n        } else {\r\n            document.exitFullscreen();\r\n        }\r\n    }\r\n\r\n    showFullScreenButton() {\r\n        this.refs.fsButton.style.opacity = '1';\r\n    }\r\n\r\n    hideFullScreenButton() {\r\n        this.refs.fsButton.style.opacity = '0';\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='previev-container'>\r\n                <div onMouseEnter={() => this.showFullScreenButton()} onMouseLeave={() => this.hideFullScreenButton()} className={'preview-wrapper'}>\r\n                    <canvas\r\n                        className='preview'\r\n                        ref='canvas'\r\n                        width={this.canvasSize}\r\n                        height={this.canvasSize}\r\n                    />\r\n                    <button className={'preview-fullscreen'} ref='fsButton' onClick={(e) => this.toggleFullscreen(e)}></button>\r\n                </div>\r\n                <p>{`FPS Rate: ${this.state.speed}`}</p>\r\n                <input\r\n                    onInput={(e) => this.setSpeed(e)}\r\n                    type='range'\r\n                    min=\"1\"\r\n                    max=\"24\"\r\n                    defaultValue='12' />\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\nimport { renderCanvas } from '../Piskel/utils';\r\n\r\nexport default class Frame extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.pikselSize = null;\r\n        this.frameSize = 256;\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps) {\r\n        if (JSON.stringify(this.props.frame) === JSON.stringify(nextProps.frame)) return false;\r\n        else return true;\r\n    }\r\n\r\n    componentDidMount() {\r\n        const canvas = this.refs.canvas;\r\n        this.canvas = canvas;\r\n        this.pikselSize = Math.floor(this.frameSize / this.props.canvasSize);\r\n        renderCanvas(canvas, this.props.frame.layers[this.props.frame.currentLayer], this.pikselSize);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.pikselSize = Math.floor(this.frameSize / this.props.canvasSize);\r\n        renderCanvas(this.canvas, this.props.frame.layers[this.props.frame.currentLayer], this.pikselSize);\r\n    }\r\n\r\n    showButtons() {\r\n        this.refs.clone.style.opacity = '1';\r\n        this.refs.delete.style.opacity = '1';\r\n    }\r\n\r\n    hideButtons() {\r\n        this.refs.clone.style.opacity = '0';\r\n        this.refs.delete.style.opacity = '0';\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div onMouseEnter={() => this.showButtons()} onMouseLeave={() => this.hideButtons()} className={this.props.current ? `frame-wrapper frame-wrapper-active` : 'frame-wrapper'}>\r\n                <canvas\r\n                    className={'frame-canvas'}\r\n                    draggable={'true'}\r\n                    ref='canvas'\r\n                    width={this.frameSize}\r\n                    height={this.frameSize}\r\n                    onClick={() => this.props.setCurrentFrame(this.props.frame)}\r\n                    onDragEnter={() => {\r\n                        this.canvas.parentNode.classList.add('frame-wrapper-dragEnter');\r\n                        this.props.setTargetToSwap(this.props.frame, false);\r\n                    }}\r\n                    onDragOver={(e) => e.preventDefault()}\r\n                    onDragLeave={() => this.canvas.parentNode.classList.remove('frame-wrapper-dragEnter')}\r\n                    onDragStart={() => {\r\n                        this.canvas.parentNode.classList.add('frame-wrapper-dragStart');\r\n                        this.props.setTargetToSwap(this.props.frame, true);\r\n                    }}\r\n                    onDragEnd={() => {\r\n                        this.props.swapFrames();\r\n                        this.canvas.parentNode.classList.remove('frame-wrapper-dragEnter');\r\n                        this.canvas.parentNode.classList.remove('frame-wrapper-dragStart');\r\n                    }}\r\n                />\r\n                <p className={'frame-number'}>{this.props.num + 1}</p>\r\n                <button className={'frame-copy'} ref='clone' onClick={() => this.props.cloneFrame(this.props.frame)} />\r\n                <button className={'frame-delete'} ref='delete' onClick={() => this.props.deleteFrame(this.props.frame)} />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\nimport Frame from './Frame';\r\n\r\nexport default class Frames extends React.Component {\r\n\r\n    shouldComponentUpdate(nextProps) {\r\n        if (JSON.stringify(this.props.frames) === JSON.stringify(nextProps.frames) && this.props.canvasSize === nextProps.canvasSize && this.props.currentFrame === nextProps.currentFrame) return false;\r\n        else return true;\r\n    }\r\n\r\n    renderFrames() {\r\n        const frames = [];\r\n        this.props.frames.forEach((frame, i) => {\r\n            let current = false;\r\n            if (this.props.currentFrame === i) current = true;\r\n            frames.push(<Frame\r\n                current={current}\r\n                canvasSize={this.props.canvasSize}\r\n                num={i}\r\n                key={Math.random().toString(36).substring(7)}\r\n                frame={frame}\r\n                deleteFrame={this.props.deleteFrame}\r\n                cloneFrame={this.props.cloneFrame}\r\n                setCurrentFrame={this.props.setCurrentFrame}\r\n                setTargetToSwap={this.props.setTargetToSwap}\r\n                swapFrames={this.props.swapFrames}\r\n            />\r\n            )\r\n        })\r\n        return frames;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'frames-wrapper'}>\r\n                {this.renderFrames()}\r\n                <button className={'add-frame'} onClick={() => this.props.addFrame()}><p>Add new frame</p></button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\n\r\nexport default class Header extends React.PureComponent {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            mail: null,\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        try {\r\n            window.gapi.load('auth2', () => {\r\n                window.gapi.auth2.init({ client_id: '355911681552-osgglvf1ep2a6ivbi8h0uhd8nprv452a.apps.googleusercontent.com' });\r\n            });\r\n        } catch (error) {\r\n            console.log(error.message);\r\n        }\r\n\r\n    }\r\n\r\n    signIn() {\r\n        const GoogleAuth = window.gapi.auth2.getAuthInstance();\r\n        GoogleAuth.signIn({ scope: 'https://www.googleapis.com/auth/drive' })\r\n            .then(user => this.setState({ mail: user.w3.U3 }));\r\n    }\r\n\r\n    singOut() {\r\n        const GoogleAuth = window.gapi.auth2.getAuthInstance();\r\n        GoogleAuth.signOut().then(i => this.setState({ mail: null }));\r\n    }\r\n\r\n    render() {\r\n        const { mail } = this.state;\r\n        return (\r\n            <div className={'header'}>\r\n                <div className={'logo'} />\r\n                <div className={'user-info-wrapper'}>\r\n                    <p className={'user-info'}>{this.state.mail}</p>\r\n                    {!mail && <button onClick={() => this.signIn()}>Log In</button>}\r\n                    {mail && <button onClick={() => this.singOut()}>Log Out</button>}\r\n\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nexport default class Settings extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            showSaveInfo: false,\r\n            showResizeInfo: false,\r\n            project: 'Import .rss file...',\r\n        }\r\n    }\r\n\r\n    showResizeInfo() {\r\n        if (!this.state.showSaveInfo && !this.state.showResizeInfo) {\r\n            this.setState({ showResizeInfo: true });\r\n            this.refs.settings.classList.add('show-settings');\r\n            this.refs.resizeInfo.style.borderRight = 'none';\r\n        }\r\n        if (this.state.showResizeInfo) this.refs.settings.classList.toggle('show-settings');\r\n        if (this.state.showSaveInfo) {\r\n            this.setState({ showResizeInfo: true, showSaveInfo: false });\r\n            this.refs.saveInfo.style.borderRight = '3px solid black';\r\n            this.refs.resizeInfo.style.borderRight = 'none';\r\n            this.refs.settings.classList.add('show-settings');\r\n        }\r\n    }\r\n\r\n    showSaveInfo() {\r\n        if (!this.state.showSaveInfo && !this.state.showResizeInfo) {\r\n            this.setState({ showSaveInfo: true });\r\n            this.refs.settings.classList.add('show-settings');\r\n            this.refs.saveInfo.style.borderRight = 'none';\r\n        }\r\n        if (this.state.showSaveInfo) this.refs.settings.classList.toggle('show-settings');\r\n        if (this.state.showResizeInfo) {\r\n            this.setState({ showResizeInfo: false, showSaveInfo: true });\r\n            this.refs.resizeInfo.style.borderRight = '3px solid black';\r\n            this.refs.saveInfo.style.borderRight = 'none';\r\n            this.refs.settings.classList.add('show-settings');\r\n        }\r\n    }\r\n\r\n    importRssFileHandler() {\r\n        this.setState({ project: document.querySelector('input[type=file]').files[0].name });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div ref='settings' className={'settings'}>\r\n                <div className={'settings-btn-wrapper'}>\r\n                    <button className={'saveInfo-btn'} ref='saveInfo' onClick={() => this.showSaveInfo()} />\r\n                    <button className={'resizeInfo-btn'} ref='resizeInfo' onClick={() => this.showResizeInfo()} />\r\n                </div>\r\n                <div className={'settings-info-container'}>\r\n                    {this.state.showResizeInfo && <div className={'canvas-resize-wrapper'}>\r\n                        <h3>{`Current size: ${this.props.canvasSize} x ${this.props.canvasSize}`}</h3>\r\n                        <div className={\"button\"} onClick={() => this.props.resize(32)}>\r\n                            <p className={\"btnText\"} >32x32</p>\r\n                            <div className={\"btnTwo\"}>\r\n                                <p className={\"btnText2\"}>Resize</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className={\"button\"} onClick={() => this.props.resize(64)}>\r\n                            <p className={\"btnText\"}>64x64</p>\r\n                            <div className={\"btnTwo\"}>\r\n                                <p className={\"btnText2\"}>Resize</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className={\"button\"} onClick={() => this.props.resize(128)}>\r\n                            <p className={\"btnText\"}>128x128</p>\r\n                            <div className={\"btnTwo\"}>\r\n                                <p className={\"btnText2\"}>Resize</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>}\r\n                    {this.state.showSaveInfo && <div><div className={'canvas-saveInfo-wrapper'}>\r\n                        <div className={'save-format-btn-wrapper'}>\r\n                            <input\r\n                                type={'file'}\r\n                                id={'file'}\r\n                                className={'inputFile'}\r\n                                onChange={() => {\r\n                                    this.importRssFileHandler();\r\n                                    this.props.importRssFile();\r\n                                }}\r\n                            />\r\n                            <label htmlFor=\"file\">\r\n                                <div className={'import-file'} />\r\n                                {this.state.project}\r\n                            </label>\r\n                            <h3>Save as:</h3>\r\n                            <div className={\"button\"} onClick={this.props.saveAsGif}>\r\n                                <p className={\"btnText\"} >.gif</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className={\"button\"} onClick={this.props.saveAsApng}>\r\n                                <p className={\"btnText\"}>.apng</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className={\"button\"} onClick={this.props.saveAsPiskel}>\r\n                                <p className={\"btnText\"}>.piskel</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className={\"button\"} onClick={this.props.saveAsRss}>\r\n                                <p className={\"btnText\"}>.rss</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className={'save-location-btn-wrapper'}>\r\n                            <h3>Save to:</h3>\r\n                            <div className={\"button\"} onClick={this.props.saveToLocalStorage}>\r\n                                <p className={\"btnText\"}>Storage</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className={\"button\"} onClick={this.props.saveToGoogleDrive}>\r\n                                <p className={\"btnText\"}>Google</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Upload</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    </div>}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\nimport './style.css';\nimport download from 'downloadjs';\nimport UPNG from 'upng-js';\nimport gifshot from 'gifshot';\nimport StartPage from '../StartPage/StartPage';\nimport Canvas from '../Canvas/Canvas';\nimport Tools from '../Tools/Tools';\nimport Preview from '../Preview/Preview';\nimport Frames from '../Frames/Frames';\nimport Header from '../Header/Header';\nimport Settings from '../Settings/Settings';\nimport { createFrame, createFrameCopy, createFramesCopy, resize, createStateCopy, saveToGoogleDrive, saveAsPiskel, uploadProject } from './utils';\n\nclass Piskel extends React.Component {\n  constructor(props) {\n    super(props);\n    this.targetsToSwap = {\n      firstTarget: null,\n      secondTarget: null,\n    };\n    this.state = {\n      projectIsStarted: false,\n      canvasSize: 32,\n      frames: [createFrame(32)],\n      stateHistory: [],\n      currentFrame: 0,\n      framesToSaveAsGif: [],\n      framesToSaveAsApng: [],\n      animationSpeed: null,\n      colors: {\n        main: '#000000',\n        extra: '#8080ff',\n      },\n      tools: {\n        Pen: { value: false, shortcut: 'Q' },\n        Mirror: { value: false, shortcut: 'W' },\n        Bucket: { value: false, shortcut: 'E' },\n        Eraser: { value: false, shortcut: 'R' },\n        Brush: { value: false, shortcut: 'T' },\n        Stroke: { value: false, shortcut: 'Y' },\n        Rectangle: { value: false, shortcut: 'A' },\n        Circle: { value: false, shortcut: 'S' },\n        Move: { value: false, shortcut: 'D' },\n        ColorPicker: { value: false, shortcut: 'F' },\n        Lighten: { value: false, shortcut: 'G' },\n        Dithering: { value: false, shortcut: 'H' },\n        VerticalReverse: { value: false, shortcut: 'C' },\n        HorizontalReverse: { value: false, shortcut: 'X' },\n      },\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener('keypress', (e) => {\n      if (e.keyCode === 26 && e.ctrlKey && this.state.stateHistory.length) this.stepBack();\n    });\n    if (localStorage.getItem('state')) this.setState({ ...JSON.parse(localStorage.getItem('state')) });\n  }\n\n  setFramesToSave(framesToSaveAsGif, framesToSaveAsApng, animationSpeed) {\n    this.setState({ framesToSaveAsGif, framesToSaveAsApng, animationSpeed });\n  }\n\n  saveToLocalStorage() {\n    localStorage.clear();\n    localStorage.setItem('state', JSON.stringify(this.state));\n  }\n\n  saveAsApng() {\n    const imageData = UPNG.encode(this.state.framesToSaveAsApng, 384, 384, 0, new Array(this.state.framesToSaveAsApng.length).fill(1000 / this.state.animationSpeed));\n    download(imageData, 'newAPNG.apng', 'apng');\n  }\n\n  saveAsPiskel() {\n    download(saveAsPiskel(1 / this.state.animationSpeed, 384, this.state.framesToSaveAsGif.length, this.state.framesToSaveAsGif), 'newPiskel.piskel', 'piskel');\n  }\n\n  saveAsRss() {\n    download(JSON.stringify(createStateCopy(this.state, this.state.frames)), 'project.rss', 'rss');\n  }\n\n  saveToGoogleDrive() {\n    saveToGoogleDrive(UPNG.encode(this.state.framesToSaveAsApng, 384, 384, 0, new Array(this.state.framesToSaveAsApng.length).fill(1000 / this.state.animationSpeed)));\n  }\n\n  importRssFile() {\n    const updateState = data => this.setState({ ...JSON.parse(data), stateHistory: [] });\n    uploadProject(updateState);\n  }\n\n  stepBack() {\n    const step = this.state.stateHistory.pop();\n    const {\n      speed, canvasSize, frames, currentFrame, colors, tools,\n    } = step;\n    this.setState({\n      speed, canvasSize, frames, currentFrame, colors, tools,\n    });\n  }\n\n  saveCurrentState() {\n    const stateCopy = createStateCopy(this.state, this.state.frames);\n    const stateHistory = createFramesCopy(this.state.stateHistory);\n    if (stateHistory.length > 5) stateHistory.shift();\n    stateHistory.push(stateCopy);\n    return stateHistory;\n  }\n\n  resize(canvasSize) {\n    let frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    frames = resize(frames, this.state.canvasSize, canvasSize);\n    this.setState({ frames, canvasSize, stateHistory });\n  }\n\n  updateFrames(frame) {\n    if (JSON.stringify(this.state.frames[this.state.currentFrame]) === JSON.stringify(frame)) return false;\n    const frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    frames[this.state.currentFrame] = frame;\n    this.setState({ frames, stateHistory });\n  }\n\n  setCurrentFrame(frame) {\n    const stateHistory = this.saveCurrentState();\n    const currentFrame = this.state.frames.indexOf(frame);\n    this.setState({ currentFrame, stateHistory });\n  }\n\n  addFrame() {\n    const frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    frames.push(createFrame(this.state.canvasSize));\n    let currentFrame = this.state.currentFrame;\n    currentFrame += 1;\n    this.setState({ frames, currentFrame, stateHistory });\n  }\n\n\n  deleteFrame(frame) {\n    const frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    if (frames.length === 1) {\n      this.setState({ frames: [createFrame(this.state.canvasSize)], stateHistory });\n    } else {\n      let { currentFrame } = this.state;\n      const index = this.state.frames.indexOf(frame);\n      if (currentFrame !== 0) currentFrame -= 1;\n      frames.splice(index, 1);\n      this.setState({ frames, currentFrame });\n    }\n  }\n\n  cloneFrame(frame) {\n    const frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    let currentFrame = this.state.currentFrame;\n    currentFrame++;\n    frames.splice(this.state.frames.indexOf(frame), 0, createFrameCopy(frame));\n    this.setState({ frames, currentFrame, stateHistory });\n  }\n\n  setColor(value, isMain) {\n    const stateHistory = this.saveCurrentState();\n    if (isMain) {\n      this.setState({\n        stateHistory,\n        colors: {\n          main: value,\n          extra: this.state.colors.extra,\n        },\n      });\n    } else {\n      this.setState({\n        stateHistory,\n        colors: {\n          main: this.state.colors.main,\n          extra: value,\n        },\n      });\n    }\n  }\n\n  swapColors() {\n    const stateHistory = this.saveCurrentState();\n    this.setState(state => ({\n      stateHistory,\n      colors: {\n        main: state.colors.extra,\n        extra: state.colors.main,\n      },\n    }));\n  }\n\n  setTools(tool) {\n    const tools = Object.assign({}, this.state.tools);\n    tools[tool].value = !tools[tool].value;\n    for (const key in tools) {\n      if (key !== tool) {\n        tools[key].value = false;\n      }\n    }\n    this.setState({\n      tools,\n    });\n  }\n\n  updateShortcuts(value) {\n    this.setState({ tools: value });\n  }\n\n  setTargetToSwap(frame, first) {\n    if (first) this.targetsToSwap.firstTarget = frame;\n    else this.targetsToSwap.secondTarget = frame;\n  }\n\n  saveAsGif() {\n    gifshot.createGIF({\n      images: this.state.framesToSaveAsGif,\n      interval: 1 / this.state.animationSpeed,\n      gifWidth: 384,\n      gifHeight: 384,\n    }, (obj) => {\n      if (!obj.error) download(obj.image, 'newGif.gif', 'gif');\n    });\n  }\n\n  startProject() {\n    this.setState({ projectIsStarted: true });\n  }\n\n\n  swapFrames() {\n    if (!this.targetsToSwap.secondTarget || this.targetsToSwap.firstTarget === this.targetsToSwap.secondTarget) return;\n    const stateHistory = this.saveCurrentState();\n    const frames = createFramesCopy(this.state.frames);\n    frames.splice(this.state.frames.indexOf(this.targetsToSwap.firstTarget), 1, this.targetsToSwap.secondTarget);\n    frames.splice(this.state.frames.indexOf(this.targetsToSwap.secondTarget), 1, this.targetsToSwap.firstTarget);\n    this.setState({ frames, stateHistory });\n  }\n\n  render() {\n    return (\n      <div>\n        <Header />\n        {!this.state.projectIsStarted && <StartPage startProject={() => this.startProject()} />}\n        {this.state.projectIsStarted && (\n          <div className=\"container\">\n            <Tools\n              tools={this.state.tools}\n              setTools={tool => this.setTools(tool)}\n              setColor={(value, isMain) => this.setColor(value, isMain)}\n              swapColors={() => this.swapColors()}\n              colors={this.state.colors}\n              updateShortcuts={value => this.updateShortcuts(value)}\n            />\n            <Frames\n              currentFrame={this.state.currentFrame}\n              canvasSize={this.state.canvasSize}\n              frames={this.state.frames}\n              addFrame={() => this.addFrame()}\n              deleteFrame={frame => this.deleteFrame(frame)}\n              cloneFrame={frame => this.cloneFrame(frame)}\n              setCurrentFrame={frame => this.setCurrentFrame(frame)}\n              setTargetToSwap={(frame, first) => this.setTargetToSwap(frame, first)}\n              swapFrames={() => this.swapFrames()}\n            />\n            <Canvas\n              frames={createFramesCopy(this.state.frames)}\n              setMousePosition={value => this.setMousePosition(value)}\n              canvasSize={this.state.canvasSize}\n              tools={this.state.tools}\n              colors={this.state.colors}\n              updateFrames={frame => this.updateFrames(frame)}\n              frame={createFrameCopy(this.state.frames[this.state.currentFrame])}\n              setColor={(value, isMain) => this.setColor(value, isMain)}\n            />\n            <Preview\n              frames={this.state.frames}\n              canvasSize={this.state.canvasSize}\n              setFramesToSave={(gif, png, speed) => this.setFramesToSave(gif, png, speed)}\n            />\n            <Settings\n              saveAsApng={() => this.saveAsApng()}\n              saveAsGif={() => this.saveAsGif()}\n              saveToGoogleDrive={() => this.saveToGoogleDrive()}\n              saveToLocalStorage={() => this.saveToLocalStorage()}\n              saveAsPiskel={() => this.saveAsPiskel()}\n              resize={canvasSize => this.resize(canvasSize)}\n              canvasSize={this.state.canvasSize}\n              saveAsRss={() => this.saveAsRss()}\n              importRssFile={() => this.importRssFile()}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Piskel;\n\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Piskel from './Components/Piskel/Piskel';\n\nReactDOM.render(<Piskel />, document.getElementById('root'));"],"sourceRoot":""}