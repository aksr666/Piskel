{"version":3,"sources":["Components/StartPage/StartPage.js","Components/Canvas/CanvasInfo.js","Components/Canvas/Layers.js","Components/Piskel/utils.js","Components/Canvas/Tools.js","Components/Canvas/Canvas.js","Components/Tools/Tool.js","Components/Tools/Shortcuts/ShortcutInfo.js","Components/Tools/Shortcuts/ShortcutsPopup.js","Components/Tools/Shortcuts/Shortcuts.js","Components/Tools/Tools.js","Components/Preview/Preview.js","Components/Frames/Frame.js","Components/Frames/Frames.js","Components/Header/Header.js","Components/Settings/Settings.js","Components/Piskel/Piskel.js","index.js"],"names":["StartPage","react_default","a","createElement","className","onClick","this","props","startProject","href","React","Component","CanvasInfo","_this$props","mousePosition","size","x","y","concat","PureComponent","Layers","frame","setCurrentLayer","setLayersToSwap","swapLayers","layers","forEach","layer","i","push","currentLayer","key","Math","random","toString","substring","draggable","onDragEnter","e","target","style","border","onDragOver","preventDefault","onDragLeave","onDragStart","opacity","onDragEnd","_this$props2","addLayer","setNextLayer","setPreviousLayer","deleteLayer","showLayers","isShowing","length","disabled","renderLayers","createFrame","Array","from","fill","createFrameCopy","copy","JSON","parse","stringify","createFramesCopy","frames","map","canvas","pikselSize","context","getContext","clearRect","width","height","index","item","j","fillStyle","join","fillRect","splice","renderCanvas","resize","currentSize","unshift","letngth","addCells","pop","shift","removeCells","createStateCopy","state","framesCopy","stateCopy","Object","assign","framesToSaveAsApng","framesToSaveAsGif","stateHistory","convertHexToRgba","hex","c","test","split","convertRgbToHex","rgb","match","parseInt","slice","pen","colors","nativeEvent","buttons","main","extra","Canvas","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","layersToSwap","firstLayer","secondLayer","isDrawing","canvasSize","startCoords","frameCopy","value","setState","refs","floor","ctx","_this$props3","tools","offsetX","offsetY","Stroke","Rectangle","Circle","Pen","_this$props4","Mirror","x1","y1","ctrlKey","shiftKey","mirror","Dithering","checkAround","top","left","bot","right","t","l","b","r","currentColor","checked","dithering","Move","move","Eraser","eraser","clone","x2","y2","deltaX","abs","deltaY","signX","signY","error","error2","stroke","rectangle","radius","sqrt","pow","x0","y0","gap","delta","drawCircle","setMousePosition","_this$props5","updateFrames","Bucket","ColorPicker","Lighten","Brush","VerticalReverse","HorizontalReverse","_this$props6","setColor","colorsMatch","fillColor","targetColor","pixelsToCheck","curColor","bucket","callback","pixel","colorPicker","opacityValues","color","currentOpacity","newOpacity","indexOf","lighten","brush","reverse","verticalReverse","horizontalReverse","_this$props7","window","event","max","min","wheelDelta","offsetWidth","offsetHeight","_this$props8","_this$props9","_this$props10","_this$props11","_this$props12","num","first","_this$props13","_this2","CanvasInfo_CanvasInfo","ref","onContextMenu","onMouseDown","mouseDownHandler","onMouseMove","mouseMoveHandler","onMouseUp","mouseUpHandler","mouseClickHandler","onMouseLeave","mouseLeaveHandler","onWheel","mouseWheelHandler","Layers_Layers","toggleShowLayers","Tool","showTooltip","name","shortcut","callBack","onMouseEnter","hideTooltip","ShortcutInfo","tool","setShortcut","document","querySelectorAll","classList","remove","add","onkeyup","keyCode","isChanged","isChanging","ShortcutsPopup","info","ShortcutInfo_ShortcutInfo","String","fromCharCode","toUpperCase","togglePopup","forceUpdate","updateShortcuts","_this3","createBtnsInfo","setDefaultValue","Shortcuts","showPopup","addEventListener","setTools","ShortcutsPopup_ShortcutsPopup","Tools","_loop","Tool_Tool","createButtons","onChange","type","swapColors","Shortcuts_Shortcuts","Preview","readyToSave","imgsToGif","imgsToPng","framesToShow","interval","currentFrame","speed","nextProps","nextState","startAnimation","clearInterval","setFramesToSave","setInterval","putImageData","getImageData","toDataURL","data","buffer","elem","querySelector","fullscreenElement","exitFullscreen","requestFullscreen","fsButton","showFullScreenButton","hideFullScreenButton","toggleFullscreen","onInput","setSpeed","defaultValue","Frame","frameSize","_this$refs","cloneFrame","deleteFrame","_this$refs2","showButtons","hideButtons","current","setCurrentFrame","parentNode","setTargetToSwap","swapFrames","Frames","framesToRender","Frame_Frame","renderFrames","addFrame","Header","mail","gapi","load","auth2","init","client_id","console","log","message","getAuthInstance","signIn","scope","then","user","w3","U3","signOut","_this4","singOut","Settings","showSaveInfo","showResizeInfo","project","_this$state","settings","resizeInfo","saveInfo","borderRight","toggle","_this$state2","files","id","importRssFileHandler","importRssFile","htmlFor","saveAsGif","saveAsApng","saveAsPiskel","saveAsRss","saveToLocalStorage","saveToGoogleDrive","Piskel","targetsToSwap","firstTarget","secondTarget","projectIsStarted","animationSpeed","stepBack","localStorage","getItem","objectSpread","gifshot","createGIF","images","gifWidth","gifHeight","obj","download","image","clear","setItem","imageData","UPNG","encode","framesCount","fileContent","file","Blob","accessToken","currentUser","get","getAuthResponse","access_token","form","FormData","append","mimeType","fetch","method","headers","Headers","Authorization","body","cb","URL","createObjectURL","rawFile","XMLHttpRequest","overrideMimeType","open","onreadystatechange","readyState","responseText","send","uploadProject","step","saveCurrentState","isMain","Header_Header","StartPage_StartPage","Tools_Tools","Frames_Frames","Canvas_Canvas","Preview_Preview","gif","png","Settings_Settings","ReactDOM","render","Piskel_Piskel","getElementById"],"mappings":"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","file":"static/js/main.75499512.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nexport default class StartPage extends React.Component {\r\n    render() {\r\n        return (\r\n            <div className={'start-page'}>\r\n                <section className={'main-title'}>\r\n                    <div className={'main-title-left'}>\r\n                        <h2 className={'title-text-main'}>Piskel-clone is a final project of the second stage course of The Rolling Scopes School</h2>\r\n                        <p className={'title-text'}>Create animations in your browser</p>\r\n                        <button onClick={this.props.startProject}>Create Sprite</button>\r\n                    </div>\r\n                    <div className={'main-title-right'}>\r\n                        <div className={'piskel-screen'} />\r\n                    </div>\r\n                </section>\r\n                <section className={'sprites-section'}>\r\n                    <h2>Sprites example</h2>\r\n                    <div className={'sprites-gallery'}>\r\n                        <div className={'sprite sprt1'} />\r\n                        <div className={'sprite sprt2'} />\r\n                        <div className={'sprite sprt3'} />\r\n                        <div className={'sprite sprt4'} />\r\n                        <div className={'sprite sprt5'} />\r\n                        <div className={'sprite sprt6'} />\r\n                        <div className={'sprite sprt7'} />\r\n                        <div className={'sprite sprt8'} />\r\n                    </div>\r\n                </section>\r\n                <section className={'functionality'}>\r\n                    <h2>Functionality</h2>\r\n                    <div className={'functionality-gallery'}>\r\n                        <div>\r\n                            <p>Choose color</p>\r\n                            <div className={'functionality-wrapper fnc1'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Frame managment</p>\r\n                            <div className={'functionality-wrapper fnc2'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Layer managment</p>\r\n                            <div className={'functionality-wrapper fnc3'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Live preview</p>\r\n                            <div className={'functionality-wrapper fnc4'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Export to .gif/.apng</p>\r\n                            <div className={'functionality-wrapper fnc5'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Hotkeys</p>\r\n                            <div className={'functionality-wrapper fnc6'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Google SingIn</p>\r\n                            <div className={'functionality-wrapper fnc7'} />\r\n                        </div>\r\n                        <div>\r\n                            <p>Tools</p>\r\n                            <div className={'functionality-wrapper fnc8'} />\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n                <section className={'about-container'}>\r\n                    <div className={'author-img'} />\r\n                    <div className={'about-author'}>\r\n                        <h2 className={'author-name'}>akSr-</h2>\r\n                        <p>I like the programming, it's exciting and fascinating. Coding is one of the easiest ways to solve practical problems.\r\n                            The end product depends only upon how hight your skills and good idea but not any other factors.</p>\r\n                    </div>\r\n                    <div className={'author-contacts'}>\r\n                        <p>GitHub: <a href='https://github.com/aksr666'>https://github.com/aksr666</a></p>\r\n                    </div>\r\n                </section>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\n\r\nexport default class CanvasInfo extends React.PureComponent {\r\n    render() {\r\n        const { mousePosition, size } = this.props;\r\n        let x = mousePosition.x;\r\n        let y = mousePosition.y\r\n        if (x >= size - 1) x = size;\r\n        if (x <= 0) x = 1;\r\n        if (y >= size - 1) y = size;\r\n        if (y <= 0) y = 1;\r\n        return (\r\n            <div className={'canvas-info'}>\r\n                <div className={'cursor-position'} >\r\n                    <h2>Mouse position:</h2>\r\n                    <p className={'cursor-position-x'}>{`X: ${x}`}</p>\r\n                    <p className={'cursor-position-y'}>{`Y: ${y}`}</p>\r\n                </div>\r\n                <div className={'canvas-size'}>\r\n                    <h3>{`Cavas size: ${size} x ${size}`}</h3>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\n\r\nexport default class Layers extends React.PureComponent {\r\n\r\n    renderLayers() {\r\n        const { frame, setCurrentLayer, setLayersToSwap, swapLayers } = this.props;\r\n        const layers = [];\r\n        frame.layers.forEach((layer, i) => {\r\n            layers.push(<p\r\n                className={frame.currentLayer === i ? `layer layer-current` : `layer`}\r\n                key={Math.random().toString(36).substring(7)}\r\n                draggable={'true'}\r\n                onClick={() => setCurrentLayer(i)}\r\n                onDragEnter={(e) => {\r\n                    e.target.style.border = '1px dashed red';\r\n                    setLayersToSwap(i, false);\r\n                }}\r\n                onDragOver={(e) => e.preventDefault()}\r\n                onDragLeave={(e) => e.target.style.border = '1px solid white'}\r\n                onDragStart={(e) => {\r\n                    e.target.style.opacity = .5;\r\n                    setLayersToSwap(i, true);\r\n                }}\r\n                onDragEnd={(e) => {\r\n                    e.target.style.opacity = 1;\r\n                    e.target.style.border = '1px solid white';\r\n                    swapLayers();\r\n                }}\r\n            >{`Layer-${i + 1}`}\r\n            </p>)\r\n        });\r\n        return layers;\r\n    }\r\n\r\n    render() {\r\n        const { frame, addLayer, setNextLayer, setPreviousLayer, deleteLayer, showLayers, isShowing } = this.props;\r\n        return (\r\n            <div className={'layers-info'}>\r\n                <div className={'layers-header'}>\r\n                    <h3>Layers</h3>\r\n                    <button className={isShowing ? `show-layers checked` : `show-layers`} onClick={showLayers}></button>\r\n                </div>\r\n                <div className={'layers-buttons'}>\r\n                    <button className={'layers-btn'} onClick={addLayer}>+</button>\r\n                    <button className={frame.layers.length > 1 ? 'layers-btn' : 'layers-btn disabled'} disabled={frame.layers.length > 1 ? false : true} onClick={deleteLayer}>-</button>\r\n                    <button className={frame.layers.length !== 1 ? 'layers-btn' : 'layers-btn disabled'} disabled={!frame.layers.length} onClick={setNextLayer}><p className={'layers-next'}>►</p></button>\r\n                    <button className={frame.layers.length !== 1 ? 'layers-btn' : 'layers-btn disabled'} disabled={!frame.layers.length} onClick={setPreviousLayer}><p className={'layers-prev'}>►</p></button>\r\n                </div>\r\n                {this.renderLayers()}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","const createFrame = (size) => {\r\n    const frame = {};\r\n    frame.layers = [Array.from(Array(size).fill([0, 0, 0, 0]), () => new Array(size).fill([0, 0, 0, 0]))];\r\n    frame.currentLayer = 0;\r\n    return frame;\r\n};\r\n\r\nconst createFrameCopy = (copy) => JSON.parse(JSON.stringify(copy));\r\n\r\nconst createFramesCopy = (frames) => JSON.parse(JSON.stringify(frames)).map((frame) => JSON.parse(JSON.stringify(frame)));\r\n\r\nconst createLayer = (size) => Array.from(Array(size).fill([0, 0, 0, 0]), () => new Array(size).fill([0, 0, 0, 0]));\r\n\r\nconst renderLayers = (canvas, layers, currentLayer, pikselSize) => {\r\n    const context = canvas.getContext(\"2d\");\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    layers.forEach((layer, index) => {\r\n        if (index === currentLayer) {\r\n            layer.forEach((item, i) => {\r\n                item.forEach((item, j) => {\r\n                    if (item.toString() === [0, 0, 0, 0].toString()) return;\r\n                    context.fillStyle = item;\r\n                    context.fillStyle = `rgba(${item.join()})`;\r\n                    context.fillRect(pikselSize * i, pikselSize * j, pikselSize, pikselSize);\r\n                });\r\n            });\r\n        } else {\r\n            layer.forEach((item, i) => {\r\n                item.forEach((item, j) => {\r\n                    if (item.toString() === [0, 0, 0, 0].toString()) return;\r\n                    item.splice(item.length - 1, 1, '.5');\r\n                    const fill = `rgba(${item.join()})`;\r\n                    context.fillStyle = item;\r\n                    context.fillStyle = fill;\r\n                    context.fillRect(pikselSize * i, pikselSize * j, pikselSize, pikselSize);\r\n                });\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nconst renderCanvas = (canvas, frame, pikselSize, layers) => {\r\n    const context = canvas.getContext(\"2d\");\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    if (layers) {\r\n        frame.forEach((layer) => {\r\n            layer.forEach((item, i) => {\r\n                item.forEach((item, j) => {\r\n                    if (item.toString() === [0, 0, 0, 0].toString()) return;\r\n                    context.fillStyle = item;\r\n                    context.fillStyle = `rgba(${item.join()})`;\r\n                    context.fillRect(pikselSize * i, pikselSize * j, pikselSize, pikselSize);\r\n                });\r\n            });\r\n        });\r\n    }\r\n    else {\r\n        frame.forEach((item, i) => {\r\n            item.forEach((item, j) => {\r\n                if (item.toString() === [0, 0, 0, 0].toString()) return;\r\n                context.fillStyle = item;\r\n                context.fillStyle = `rgba(${item.join()})`;\r\n                context.fillRect(pikselSize * i, pikselSize * j, pikselSize, pikselSize);\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nconst resize = (frames, currentSize, size) => {\r\n    const addCells = (frame) => {\r\n        let length = frame.length;\r\n        while (length !== size) {\r\n            frame.push(new Array(size).fill([0, 0, 0, 0]));\r\n            frame.unshift(new Array(size).fill([0, 0, 0, 0]));\r\n            length = frame.length;\r\n        }\r\n        frame.forEach((item) => {\r\n            let letngth = item.length;\r\n            while (letngth !== size) {\r\n                item.push([0, 0, 0, 0]);\r\n                item.unshift([0, 0, 0, 0]);\r\n                letngth = item.length;\r\n            }\r\n        });\r\n        return frame;\r\n    }\r\n\r\n    const removeCells = (frame) => {\r\n        let length = frame.length;\r\n        while (length !== size) {\r\n            frame.pop();\r\n            frame.shift();\r\n            length = frame.length;\r\n        }\r\n        frame.forEach((item) => {\r\n            let length = item.length;\r\n            while (length !== size) {\r\n                item.pop();\r\n                item.shift();\r\n                length = item.length;\r\n            }\r\n        });\r\n        return frame;\r\n    }\r\n    if (currentSize < size) frames.forEach((item) => item.layers.forEach((layer) => addCells(layer)));\r\n    else frames.forEach((item) => item.layers.forEach((layer) => removeCells(layer)));\r\n    return frames;\r\n}\r\n\r\nconst createStateCopy = (state, frames) => {\r\n    const framesCopy = createFramesCopy(frames);\r\n    const stateCopy = Object.assign({}, state, { framesToSaveAsApng: null }, { framesToSaveAsGif: null }, { stateHistory: null });\r\n    stateCopy.frames = framesCopy;\r\n    return stateCopy;\r\n}\r\n\r\nconst saveToGoogleDrive = (fileContent) => {\r\n    const file = new Blob([fileContent], { type: 'image/apng' });\r\n    const metadata = {\r\n        'name': 'newPiskel.apng',\r\n        'mimeType': 'apng',\r\n    };\r\n    const accessToken = window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token;\r\n    const form = new FormData();\r\n    form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));\r\n    form.append('file', file);\r\n    fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id', {\r\n        name: 'piskel.jpg',\r\n        method: 'POST',\r\n        headers: new Headers({ 'Authorization': 'Bearer ' + accessToken }),\r\n        body: form,\r\n    });\r\n}\r\n\r\nconst saveAsPiskel = (animationSpeed, size, framesCount, images) => {\r\n    return `{\"modelVersion\":2,\"piskel\":{\"name\":\"piskel\",\"description\":\"\",\"fps\":${animationSpeed},\"height\":${size},\"width\":${size},\"layers\":[\"{\"name\":\"Layer 1\",\"opacity\":1,\"frameCount\":${framesCount},\"chunks\":[{\"layout\":[[0]],\"base64PNG\":\"data: ${images}}]\"hiddenFrames\":[]}\"]}}`;\r\n}\r\n\r\nconst uploadProject = (cb) => {\r\n    const file = window.URL.createObjectURL(document.querySelector('input[type=file]').files[0]);\r\n    const rawFile = new XMLHttpRequest();\r\n    rawFile.overrideMimeType(\"application/json\");\r\n    rawFile.open(\"GET\", file, true);\r\n    rawFile.onreadystatechange = function () {\r\n        if (rawFile.readyState === 4) cb(rawFile.responseText);      \r\n    }\r\n    rawFile.send(null);\r\n};\r\n\r\nexport {\r\n    createFrame,\r\n    createFrameCopy,\r\n    renderCanvas,\r\n    resize,\r\n    createFramesCopy,\r\n    createStateCopy,\r\n    renderLayers,\r\n    createLayer,\r\n    saveToGoogleDrive,\r\n    saveAsPiskel,\r\n    uploadProject\r\n}\r\n","const convertHexToRgba = (hex) => {\r\n  let c;\r\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n    c = hex.substring(1).split('');\r\n    if (c.length === 3) {\r\n      c = [c[0], c[0], c[1], c[1], c[2], c[2]];\r\n    }\r\n    c = '0x' + c.join('');\r\n    return [(c >> 16) & 255, (c >> 8) & 255, c & 255, 1];\r\n  }\r\n}\r\n\r\nconst convertRgbToHex = (rgb) => {\r\n  rgb = rgb.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\r\n  return (rgb && rgb.length === 4) ? \"#\" +\r\n    (\"0\" + parseInt(rgb[1], 10).toString(16)).slice(-2) +\r\n    (\"0\" + parseInt(rgb[2], 10).toString(16)).slice(-2) +\r\n    (\"0\" + parseInt(rgb[3], 10).toString(16)).slice(-2) : '';\r\n}\r\n\r\nconst pen = (e, x, y, frame, colors) => {\r\n  e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n}\r\n\r\nconst eraser = (x, y, frame) => {\r\n  frame[x][y] = [0, 0, 0, 0];\r\n}\r\n\r\nconst mirror = (e, x, y, frame, colors) => {\r\n  const x1 = frame.length - x - 1;\r\n  const y1 = frame.length - y - 1;\r\n  if (e.ctrlKey) {\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x][y1] = convertHexToRgba(colors.main) : frame[x][y1] = convertHexToRgba(colors.extra);\r\n  } else if (e.shiftKey) {\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x1][y] = convertHexToRgba(colors.main) : frame[x1][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x][y1] = convertHexToRgba(colors.main) : frame[x][y1] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x1][y1] = convertHexToRgba(colors.main) : frame[x1][y1] = convertHexToRgba(colors.extra);\r\n  } else {\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x1][y] = convertHexToRgba(colors.main) : frame[x1][y] = convertHexToRgba(colors.extra);\r\n  }\r\n}\r\n\r\nconst bucket = (e, frame, x, y, size, colors) => {\r\n  const colorsMatch = (a, b) => a.toString() === b.toString();\r\n  let fillColor = convertHexToRgba(colors.main);\r\n  if (e.shiftKey) fillColor = convertHexToRgba(colors.extra);\r\n  const targetColor = frame[x][y];\r\n  if (!colorsMatch(targetColor, fillColor)) {\r\n    const pixelsToCheck = [x, y];\r\n    while (pixelsToCheck.length > 0) {\r\n      const y = pixelsToCheck.pop();\r\n      const x = pixelsToCheck.pop();\r\n      let curColor = null;\r\n      if (x >= 0 && x < size && y >= 0 && y < size) curColor = frame[x][y];\r\n      if (curColor && colorsMatch(curColor, targetColor)) {\r\n        frame[x][y] = fillColor;\r\n        pixelsToCheck.push(x + 1, y);\r\n        pixelsToCheck.push(x - 1, y);\r\n        pixelsToCheck.push(x, y + 1);\r\n        pixelsToCheck.push(x, y - 1);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst brush = (e, frame, colors) => {\r\n  if (e.shiftKey) {\r\n    frame.layers.forEach((layer) => {\r\n      layer.forEach((item, i) => {\r\n        item.forEach((item, j) => {\r\n          layer[i][j] = convertHexToRgba(colors.main);\r\n        });\r\n      });\r\n    });\r\n  }\r\n  frame.layers[frame.currentLayer].forEach((item, i) => {\r\n    item.forEach((item, j) => {\r\n      frame.layers[frame.currentLayer][i][j] = convertHexToRgba(colors.main);\r\n    });\r\n  });\r\n}\r\n\r\nconst horizontalReverse = (frame) => {\r\n  frame.reverse();\r\n}\r\n\r\nconst verticalReverse = (frame) => {\r\n  frame.map(item => item.reverse());\r\n}\r\n\r\nconst stroke = (e, x1, y1, x2, y2, frame, colors) => {\r\n  let deltaX = Math.abs(x2 - x1);\r\n  let deltaY = Math.abs(y2 - y1);\r\n  let signX = x1 < x2 ? 1 : -1;\r\n  let signY = y1 < y2 ? 1 : -1;\r\n  let error = deltaX - deltaY;\r\n  e.nativeEvent.buttons === 1 ? frame[x2][y2] = convertHexToRgba(colors.main) : frame[x2][y2] = convertHexToRgba(colors.extra);\r\n  while (x1 !== x2 || y1 !== y2) {\r\n    frame[x1][y1] = e.nativeEvent.buttons === 1 ? frame[x1][y1] = convertHexToRgba(colors.main) : frame[x1][y1] = convertHexToRgba(colors.extra);\r\n    let error2 = error * 2;\r\n    if (error2 > -deltaY) {\r\n      error -= deltaY;\r\n      x1 += signX;\r\n    }\r\n    if (error2 < deltaX) {\r\n      error += deltaX;\r\n      y1 += signY;\r\n    }\r\n  }\r\n  return frame;\r\n}\r\n\r\nconst rectangle = (e, startCoords, x1, y1, frame, colors) => {\r\n  let x = startCoords.x;\r\n  let y = startCoords.y;\r\n  while (x !== x1) {\r\n    e.nativeEvent.buttons === 1 ? frame[x][startCoords.y] = convertHexToRgba(colors.main) : frame[x][startCoords.y] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x < x1) x = x += 1;\r\n    else x = x -= 1\r\n  }\r\n  while (y !== y1) {\r\n    e.nativeEvent.buttons === 1 ? frame[startCoords.x][y] = convertHexToRgba(colors.main) : frame[startCoords.x][y] = convertHexToRgba(colors.extra);\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    if (startCoords.y < y1) y++;\r\n    else y--;\r\n  }\r\n  while (x !== startCoords.x) {\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x < x) x--;\r\n    else x++;\r\n    e.nativeEvent.buttons === 1 ? frame[x][y] = convertHexToRgba(colors.main) : frame[x][y] = convertHexToRgba(colors.extra);\r\n  }\r\n  return frame;\r\n}\r\n\r\nconst drawCircle = (e, frame, startCoords, x, y, colors, size) => {\r\n  let radius = Math.floor(Math.sqrt(Math.pow(startCoords.x - x, 2) + Math.pow(startCoords.y - y, 2), 2));\r\n  let x0 = 0, y0 = radius, gap = 0, delta = (2 - 2 * radius);\r\n  while (y0 >= 0) {\r\n    if (startCoords.x + x0 >= 0 && startCoords.x + x0 <= size - 1\r\n      && startCoords.y - y0 >= 0 && startCoords.y - y0 <= size - 1) e.nativeEvent.buttons === 1 ? frame[startCoords.x + x0][startCoords.y - y0] = convertHexToRgba(colors.main) : frame[startCoords.x + x0][startCoords.y - y0] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x - x0 >= 0 && startCoords.x - x0 <= size - 1\r\n      && startCoords.y - y0 >= 0 && startCoords.y - y0 <= size - 1) e.nativeEvent.buttons === 1 ? frame[startCoords.x - x0][startCoords.y - y0] = convertHexToRgba(colors.main) : frame[startCoords.x - x0][startCoords.y - y0] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x - x0 >= 0 && startCoords.x - x0 <= size - 1\r\n      && startCoords.y + y0 >= 0 && startCoords.y + y0 <= size - 1) e.nativeEvent.buttons === 1 ? frame[startCoords.x - x0][startCoords.y + y0] = convertHexToRgba(colors.main) : frame[startCoords.x - x0][startCoords.y + y0] = convertHexToRgba(colors.extra);\r\n    if (startCoords.x + x0 >= 0 && startCoords.x + x0 <= size - 1\r\n      && startCoords.y + y0 >= 0 && startCoords.y + y0 <= size - 1) e.nativeEvent.buttons === 1 ? frame[startCoords.x + x0][startCoords.y + y0] = convertHexToRgba(colors.main) : frame[startCoords.x + x0][startCoords.y + y0] = convertHexToRgba(colors.extra);\r\n    gap = 2 * (delta + y0) - 1;\r\n    if (delta < 0 && gap <= 0) {\r\n      x0++;\r\n      delta += 2 * x0 + 1;\r\n      continue;\r\n    }\r\n    if (delta > 0 && gap > 0) {\r\n      y0--;\r\n      delta -= 2 * y0 + 1;\r\n      continue;\r\n    }\r\n    x0++;\r\n    delta += 2 * (x0 - y0);\r\n    y0--;\r\n  }\r\n  return frame;\r\n}\r\n\r\nconst lighten = (e, frame, pikselSize) => {\r\n  const opacityValues = ['1', '.9', '.8', '.7', '.6', '.5', '.4', '.3', '.2', '.1']\r\n  const x = Math.floor(e.nativeEvent.offsetX / pikselSize);\r\n  const y = Math.floor(e.nativeEvent.offsetY / pikselSize);\r\n  let color = frame[x][y];\r\n  if (!color) return;\r\n  let currentOpacity = color[3];\r\n  if (e.shiftKey) {\r\n    const newOpacity = opacityValues[opacityValues.indexOf(currentOpacity) - 1];\r\n    color[3] = newOpacity;\r\n    frame[x][y] = color;\r\n  } else {\r\n    const newOpacity = opacityValues[opacityValues.indexOf(currentOpacity) + 1];\r\n    color[3] = newOpacity;\r\n    frame[x][y] = color;\r\n  }\r\n}\r\n\r\nconst dithering = (e, x, y, frame, colors, size) => {\r\n  const checkAround = (frame, x, y, top, left, bot, right) => {\r\n    let t, l, b, r;\r\n    if (top) t = frame[x][y - 1].toString() === frame[x][y].toString();\r\n    if (left) l = frame[x - 1][y].toString() === frame[x][y].toString();\r\n    if (bot) b = frame[x][y + 1].toString() === frame[x][y].toString();\r\n    if (right) r = frame[x + 1][y].toString() === frame[x][y].toString();\r\n    return r || l || t || b;\r\n  }\r\n  const currentColor = frame[x][y];\r\n  frame[x][y] = convertHexToRgba(colors.main);\r\n  let checked = null;\r\n  if (x > 0 && x < size - 1 && y > 0 && y < size - 1) checked = checkAround(frame, x, y, true, true, true, true);\r\n  if (x === 0 && y !== 0 && y !== size - 1) checked = checkAround(frame, x, y, true, false, true, true);\r\n  if (y === 0 && x !== 0 && x !== size - 1) checked = checkAround(frame, x, y, false, true, true, true);\r\n  if (x === size - 1 && y !== size - 1 && y !== 0) checked = checkAround(frame, x, y, true, true, true, false);\r\n  if (y === size - 1 && x !== size - 1 && x !== 0) checked = checkAround(frame, x, y, true, true, false, true);\r\n  if (x === 0 && y === 0) checked = checkAround(frame, x, y, false, false, true, true);\r\n  if (x === size - 1 && y === size - 1) checked = checkAround(frame, x, y, true, true, false, false);\r\n  if (x === size - 1 && y === 0) checked = checkAround(frame, x, y, false, true, true, false);\r\n  if (x === 0 && y === size - 1) checked = checkAround(frame, x, y, true, false, false, true);\r\n  if (e.shiftKey) {\r\n    if (checked) frame[x][y] = convertHexToRgba(colors.extra);\r\n    else frame[x][y] = convertHexToRgba(colors.main);\r\n  } else {\r\n    if (checked) frame[x][y] = currentColor;\r\n    else frame[x][y] = convertHexToRgba(colors.main);\r\n  }\r\n}\r\n\r\n\r\nconst colorPicker = (e, frame, startCoords, callback) => {\r\n  let pixel = frame[startCoords.x][startCoords.y];\r\n  if (!pixel) return;\r\n  e.shiftKey ? callback(convertRgbToHex(`rgba(${pixel.join()})`)) : callback(convertRgbToHex(`rgba(${pixel.join()})`), true);\r\n}\r\n\r\nconst move = (x1, y1, startCoords, frame, size) => {\r\n  let y = startCoords.y - y1;\r\n  let x = startCoords.x - x1;\r\n  if (x > 0) {\r\n    while (x !== 0) {\r\n      frame.shift();\r\n      frame.push(new Array(size).fill([0, 0, 0, 0]));\r\n      x--;\r\n    }\r\n  }\r\n  if (x < 0) {\r\n    while (x !== 0) {\r\n      frame.unshift(new Array(size).fill([0, 0, 0, 0]));\r\n      frame.pop();\r\n      x++;\r\n    }\r\n  }\r\n  if (y > 0) {\r\n    while (y !== 0) {\r\n      frame.forEach((item) => {\r\n        item.shift();\r\n        item.push([0, 0, 0, 0]);\r\n      });\r\n      y--;\r\n    }\r\n  }\r\n  if (y < 0) {\r\n    while (y !== 0) {\r\n      frame.forEach((item) => {\r\n        item.unshift([0, 0, 0, 0]);\r\n        item.pop();\r\n      });\r\n      y++;\r\n    }\r\n  }\r\n  startCoords.y = y1;\r\n  startCoords.x = x1;\r\n}\r\n\r\nexport {\r\n  pen,\r\n  eraser,\r\n  stroke,\r\n  mirror,\r\n  bucket,\r\n  rectangle,\r\n  drawCircle,\r\n  lighten,\r\n  dithering,\r\n  colorPicker,\r\n  move,\r\n  convertHexToRgba,\r\n  brush,\r\n  verticalReverse,\r\n  horizontalReverse,\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport CanvasInfo from './CanvasInfo';\r\nimport Layers from './Layers';\r\nimport { renderCanvas, createFrameCopy, createFramesCopy, renderLayers, createLayer } from '../Piskel/utils';\r\nimport { drawCircle, pen, eraser, stroke, mirror, bucket, rectangle, lighten, dithering, colorPicker, move, brush, verticalReverse, horizontalReverse } from './Tools';\r\n\r\nexport default class Canvas extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            mousePosition: { x: 0, y: 0 },\r\n            showLayers: false,\r\n        }\r\n        this.layersToSwap = {\r\n            firstLayer: null,\r\n            secondLayer: null,\r\n        }\r\n        this.isDrawing = false;\r\n        this.canvasSize = 640;\r\n        this.startCoords = {};\r\n        this.frameCopy = null;\r\n    }\r\n\r\n    setMousePosition(value) {\r\n        const mousePosition = Object.assign({}, this.state.mousePosition);\r\n        mousePosition.x = value.x;\r\n        mousePosition.y = value.y;\r\n        this.setState({ mousePosition });\r\n    }\r\n\r\n    componentDidMount() {\r\n        const { frame, canvasSize } = this.props;\r\n        const { canvas } = this.refs;\r\n        this.pikselSize = Math.floor(this.canvasSize / canvasSize);\r\n        this.canvas = canvas;\r\n        this.ctx = canvas.getContext('2d');\r\n        renderCanvas(canvas, frame.layers[frame.currentLayer], this.pikselSize);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        const { frame, canvasSize } = this.props;\r\n        this.pikselSize = this.canvasSize / canvasSize;\r\n        const { showLayers } = this.state;\r\n        const { canvas, pikselSize, frameCopy } = this;\r\n        if (frameCopy) return;\r\n        if (showLayers) renderLayers(canvas, createFramesCopy(frame.layers), frame.currentLayer, pikselSize);\r\n        else renderCanvas(canvas, frame.layers[frame.currentLayer], pikselSize);\r\n    }\r\n\r\n    mouseDownHandler(e) {\r\n        e.preventDefault();\r\n        this.isDrawing = true;\r\n        const { tools, frame, colors } = this.props;\r\n        const { showLayers } = this.state;\r\n        let { startCoords, pikselSize, canvas } = this;\r\n        this.startCoords.x = Math.floor(e.nativeEvent.offsetX / pikselSize);\r\n        this.startCoords.y = Math.floor(e.nativeEvent.offsetY / pikselSize);\r\n        if (tools.Stroke.value || tools.Rectangle.value || tools.Circle.value) this.frameCopy = createFrameCopy(frame);\r\n        if (tools.Pen.value) pen(e, startCoords.x, startCoords.y, frame.layers[frame.currentLayer], colors);\r\n        showLayers ? renderLayers(canvas, createFramesCopy(frame.layers), frame.currentLayer, pikselSize)\r\n            : renderCanvas(canvas, frame.layers[frame.currentLayer], pikselSize);\r\n    }\r\n\r\n    mouseMoveHandler(e) {\r\n        const { tools, frame, colors, canvasSize } = this.props;\r\n        const { showLayers } = this.state;\r\n        const { frameCopy, startCoords, pikselSize, canvas, isDrawing } = this;\r\n        let x = Math.floor(e.nativeEvent.offsetX / pikselSize);\r\n        let y = Math.floor(e.nativeEvent.offsetY / pikselSize);\r\n        if (x <= 0) x = 0;\r\n        if (x > canvasSize - 1) x = canvasSize - 1;\r\n        if (y <= 0) y = 0;\r\n        if (y > canvasSize - 1) y = canvasSize - 1;\r\n        if (tools.Pen.value && isDrawing) pen(e, x, y, frame.layers[frame.currentLayer], colors);\r\n        if (tools.Mirror.value && isDrawing) mirror(e, x, y, frame.layers[frame.currentLayer], colors);\r\n        if (tools.Dithering.value && isDrawing) dithering(e, x, y, frame.layers[frame.currentLayer], colors, canvasSize);\r\n        if (tools.Move.value && isDrawing) move(x, y, startCoords, frame.layers[frame.currentLayer], canvasSize);\r\n        if (tools.Eraser.value && isDrawing) eraser(x, y, frame.layers[frame.currentLayer]);\r\n        if (tools.Stroke.value && isDrawing) {\r\n            const clone = createFrameCopy(frame);\r\n            frameCopy.layers[frameCopy.currentLayer] = stroke(e, startCoords.x, startCoords.y, x, y, clone.layers[clone.currentLayer], colors);\r\n            showLayers ? renderLayers(canvas, createFramesCopy(frameCopy.layers), frame.currentLayer, pikselSize)\r\n                : renderCanvas(canvas, frameCopy.layers[frameCopy.currentLayer], pikselSize);\r\n        }\r\n        if (tools.Rectangle.value && isDrawing) {\r\n            const clone = createFrameCopy(frame);\r\n            frameCopy.layers[frameCopy.currentLayer] = rectangle(e, startCoords, x, y, clone.layers[clone.currentLayer], colors);\r\n            showLayers ? renderLayers(canvas, createFramesCopy(frameCopy.layers), frame.currentLayer, pikselSize)\r\n                : renderCanvas(canvas, frameCopy.layers[frameCopy.currentLayer], pikselSize);\r\n        }\r\n        if (tools.Circle.value && isDrawing) {\r\n            const clone = createFrameCopy(frame);\r\n            frameCopy.layers[frameCopy.currentLayer] = drawCircle(e, clone.layers[clone.currentLayer], startCoords, x, y, colors, canvasSize);\r\n            showLayers ? renderLayers(canvas, createFramesCopy(frameCopy.layers), frame.currentLayer, pikselSize)\r\n                : renderCanvas(canvas, frameCopy.layers[frameCopy.currentLayer], pikselSize);\r\n        }\r\n        this.setMousePosition({ x, y });\r\n    }\r\n\r\n    mouseUpHandler() {\r\n        this.isDrawing = false;\r\n        const { tools, frame, updateFrames } = this.props;\r\n        const { frameCopy } = this;\r\n        if (frameCopy) {\r\n            updateFrames(frameCopy);\r\n            this.frameCopy = null;\r\n        }\r\n        else if (!tools.Bucket.value && !tools.ColorPicker.value && !tools.Lighten.value\r\n            && !tools.Brush.value && !tools.VerticalReverse.value && !tools.HorizontalReverse.value) updateFrames(frame);\r\n    }\r\n\r\n    mouseClickHandler(e) {\r\n        e.preventDefault();\r\n        const { tools, frame, colors, canvasSize, setColor, updateFrames } = this.props;\r\n        const { showLayers } = this.state;\r\n        const { startCoords, pikselSize, canvas } = this;\r\n        if (tools.Bucket.value) bucket(e, frame.layers[frame.currentLayer], startCoords.x, startCoords.y, canvasSize, colors);\r\n        if (tools.ColorPicker.value) colorPicker(e, frame.layers[frame.currentLayer], startCoords, setColor);\r\n        if (tools.Lighten.value) lighten(e, frame.layers[frame.currentLayer], pikselSize);\r\n        if (tools.Brush.value) brush(e, frame, colors);\r\n        if (tools.VerticalReverse.value) verticalReverse(frame.layers[frame.currentLayer]);\r\n        if (tools.HorizontalReverse.value) horizontalReverse(frame.layers[frame.currentLayer]);\r\n        showLayers ? renderLayers(canvas, createFramesCopy(frame.layers), frame.currentLayer, pikselSize)\r\n            : renderCanvas(canvas, frame.layers[frame.currentLayer], pikselSize);\r\n        if (tools.Bucket.value\r\n            || tools.ColorPicker.value\r\n            || tools.Lighten.value\r\n            || tools.Brush.value\r\n            || tools.VerticalReverse.value\r\n            || tools.HorizontalReverse.value) updateFrames(frame);\r\n    }\r\n\r\n    mouseLeaveHandler() {\r\n        const { frame, updateFrames } = this.props;\r\n        const { frameCopy, pikselSize, canvas, isDrawing } = this;\r\n        if (isDrawing) {\r\n            if (frameCopy) {\r\n                renderCanvas(canvas, frameCopy.layers[frameCopy.currentLayer], pikselSize);\r\n                frame.layers[frame.currentLayer] = frameCopy.layers[frameCopy.currentLayer];\r\n                updateFrames(frame);\r\n                this.frameCopy = null;\r\n            } else {\r\n                updateFrames(frame);\r\n            }\r\n        }\r\n        this.isDrawing = false;\r\n    }\r\n\r\n    mouseWheelHandler(e) {\r\n        const { canvas } = this;\r\n        e = window.event;\r\n        let delta = Math.max(-1, Math.min(1, e.wheelDelta));\r\n        canvas.style.width = Math.max(640, Math.min(900, canvas.offsetWidth + (32 * delta))) + \"px\";\r\n        canvas.style.height = Math.max(640, Math.min(900, canvas.offsetHeight + (32 * delta))) + \"px\";\r\n    }\r\n\r\n    setCurrentLayer(value) {\r\n        const { frame, updateFrames } = this.props;\r\n        frame.currentLayer = value;\r\n        updateFrames(frame);\r\n    }\r\n\r\n    addLayer() {\r\n        const { frame, canvasSize, updateFrames } = this.props;\r\n        frame.layers.push(createLayer(canvasSize));\r\n        frame.currentLayer++;\r\n        updateFrames(frame);\r\n    }\r\n\r\n    deleteLayer() {\r\n        const { frame, updateFrames } = this.props;\r\n        frame.layers.splice(frame.currentLayer, 1);\r\n        if (frame.currentLayer !== 0) frame.currentLayer -= 1;\r\n        updateFrames(frame);\r\n    }\r\n\r\n    toggleShowLayers() {\r\n        this.setState((state) => {\r\n            return { showLayers: !state.showLayers };\r\n        });\r\n    }\r\n\r\n    setNextLayer() {\r\n        const { frame, updateFrames } = this.props;\r\n        if (frame.currentLayer !== frame.layers.length - 1) {\r\n            frame.currentLayer++;\r\n            updateFrames(frame);\r\n        }\r\n    }\r\n\r\n    setPreviousLayer() {\r\n        const { frame, updateFrames } = this.props;\r\n        if (frame.currentLayer !== 0) {\r\n            frame.currentLayer--;\r\n            updateFrames(frame);\r\n        }\r\n    }\r\n\r\n    setLayersToSwap(num, first) {\r\n        const { layersToSwap } = this;\r\n        if (first) layersToSwap.firstLayer = num;\r\n        else layersToSwap.secondLayer = num;\r\n    }\r\n\r\n    swapLayers() {\r\n        const { frame, updateFrames } = this.props;\r\n        const { layersToSwap } = this;\r\n        const firstLayer = frame.layers[layersToSwap.firstLayer];\r\n        const secondLayer = frame.layers[layersToSwap.secondLayer];\r\n        frame.layers.splice(layersToSwap.firstLayer, 1, secondLayer);\r\n        frame.layers.splice(layersToSwap.secondLayer, 1, firstLayer);\r\n        updateFrames(frame);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"canvas-container\">\r\n                <CanvasInfo\r\n                    size={this.props.canvasSize}\r\n                    mousePosition={this.state.mousePosition}\r\n\r\n                />\r\n                <div className={'canvas-wrapper'} >\r\n                    <canvas\r\n                        className=\"canvas\"\r\n                        ref='canvas'\r\n                        width={this.canvasSize}\r\n                        height={this.canvasSize}\r\n                        onContextMenu={(e) => { e.preventDefault(); }}\r\n                        onMouseDown={(e) => this.mouseDownHandler(e)}\r\n                        onMouseMove={(e) => this.mouseMoveHandler(e)}\r\n                        onMouseUp={() => this.mouseUpHandler()}\r\n                        onClick={(e) => this.mouseClickHandler(e)}\r\n                        onMouseLeave={() => this.mouseLeaveHandler()}\r\n                        onWheel={(e) => this.mouseWheelHandler()}\r\n                    />\r\n                </div>\r\n                <Layers\r\n                    setCurrentLayer={(value) => this.setCurrentLayer(value)}\r\n                    frame={this.props.frame}\r\n                    addLayer={() => this.addLayer()}\r\n                    deleteLayer={() => this.deleteLayer()}\r\n                    showLayers={() => this.toggleShowLayers()}\r\n                    setNextLayer={() => this.setNextLayer()}\r\n                    setPreviousLayer={() => this.setPreviousLayer()}\r\n                    isShowing={this.state.showLayers}\r\n                    setLayersToSwap={(a, b) => this.setLayersToSwap(a, b)}\r\n                    swapLayers={() => this.swapLayers()}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\n\r\nexport default class Tool extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            showTooltip: false,\r\n        }\r\n    }\r\n    showTooltip() {\r\n        this.setState({ showTooltip: true });\r\n    }\r\n\r\n    hideTooltip() {\r\n        this.setState({ showTooltip: false });\r\n    }\r\n\r\n    render() {\r\n        const { checked, name, shortcut, callBack } = this.props;\r\n        return (\r\n            <div className={'button-wrapper'}>\r\n                <button onMouseEnter={() => this.showTooltip()} onMouseLeave={() => this.hideTooltip()} onClick={callBack} className={checked ? name : `${name} checked`} />\r\n                {this.state.showTooltip && <div ref='toolTip' className={'tooltip'}><p>{`${name} tool`}<span>{`(${shortcut})`}</span></p></div>}\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\n\r\nexport default class ShortcutInfo extends React.Component {\r\n    isChanging() {\r\n        const { tool, setShortcut } = this.props;\r\n        const { shortcut } = this.refs;\r\n        document.querySelectorAll('.shortcut').forEach((item) => item.classList.remove('sc-changing'));\r\n        shortcut.classList.add('sc-changing');\r\n        document.onkeyup = (e) => {\r\n            setShortcut(tool, e.keyCode);\r\n            this.isChanged();\r\n        }\r\n    }\r\n\r\n    isChanged() {\r\n        const { shortcut } = this.refs;\r\n        shortcut.classList.remove('sc-changing');\r\n    }\r\n\r\n    render() {\r\n        const { tool, shortcut } = this.props;\r\n        return (\r\n            <div className={'sc-info-wrapper'} onClick={() => this.isChanging()}\r\n            >\r\n                <h3>{`${tool}:`}</h3>\r\n                <p className={'shortcut'} ref='shortcut'>{`'${shortcut}'`}</p>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ShortcutInfo from './ShortcutInfo';\r\n\r\nexport default class ShortcutsPopup extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.copy = JSON.parse(JSON.stringify(this.props.tools));\r\n        this.state = {\r\n            tools: JSON.parse(JSON.stringify(this.props.tools)),\r\n        }\r\n    }\r\n\r\n    createBtnsInfo() {\r\n        const { tools } = this.state;\r\n        const info = [];\r\n        for (let key in tools) {\r\n            info.push(<ShortcutInfo key={key} tool={key} shortcut={tools[key].shortcut} setShortcut={(tool, value) => this.setShortcut(tool, value)} />)\r\n        }\r\n        return info;\r\n    }\r\n\r\n    setShortcut(tool, value) {\r\n        const tools = Object.assign({}, this.state.tools);\r\n        for (let key in tools) {\r\n            if (tools[key].shortcut === String.fromCharCode(value).toUpperCase()) tools[key].shortcut = tools[tool].shortcut;\r\n        }\r\n        tools[tool].shortcut = String.fromCharCode(value).toUpperCase();\r\n        this.setState({\r\n            tools: tools,\r\n        });\r\n        document.onkeyup = null;\r\n    }\r\n\r\n    setDefaultValue() {\r\n        const { copy } = this\r\n        this.setState({ tools: copy });\r\n        this.props.togglePopup();\r\n        this.forceUpdate();\r\n    }\r\n\r\n    updateShortcuts() {\r\n        const { tools } = this.state;\r\n        this.props.updateShortcuts(tools);\r\n        this.props.togglePopup();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'sc-popup'}>\r\n                {this.createBtnsInfo()}\r\n                <button className={'save-sc-btn'} onClick={() => this.updateShortcuts()}>Save</button>\r\n                <button className={'cancel-sc-btn'} onClick={() => this.setDefaultValue()}>Cancel</button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ShortcutsPopup from './ShortcutsPopup';\r\n\r\nexport default class Shortcuts extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            showPopup: false,\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', (e) => {\r\n            for (let key in this.props.tools) {\r\n                if (String.fromCharCode(e.keyCode).toUpperCase() === this.props.tools[key].shortcut) this.props.setTools(key);\r\n            }\r\n        });\r\n    }\r\n\r\n    togglePopup() {\r\n        const { showPopup } = this.state;\r\n        this.setState({ showPopup: !showPopup });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <button className={'shortcuts'} onClick={() => this.togglePopup()} />\r\n                {this.state.showPopup && <ShortcutsPopup togglePopup={() => this.togglePopup()} updateShortcuts={(value) => this.props.updateShortcuts(value)} tools={this.props.tools} />}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\nimport Tool from './Tool';\r\nimport Shortcuts from './Shortcuts/Shortcuts';\r\n\r\nexport default class Tools extends React.Component {\r\n\r\n    createButtons() {\r\n        const { tools, setTools } = this.props;\r\n        const buttons = [];\r\n        for (const key in tools) {\r\n            let checked = true;\r\n            if (tools[key].value) checked = false;\r\n            buttons.push(<Tool\r\n                checked={checked}\r\n                name={key}\r\n                key={key}\r\n                callBack={() => setTools(key)}\r\n                shortcut={tools[key].shortcut}\r\n            />);\r\n        }\r\n        return buttons;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='tools'>\r\n                {this.createButtons()}\r\n                <div className={'colors'}>\r\n                    <input\r\n                        className='mainColor'\r\n                        value={this.props.colors.main}\r\n                        onChange={(e) => this.props.setColor(e.target.value, true)}\r\n                        type=\"color\">\r\n                    </input>\r\n                    <input\r\n                        className='extraColor'\r\n                        value={this.props.colors.extra}\r\n                        onChange={(e) => this.props.setColor(e.target.value)}\r\n                        type=\"color\">\r\n                    </input>\r\n                    <div className='swap' onClick={() => this.props.swapColors()}></div>\r\n                </div>\r\n                <Shortcuts\r\n                    updateShortcuts={(value) => this.props.updateShortcuts(value)}\r\n                    tools={this.props.tools}\r\n                    setTools={(key) => this.props.setTools(key)}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\nimport { renderCanvas } from '../Piskel/utils';\r\n\r\nexport default class Preview extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.readyToSave = false;\r\n        this.imgsToGif = [];\r\n        this.imgsToPng = [];\r\n        this.framesToShow = [];\r\n        this.interval = null;\r\n        this.canvasSize = 384;\r\n        this.currentFrame = 0;\r\n        this.state = {\r\n            speed: 12\r\n        }\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        const { frames, canvasSize } = this.props;\r\n        let { canvas, pikselSize, currentFrame } = this;\r\n        if (JSON.stringify(frames) === JSON.stringify(nextProps.frames) && nextState.speed === this.state.speed) return false;\r\n        else {\r\n            pikselSize = Math.floor(this.canvasSize / canvasSize);\r\n            currentFrame = 0;\r\n            renderCanvas(canvas, frames[currentFrame].layers[frames[currentFrame].currentLayer], pikselSize);\r\n            return true;\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        const { canvas } = this.refs;\r\n        const { canvasSize } = this.props;\r\n        this.pikselSize = Math.floor(this.canvasSize / canvasSize);\r\n        this.canvas = canvas;\r\n        this.ctx = canvas.getContext('2d');\r\n        this.startAnimation();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        const { interval } = this;\r\n        const { frames, canvasSize } = this.props;\r\n        clearInterval(interval);\r\n        this.framesToShow = [];\r\n        this.readyToSave = false;\r\n        this.imgsToGif = [];\r\n        this.imgsToPng = [];\r\n        this.pikselSize = Math.floor(this.canvasSize / canvasSize);\r\n        this.currentFrame = 0;\r\n        if (frames[this.currentFrame].layers.length > 1) renderCanvas(this.canvas, frames[this.currentFrame].layers, this.pikselSize, true);\r\n        else renderCanvas(this.canvas, frames[this.currentFrame].layers[0], this.pikselSize);\r\n        this.startAnimation();\r\n    }\r\n\r\n    startAnimation() {\r\n        let { framesToShow, ctx, currentFrame, pikselSize, canvasSize, readyToSave, imgsToGif, imgsToPng, canvas } = this;\r\n        const { frames, setFramesToSave } = this.props;\r\n        const { speed } = this.state;\r\n        this.interval = setInterval(() => {\r\n            if (framesToShow.length === frames.length) ctx.putImageData(framesToShow[currentFrame], 0, 0);\r\n            else {\r\n                renderCanvas(canvas, frames[currentFrame].layers, pikselSize, true);\r\n                framesToShow.push(ctx.getImageData(0, 0, canvasSize, canvasSize));\r\n            }\r\n            if (imgsToGif.length !== frames.length && !readyToSave) {\r\n                imgsToGif.push(canvas.toDataURL(\"image/png\"));\r\n                imgsToPng.push(ctx.getImageData(0, 0, canvasSize, canvasSize).data.buffer);\r\n            }\r\n            else {\r\n                if (readyToSave === false) {\r\n                    setFramesToSave(imgsToGif, imgsToPng, speed);\r\n                    readyToSave = true;\r\n                }\r\n            }\r\n            currentFrame++;\r\n            if (currentFrame === frames.length) currentFrame = 0;\r\n        }, 1000 / speed);\r\n    }\r\n\r\n    setSpeed(e) {\r\n        const { interval } = this.state;\r\n        clearInterval(interval);\r\n        const speed = e.target.value;\r\n        this.setState({ speed });\r\n        this.startAnimation();\r\n    }\r\n\r\n    toggleFullscreen() {\r\n        let elem = document.querySelector(\".preview-wrapper\");\r\n        if (!document.fullscreenElement) {\r\n            elem.requestFullscreen();\r\n        } else {\r\n            document.exitFullscreen();\r\n        }\r\n    }\r\n\r\n    showFullScreenButton() {\r\n        const { fsButton } = this.refs;\r\n        fsButton.style.opacity = '1';\r\n    }\r\n\r\n    hideFullScreenButton() {\r\n        const { fsButton } = this.refs;\r\n        fsButton.style.opacity = '0';\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='previev-container'>\r\n                <div onMouseEnter={() => this.showFullScreenButton()} onMouseLeave={() => this.hideFullScreenButton()} className={'preview-wrapper'}>\r\n                    <canvas\r\n                        className='preview'\r\n                        ref='canvas'\r\n                        width={this.canvasSize}\r\n                        height={this.canvasSize}\r\n                    />\r\n                    <button className={'preview-fullscreen'} ref='fsButton' onClick={(e) => this.toggleFullscreen(e)}></button>\r\n                </div>\r\n                <p>{`FPS Rate: ${this.state.speed}`}</p>\r\n                <input\r\n                    onInput={(e) => this.setSpeed(e)}\r\n                    type='range'\r\n                    min=\"1\"\r\n                    max=\"24\"\r\n                    defaultValue='12' />\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\nimport { renderCanvas } from '../Piskel/utils';\r\n\r\nexport default class Frame extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.pikselSize = null;\r\n        this.frameSize = 256;\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps) {\r\n        const { frame } = this.props;\r\n        if (JSON.stringify(frame) === JSON.stringify(nextProps.frame)) return false;\r\n        else return true;\r\n    }\r\n\r\n    componentDidMount() {\r\n        const { canvas } = this.refs;\r\n        const { canvasSize, frame } = this.props\r\n        const { frameSize } = this;\r\n        this.canvas = canvas;\r\n        this.pikselSize = Math.floor(frameSize / canvasSize);\r\n        renderCanvas(canvas, frame.layers[frame.currentLayer], this.pikselSize);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        const { canvasSize, frame } = this.props;\r\n        const { canvas, pikselSize } = this;\r\n        this.pikselSize = Math.floor(this.frameSize / canvasSize);\r\n        renderCanvas(canvas, frame.layers[frame.currentLayer], pikselSize);\r\n    }\r\n\r\n\r\n    showButtons() {\r\n        const { cloneFrame, deleteFrame } = this.refs;\r\n        cloneFrame.style.opacity = '1';\r\n        deleteFrame.style.opacity = '1';\r\n    }\r\n\r\n    hideButtons() {\r\n        const { cloneFrame, deleteFrame } = this.refs;\r\n        cloneFrame.style.opacity = '0';\r\n        deleteFrame.style.opacity = '0';\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div onMouseEnter={() => this.showButtons()} onMouseLeave={() => this.hideButtons()} className={this.props.current ? `frame-wrapper frame-wrapper-active` : 'frame-wrapper'}>\r\n                <canvas\r\n                    className={'frame-canvas'}\r\n                    draggable={'true'}\r\n                    ref='canvas'\r\n                    width={this.frameSize}\r\n                    height={this.frameSize}\r\n                    onClick={() => this.props.setCurrentFrame(this.props.frame)}\r\n                    onDragEnter={() => {\r\n                        this.canvas.parentNode.classList.add('frame-wrapper-dragEnter');\r\n                        this.props.setTargetToSwap(this.props.frame, false);\r\n                    }}\r\n                    onDragOver={(e) => e.preventDefault()}\r\n                    onDragLeave={() => this.canvas.parentNode.classList.remove('frame-wrapper-dragEnter')}\r\n                    onDragStart={() => {\r\n                        this.canvas.parentNode.classList.add('frame-wrapper-dragStart');\r\n                        this.props.setTargetToSwap(this.props.frame, true);\r\n                    }}\r\n                    onDragEnd={() => {\r\n                        this.props.swapFrames();\r\n                        this.canvas.parentNode.classList.remove('frame-wrapper-dragEnter');\r\n                        this.canvas.parentNode.classList.remove('frame-wrapper-dragStart');\r\n                    }}\r\n                />\r\n                <p className={'frame-number'}>{this.props.num + 1}</p>\r\n                <button className={'frame-copy'} ref='cloneFrame' onClick={() => this.props.cloneFrame(this.props.frame)} />\r\n                <button className={'frame-delete'} ref='deleteFrame' onClick={() => this.props.deleteFrame(this.props.frame)} />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\nimport Frame from './Frame';\r\n\r\nexport default class Frames extends React.Component {\r\n\r\n    shouldComponentUpdate(nextProps) {\r\n        const { frames, canvasSize, currentFrame } = this.props;\r\n        if (JSON.stringify(frames) === JSON.stringify(nextProps.frames) && canvasSize === nextProps.canvasSize && currentFrame === nextProps.currentFrame) return false;\r\n        else return true;\r\n    }\r\n\r\n    renderFrames() {\r\n        const { frames, canvasSize, currentFrame, deleteFrame, cloneFrame, setCurrentFrame, setTargetToSwap, swapFrames } = this.props;\r\n        const framesToRender = [];\r\n        frames.forEach((frame, i) => {\r\n            let current = false;\r\n            if (currentFrame === i) current = true;\r\n            framesToRender.push(<Frame\r\n                current={current}\r\n                canvasSize={canvasSize}\r\n                num={i}\r\n                key={Math.random().toString(36).substring(7)}\r\n                frame={frame}\r\n                deleteFrame={deleteFrame}\r\n                cloneFrame={cloneFrame}\r\n                setCurrentFrame={setCurrentFrame}\r\n                setTargetToSwap={setTargetToSwap}\r\n                swapFrames={swapFrames}\r\n            />\r\n            )\r\n        })\r\n        return framesToRender;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'frames-wrapper'}>\r\n                {this.renderFrames()}\r\n                <button className={'add-frame'} onClick={() => this.props.addFrame()}><p>Add new frame</p></button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\n\r\nexport default class Header extends React.PureComponent {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            mail: null,\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        try {\r\n            window.gapi.load('auth2', () => {\r\n                window.gapi.auth2.init({ client_id: '355911681552-osgglvf1ep2a6ivbi8h0uhd8nprv452a.apps.googleusercontent.com' });\r\n            });\r\n        } catch (error) {\r\n            console.log(error.message);\r\n        }\r\n\r\n    }\r\n\r\n    signIn() {\r\n        const GoogleAuth = window.gapi.auth2.getAuthInstance();\r\n        GoogleAuth.signIn({ scope: 'https://www.googleapis.com/auth/drive' })\r\n            .then(user => this.setState({ mail: user.w3.U3 }));\r\n    }\r\n\r\n    singOut() {\r\n        const GoogleAuth = window.gapi.auth2.getAuthInstance();\r\n        GoogleAuth.signOut().then(i => this.setState({ mail: null }));\r\n    }\r\n\r\n    render() {\r\n        const { mail } = this.state;\r\n        return (\r\n            <div className={'header'}>\r\n                <div className={'logo'} />\r\n                <div className={'user-info-wrapper'}>\r\n                    <p className={'user-info'}>{this.state.mail}</p>\r\n                    {!mail && <button onClick={() => this.signIn()}>Log In</button>}\r\n                    {mail && <button onClick={() => this.singOut()}>Log Out</button>}\r\n\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nexport default class Settings extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            showSaveInfo: false,\r\n            showResizeInfo: false,\r\n            project: 'Import .rss file...',\r\n        }\r\n    }\r\n\r\n    showResizeInfo() {\r\n        const { showSaveInfo, showResizeInfo } = this.state;\r\n        const { settings, resizeInfo, saveInfo } = this.refs;\r\n        if (!showSaveInfo && !showResizeInfo) {\r\n            this.setState({ showResizeInfo: true });\r\n            settings.classList.add('show-settings');\r\n            resizeInfo.style.borderRight = 'none';\r\n        }\r\n        if (showResizeInfo) settings.classList.toggle('show-settings');\r\n        if (showSaveInfo) {\r\n            this.setState({ showResizeInfo: true, showSaveInfo: false });\r\n            saveInfo.style.borderRight = '3px solid black';\r\n            resizeInfo.style.borderRight = 'none';\r\n            settings.classList.add('show-settings');\r\n        }\r\n    }\r\n\r\n    showSaveInfo() {\r\n        const { showSaveInfo, showResizeInfo } = this.state;\r\n        const { settings, resizeInfo, saveInfo } = this.refs;\r\n        if (!showSaveInfo && !showResizeInfo) {\r\n            this.setState({ showSaveInfo: true });\r\n            settings.classList.add('show-settings');\r\n            saveInfo.style.borderRight = 'none';\r\n        }\r\n        if (showSaveInfo) settings.classList.toggle('show-settings');\r\n        if (showResizeInfo) {\r\n            this.setState({ showResizeInfo: false, showSaveInfo: true });\r\n            resizeInfo.style.borderRight = '3px solid black';\r\n            saveInfo.style.borderRight = 'none';\r\n            settings.classList.add('show-settings');\r\n        }\r\n    }\r\n\r\n    importRssFileHandler() {\r\n        this.setState({ project: document.querySelector('input[type=file]').files[0].name });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div ref='settings' className={'settings'}>\r\n                <div className={'settings-btn-wrapper'}>\r\n                    <button className={'saveInfo-btn'} ref='saveInfo' onClick={() => this.showSaveInfo()} />\r\n                    <button className={'resizeInfo-btn'} ref='resizeInfo' onClick={() => this.showResizeInfo()} />\r\n                </div>\r\n                <div className={'settings-info-container'}>\r\n                    {this.state.showResizeInfo && <div className={'canvas-resize-wrapper'}>\r\n                        <h3>{`Current size: ${this.props.canvasSize} x ${this.props.canvasSize}`}</h3>\r\n                        <div className={\"button\"} onClick={() => this.props.resize(32)}>\r\n                            <p className={\"btnText\"} >32x32</p>\r\n                            <div className={\"btnTwo\"}>\r\n                                <p className={\"btnText2\"}>Resize</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className={\"button\"} onClick={() => this.props.resize(64)}>\r\n                            <p className={\"btnText\"}>64x64</p>\r\n                            <div className={\"btnTwo\"}>\r\n                                <p className={\"btnText2\"}>Resize</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className={\"button\"} onClick={() => this.props.resize(128)}>\r\n                            <p className={\"btnText\"}>128x128</p>\r\n                            <div className={\"btnTwo\"}>\r\n                                <p className={\"btnText2\"}>Resize</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>}\r\n                    {this.state.showSaveInfo && <div><div className={'canvas-saveInfo-wrapper'}>\r\n                        <div className={'save-format-btn-wrapper'}>\r\n                            <input\r\n                                type={'file'}\r\n                                id={'file'}\r\n                                className={'inputFile'}\r\n                                onChange={() => {\r\n                                    this.importRssFileHandler();\r\n                                    this.props.importRssFile();\r\n                                }}\r\n                            />\r\n                            <label htmlFor=\"file\">\r\n                                <div className={'import-file'} />\r\n                                {this.state.project}\r\n                            </label>\r\n                            <h3>Save as:</h3>\r\n                            <div className={\"button\"} onClick={this.props.saveAsGif}>\r\n                                <p className={\"btnText\"} >.gif</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className={\"button\"} onClick={this.props.saveAsApng}>\r\n                                <p className={\"btnText\"}>.apng</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className={\"button\"} onClick={this.props.saveAsPiskel}>\r\n                                <p className={\"btnText\"}>.piskel</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className={\"button\"} onClick={this.props.saveAsRss}>\r\n                                <p className={\"btnText\"}>.rss</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className={'save-location-btn-wrapper'}>\r\n                            <h3>Save to:</h3>\r\n                            <div className={\"button\"} onClick={this.props.saveToLocalStorage}>\r\n                                <p className={\"btnText\"}>Storage</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Save</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className={\"button\"} onClick={this.props.saveToGoogleDrive}>\r\n                                <p className={\"btnText\"}>Google</p>\r\n                                <div className={\"btnTwo\"}>\r\n                                    <p className={\"btnText2\"}>Upload</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    </div>}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\nimport './style.css';\nimport download from 'downloadjs';\nimport UPNG from 'upng-js';\nimport gifshot from 'gifshot';\nimport StartPage from '../StartPage/StartPage';\nimport Canvas from '../Canvas/Canvas';\nimport Tools from '../Tools/Tools';\nimport Preview from '../Preview/Preview';\nimport Frames from '../Frames/Frames';\nimport Header from '../Header/Header';\nimport Settings from '../Settings/Settings';\nimport { createFrame, createFrameCopy, createFramesCopy, resize, createStateCopy, saveToGoogleDrive, saveAsPiskel, uploadProject } from './utils';\n\nexport default class Piskel extends React.Component {\n  constructor(props) {\n    super(props);\n    this.targetsToSwap = {\n      firstTarget: null,\n      secondTarget: null,\n    };\n    this.state = {\n      projectIsStarted: false,\n      canvasSize: 32,\n      frames: [createFrame(32)],\n      stateHistory: [],\n      currentFrame: 0,\n      framesToSaveAsGif: [],\n      framesToSaveAsApng: [],\n      animationSpeed: null,\n      colors: {\n        main: '#000000',\n        extra: '#8080ff',\n      },\n      tools: {\n        Pen: { value: false, shortcut: 'Q' },\n        Mirror: { value: false, shortcut: 'W' },\n        Bucket: { value: false, shortcut: 'E' },\n        Eraser: { value: false, shortcut: 'R' },\n        Brush: { value: false, shortcut: 'T' },\n        Stroke: { value: false, shortcut: 'Y' },\n        Rectangle: { value: false, shortcut: 'A' },\n        Circle: { value: false, shortcut: 'S' },\n        Move: { value: false, shortcut: 'D' },\n        ColorPicker: { value: false, shortcut: 'F' },\n        Lighten: { value: false, shortcut: 'G' },\n        Dithering: { value: false, shortcut: 'H' },\n        VerticalReverse: { value: false, shortcut: 'C' },\n        HorizontalReverse: { value: false, shortcut: 'X' },\n      },\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener('keypress', (e) => {\n      if (e.keyCode === 26 && e.ctrlKey && this.state.stateHistory.length) this.stepBack();\n    });\n    if (localStorage.getItem('state')) this.setState({ ...JSON.parse(localStorage.getItem('state')) });\n  }\n\n  startProject() {\n    this.setState({ projectIsStarted: true });\n  }\n\n  setFramesToSave(framesToSaveAsGif, framesToSaveAsApng, animationSpeed) {\n    this.setState({ framesToSaveAsGif, framesToSaveAsApng, animationSpeed });\n  }\n\n  saveAsGif() {\n    gifshot.createGIF({\n      images: this.state.framesToSaveAsGif,\n      interval: 1 / this.state.animationSpeed,\n      gifWidth: 384,\n      gifHeight: 384,\n    }, (obj) => {\n      if (!obj.error) download(obj.image, 'newGif.gif', 'gif');\n    });\n  }\n\n  saveToLocalStorage() {\n    localStorage.clear();\n    localStorage.setItem('state', JSON.stringify(this.state));\n  }\n\n  saveAsApng() {\n    const imageData = UPNG.encode(this.state.framesToSaveAsApng, 384, 384, 0, new Array(this.state.framesToSaveAsApng.length).fill(1000 / this.state.animationSpeed));\n    download(imageData, 'newAPNG.apng', 'apng');\n  }\n\n  saveAsPiskel() {\n    download(saveAsPiskel(1 / this.state.animationSpeed, 384, this.state.framesToSaveAsGif.length, this.state.framesToSaveAsGif), 'newPiskel.piskel', 'piskel');\n  }\n\n  saveAsRss() {\n    download(JSON.stringify(createStateCopy(this.state, this.state.frames)), 'project.rss', 'rss');\n  }\n\n  saveToGoogleDrive() {\n    saveToGoogleDrive(UPNG.encode(this.state.framesToSaveAsApng, 384, 384, 0, new Array(this.state.framesToSaveAsApng.length).fill(1000 / this.state.animationSpeed)));\n  }\n\n  importRssFile() {\n    const updateState = data => this.setState({ ...JSON.parse(data), stateHistory: [] });\n    uploadProject(updateState);\n  }\n\n  stepBack() {\n    const step = this.state.stateHistory.pop();\n    const { speed, canvasSize, frames, currentFrame, colors, tools } = step;\n    this.setState({ speed, canvasSize, frames, currentFrame, colors, tools });\n  }\n\n  saveCurrentState() {\n    const stateCopy = createStateCopy(this.state, this.state.frames);\n    const stateHistory = createFramesCopy(this.state.stateHistory);\n    if (stateHistory.length > 5) stateHistory.shift();\n    stateHistory.push(stateCopy);\n    return stateHistory;\n  }\n\n  resize(canvasSize) {\n    let frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    frames = resize(frames, this.state.canvasSize, canvasSize);\n    this.setState({ frames, canvasSize, stateHistory });\n  }\n\n  updateFrames(frame) {\n    const { currentFrame } = this.state\n    if (JSON.stringify(this.state.frames[currentFrame]) === JSON.stringify(frame)) return false;\n    const frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    frames[currentFrame] = frame;\n    this.setState({ frames, stateHistory });\n  }\n\n  setCurrentFrame(frame) {\n    const stateHistory = this.saveCurrentState();\n    const currentFrame = this.state.frames.indexOf(frame);\n    this.setState({ currentFrame, stateHistory });\n  }\n\n  addFrame() {\n    let { canvasSize, currentFrame } = this.state;\n    const frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    frames.push(createFrame(canvasSize));\n    currentFrame += 1;\n    this.setState({ frames, currentFrame, stateHistory });\n  }\n\n  deleteFrame(frame) {\n    let { canvasSize, currentFrame } = this.state;\n    const frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    if (frames.length === 1) {\n      this.setState({ frames: [createFrame(canvasSize)], stateHistory });\n    } else {\n      const index = this.state.frames.indexOf(frame);\n      if (currentFrame !== 0) currentFrame -= 1;\n      frames.splice(index, 1);\n      this.setState({ frames, currentFrame });\n    }\n  }\n\n  cloneFrame(frame) {\n    const frames = createFramesCopy(this.state.frames);\n    const stateHistory = this.saveCurrentState();\n    let { currentFrame } = this.state;\n    currentFrame += 1;\n    frames.splice(this.state.frames.indexOf(frame), 0, createFrameCopy(frame));\n    this.setState({ frames, currentFrame, stateHistory });\n  }\n\n  setColor(value, isMain) {\n    const { colors } = this.state;\n    const stateHistory = this.saveCurrentState();\n    if (isMain) {\n      this.setState({\n        stateHistory,\n        colors: {\n          main: value,\n          extra: colors.extra,\n        },\n      });\n    } else {\n      this.setState({\n        stateHistory,\n        colors: {\n          main: colors.main,\n          extra: value,\n        },\n      });\n    }\n  }\n\n  swapColors() {\n    const { colors } = this.state;\n    const stateHistory = this.saveCurrentState();\n    this.setState({ colors: { main: colors.extra, extra: colors.main }, stateHistory });\n  }\n\n  setTools(tool) {\n    const tools = Object.assign({}, this.state.tools);\n    tools[tool].value = !tools[tool].value;\n    for (const key in tools) {\n      if (key !== tool) {\n        tools[key].value = false;\n      }\n    }\n    this.setState({\n      tools,\n    });\n  }\n\n  updateShortcuts(value) {\n    this.setState({ tools: value });\n  }\n\n  setTargetToSwap(frame, first) {\n    const { targetsToSwap } = this;\n    if (first) targetsToSwap.firstTarget = frame;\n    else targetsToSwap.secondTarget = frame;\n  }\n\n  swapFrames() {\n    const { targetsToSwap } = this;\n    if (!targetsToSwap.secondTarget || targetsToSwap.firstTarget === targetsToSwap.secondTarget) return;\n    const stateHistory = this.saveCurrentState();\n    const frames = createFramesCopy(this.state.frames);\n    frames.splice(this.state.frames.indexOf(targetsToSwap.firstTarget), 1, targetsToSwap.secondTarget);\n    frames.splice(this.state.frames.indexOf(targetsToSwap.secondTarget), 1, targetsToSwap.firstTarget);\n    this.setState({ frames, stateHistory });\n  }\n\n  render() {\n    return (\n      <div>\n        <Header />\n        {!this.state.projectIsStarted && <StartPage startProject={() => this.startProject()} />}\n        {this.state.projectIsStarted && (\n          <div className=\"container\">\n            <Tools\n              tools={this.state.tools}\n              setTools={tool => this.setTools(tool)}\n              setColor={(value, isMain) => this.setColor(value, isMain)}\n              swapColors={() => this.swapColors()}\n              colors={this.state.colors}\n              updateShortcuts={value => this.updateShortcuts(value)}\n            />\n            <Frames\n              currentFrame={this.state.currentFrame}\n              canvasSize={this.state.canvasSize}\n              frames={this.state.frames}\n              addFrame={() => this.addFrame()}\n              deleteFrame={frame => this.deleteFrame(frame)}\n              cloneFrame={frame => this.cloneFrame(frame)}\n              setCurrentFrame={frame => this.setCurrentFrame(frame)}\n              setTargetToSwap={(frame, first) => this.setTargetToSwap(frame, first)}\n              swapFrames={() => this.swapFrames()}\n            />\n            <Canvas\n              frames={createFramesCopy(this.state.frames)}\n              setMousePosition={value => this.setMousePosition(value)}\n              canvasSize={this.state.canvasSize}\n              tools={this.state.tools}\n              colors={this.state.colors}\n              updateFrames={frame => this.updateFrames(frame)}\n              frame={createFrameCopy(this.state.frames[this.state.currentFrame])}\n              setColor={(value, isMain) => this.setColor(value, isMain)}\n            />\n            <Preview\n              frames={this.state.frames}\n              canvasSize={this.state.canvasSize}\n              setFramesToSave={(gif, png, speed) => this.setFramesToSave(gif, png, speed)}\n            />\n            <Settings\n              saveAsApng={() => this.saveAsApng()}\n              saveAsGif={() => this.saveAsGif()}\n              saveToGoogleDrive={() => this.saveToGoogleDrive()}\n              saveToLocalStorage={() => this.saveToLocalStorage()}\n              saveAsPiskel={() => this.saveAsPiskel()}\n              resize={canvasSize => this.resize(canvasSize)}\n              canvasSize={this.state.canvasSize}\n              saveAsRss={() => this.saveAsRss()}\n              importRssFile={() => this.importRssFile()}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Piskel from './Components/Piskel/Piskel';\n\nReactDOM.render(<Piskel />, document.getElementById('root'));"],"sourceRoot":""}